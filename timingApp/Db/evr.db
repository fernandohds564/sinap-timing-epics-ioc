########################################################################
# Control and Status Register [0]

record(bo, "$(P)$(R)DevEnbl-Sel") {
  field(DESC, "EVR enable")
  field(MASK, "1")
  field(DTYP, "stream")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(OUT, "@timing.proto evre_ctrl_set($(P),$(R)) $(PORT)")
}

record(mbbiDirect, "$(P)$(R)DevEnblRaw") {
  field(ASG, "Reserved")
  field(DESC, "EVR enable status RAW")
  field(NOBT, "1")
  field(SCAN, "I/O Intr")
  field(DTYP, "stream")
  field(INP, "@timing.proto evre_ctrl_enableRAW_intr $(PORT)")
  field(FLNK, "$(P)$(R)DevEnbl-Sts")
}

record(bi, "$(P)$(R)DevEnbl-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR enable status")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(INP, "$(P)$(R)DevEnblRaw.B0")
}

record(mbbiDirect, "$(P)$(R)LinkIntlkRaw") {
  field(ASG, "Reserved")
  field(DESC, "EVR link and inhs status")
  field(NOBT, "8")
  field(SHFT, "6")
  field(SCAN, "I/O Intr")
  field(DTYP, "stream")
  field(INP, "@timing.proto evre_ctrl_linkinhs_intr $(PORT)")
  field(FLNK, "$(P)$(R)Intlk-Mon")
}

record(bi, "$(P)$(R)Intlk-Mon") {
  field(ASG, "Reserved")
  field(DESC, "EVR interlock status")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(INP, "$(P)$(R)LinkIntlkRaw.B0")
  field(FLNK, "$(P)$(R)Link-Mon")
}

record(mbbiDirect, "$(P)$(R)Los-Mon") {
  field(DESC, "Downlink status in OUT0-OUT7")
  field(NOBT, "8")
  field(DTYP, "stream")
  field(SCAN, "I/O Intr")
  field(INP, "@timing.proto evg_ctrl_los_intr $(PORT)")
}

record(bi, "$(P)$(R)Link-Mon") {
  field(ASG, "Reserved")
  field(DESC, "EVR fibre link status")
  field(ZNAM, "Unlink")
  field(ONAM, "Link")
  field(INP, "$(P)$(R)LinkIntlkRaw.B1")
}

record(longout, "$(P)$(R)cmd_ctrl_get") {
  field(ASG, "Reserved")
  field(DESC, "Command code to read Ctrl Status reg")
  field(VAL, "0x80") # (0x80 | reg number)
  field(SCAN, "1 second")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_ctrl_get($(P),$(R)) $(PORT)")
}

record(longout, "$(P)$(R)cmd_ctrl_set") {
  field(ASG, "Reserved")
  field(DESC, "Command code to write to Ctrl Status reg")
  field(VAL, "0x40") # (0x40 | reg number)
}

########################################################################
# OTP0 Register [1]

record(longout, "$(P)$(R)OTP00Evt-SP") {
  field(DESC, "EVR OTP0 event code")
  field(DRVH, "63")
  field(DRVL, "0")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_otp_ev_set($(P),$(R),00) $(PORT)")
  field(FLNK, "$(P)$(R)OTP00DelayRaw")
}

record(longout, "$(P)$(R)OTP00NrPulses-SP"){
  field(VAL, "1")
  field(DESC, "EVR OTP0 number of pulses")
  field(DRVH, "65535")
  field(DRVL, "1")
  field(EGU, "pulses")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_otp_pulses_set($(P),$(R),00) $(PORT)")
  field(FLNK, "$(P)$(R)OTP00DelayRaw")
}

record(ao, "$(P)$(R)OTP00WidthTime-SP") {
  field(DESC, "EVR OTP00 trigger width time")
  field(VAL, "0.008")
  field(DRVH, "17000000")
  field(DRVL, "0.008")
  field(EGU, "us")
  field(FLNK, "$(P)$(R)OTP00WidthCalc")
}

record(calcout, "$(P)$(R)OTP00WidthCalc") {
  field(DESC, "EVR OTP00 trigger width calc")
  field(INPA, "$(P)$(R)OTP00WidthTime-SP")
  field(INPB, "$(P)TI-EVG:FPGAClk-Cte")
  field(CALC, "CEIL(A/(B*1000000))-A/(B*1000000)<0.5?CEIL(A/(B*1000000)):FLOOR(A/(B*1000000))")
  field(OUT, "$(P)$(R)OTP00Width-SP PP")
}

record(longout, "$(P)$(R)OTP00Width-SP") {
  field(DESC, "EVR OTP00 trigger width")
  field(VAL, "1")
  field(DRVH, "2147483647")
  field(DRVL, "1")
  field(EGU, "evt_T")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_otp_width_set($(P),$(R),00) $(PORT)")
  field(FLNK, "$(P)$(R)OTP00DelayRaw")
}

record(ao, "$(P)$(R)OTP00DelayTime-SP") {
  field(DESC, "EVR OTP00 trigger delay time")
  field(VAL, "0")
  field(DRVH, "17000000")
  field(DRVL, "0")
  field(EGU, "us")
  field(FLNK, "$(P)$(R)OTP00DelayTimeCalc")
}

record(calcout, "$(P)$(R)OTP00DelayTimeCalc") {
  field(DESC, "EVR OTP00 trigger delay calc")
  field(INPA, "$(P)$(R)OTP00DelayTime-SP")
  field(INPB, "$(P)TI-EVG:FPGAClk-Cte")
  field(CALC, "CEIL(A/(B*1000000))-A/(B*1000000)<0.5?CEIL(A/(B*1000000)):FLOOR(A/(B*1000000))")
  field(OUT, "$(P)$(R)OTP00Delay-SP PP")
}

record(longout, "$(P)$(R)OTP00Delay-SP") {
  field(DESC, "EVR OTP00 event delay")
  field(DRVH, "2147483647")
  field(DRVL, "1")
  field(EGU, "evt_T")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_otp_dly_set($(P),$(R),00) $(PORT)")
  field(FLNK, "$(P)$(R)OTP00DelayRaw")
}

record(bo, "$(P)$(R)OTP00State-Sel") {
  field(DESC, "EVR OTP0 enable")
  field(MASK, "1")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(FLNK, "$(P)$(R)OTP00StateCalc")
}

record(bo, "$(P)$(R)OTP00Polarity-Sel") {
  field(DESC, "EVR OTP0 polarity")
  field(MASK, "1")
  field(ZNAM, "Normal")
  field(ONAM, "Inverse")
  field(FLNK, "$(P)$(R)OTP00PolCalc")
}

record(bo, "$(P)$(R)OTP00Log-Sel") {
  field(DESC, "EVR OTP0 event timestamping enable")
  field(MASK, "1")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(FLNK, "$(P)$(R)OTP00LogCalc")
}

record(bo, "$(P)$(R)OTP00Intlk-Sel") {
  field(DESC, "EVR OTP0 interlock function selection")
  field(MASK, "1")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(FLNK, "$(P)$(R)OTP00IntlkCalc")
}

record(calcout, "$(P)$(R)OTP00StateCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP0 set enable calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OTP00State-Sel.RVAL")
  field(INPB, "$(P)$(R)OTP00Polarity-Sts.VAL")
  field(INPC, "$(P)$(R)OTP00Log-Sts.VAL")
  field(INPD, "$(P)$(R)OTP00Intlk-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
  field(OUT, "@timing.proto evre_otp_en_pol_time_itl_set($(P),$(R),00,State) $(PORT)")
  field(FLNK, "$(P)$(R)OTP00DelayCalc")
}

record(calcout, "$(P)$(R)OTP00PolCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP0 set polarity calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OTP00State-Sts.VAL")
  field(INPB, "$(P)$(R)OTP00Polarity-Sel.RVAL")
  field(INPC, "$(P)$(R)OTP00Log-Sts.VAL")
  field(INPD, "$(P)$(R)OTP00Intlk-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
  field(OUT, "@timing.proto evre_otp_en_pol_time_itl_set($(P),$(R),00,Pol) $(PORT)")
  field(FLNK, "$(P)$(R)OTP00DelayCalc")
}

record(calcout, "$(P)$(R)OTP00LogCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP0 set timestamping calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OTP00State-Sts.VAL")
  field(INPB, "$(P)$(R)OTP00Polarity-Sts.VAL")
  field(INPC, "$(P)$(R)OTP00Log-Sel.RVAL")
  field(INPD, "$(P)$(R)OTP00Intlk-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
  field(OUT, "@timing.proto evre_otp_en_pol_time_itl_set($(P),$(R),00,Log) $(PORT)")
  field(FLNK, "$(P)$(R)OTP00DelayCalc")
}

record(calcout, "$(P)$(R)OTP00IntlkCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP0 set interlock calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OTP00State-Sts.VAL")
  field(INPB, "$(P)$(R)OTP00Polarity-Sts.VAL")
  field(INPC, "$(P)$(R)OTP00Log-Sts.VAL")
  field(INPD, "$(P)$(R)OTP00Intlk-Sel.RVAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
  field(OUT, "@timing.proto evre_otp_en_pol_time_itl_set($(P),$(R),00,Intlk) $(PORT)")
  field(FLNK, "$(P)$(R)OTP00DelayCalc")
}

record(calcout, "$(P)$(R)OTP00DelayCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP0 download EN, POL, and TIME")
  field(INPA, "$(P)$(R)OTP00State-Sel.RVAL")
  field(INPB, "$(P)$(R)OTP00Polarity-Sel.RVAL")
  field(INPC, "$(P)$(R)OTP00Log-Sel.RVAL")
  field(INPD, "$(P)$(R)OTP00Intlk-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
}

record(mbbiDirect, "$(P)$(R)OTP00DelayRaw") {
  field(ASG, "Reserved")
  field(DESC, "OTP0 enable, pol, timelog and intlk RBV")
  field(NOBT, "8")
  field(SCAN, "I/O Intr")
  field(DTYP, "stream")
  field(INP, "@timing.proto evre_otp_enpoltime0RBV_intr $(PORT)")
  field(FLNK, "$(P)$(R)OTP00Intlk-Sts")
}

record(bi, "$(P)$(R)OTP00Intlk-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP0 interlock status")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(INP, "$(P)$(R)OTP00DelayRaw.B4")
  field(FLNK, "$(P)$(R)OTP00Log-Sts")
}

record(bi, "$(P)$(R)OTP00Log-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP0 timestamping status")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(INP, "$(P)$(R)OTP00DelayRaw.B5")
  field(FLNK, "$(P)$(R)OTP00Polarity-Sts")
}

record(bi, "$(P)$(R)OTP00Polarity-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP0 polarity status")
  field(ZNAM, "Normal")
  field(ONAM, "Inverse")
  field(INP, "$(P)$(R)OTP00DelayRaw.B6")
  field(FLNK, "$(P)$(R)OTP00State-Sts")
}

record(bi, "$(P)$(R)OTP00State-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP0 enable status")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(INP, "$(P)$(R)OTP00DelayRaw.B7")
}

record(longin, "$(P)$(R)OTP00NrPulses-RB"){
  field(ASG, "Reserved")
  field(DESC, "EVR OTP0 number of pulses RBV")
  field(EGU, "pulses")
}

record(longin, "$(P)$(R)OTP00Evt-RB") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP0 event RBV")
}

record(longin, "$(P)$(R)OTP00Width-RB") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP0 width RBV")
  field(EGU, "evt_T")
  field(FLNK, "$(P)$(R)OTP00WidthTime-RB")
}

record(longin, "$(P)$(R)OTP00Delay-RB") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP0 delay RBV")
  field(EGU, "evt_T")
  field(FLNK, "$(P)$(R)OTP00DelayTime-RB")
}

record(calc, "$(P)$(R)OTP00WidthTime-RB") {
  field(INPA, "$(P)$(R)OTP00Width-RB")
  field(INPB, "$(P)TI-EVG:FPGAClk-Cte")
  field(PREC, "3")
  field(DESC, "EVR OTP0 width time RBV")
  field(EGU, "us")
  field(CALC, "A*B*1000000")
}

record(calc, "$(P)$(R)OTP00DelayTime-RB") {
  field(INPA, "$(P)$(R)OTP00Delay-RB")
  field(INPB, "$(P)TI-EVG:FPGAClk-Cte")
  field(PREC, "3")
  field(DESC, "EVR OTP0 delay time RBV")
  field(EGU, "us")
  field(CALC, "A*B*1000000")
}

record(longout, "$(P)$(R)cmd_otp_set00") {
  field(ASG, "Reserved")
  field(DESC, "Command code to write to OTP0")
  field(VAL, "0x41") # (0x40 | reg number=1)
}

record(longout, "$(P)$(R)cmd_otp_get00") {
  field(ASG, "Reserved")
  field(DESC, "Command code to read OTP0")
  field(VAL, "0x81") # (0x80 | reg number=1)
}

########################################################################
# OTP1 Register [2]

record(longout, "$(P)$(R)OTP01Evt-SP") {
  field(DESC, "EVR event code")
  field(DRVH, "63")
  field(DRVL, "0")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_otp_ev_set($(P),$(R),01) $(PORT)")
  field(FLNK, "$(P)$(R)OTP01DelayRaw")
}

record(longout, "$(P)$(R)OTP01NrPulses-SP"){
  field(VAL, "1")
  field(DESC, "EVR OTP1 number of pulses")
  field(DRVH, "65535")
  field(DRVL, "1")
  field(EGU, "pulses")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_otp_pulses_set($(P),$(R),01) $(PORT)")
  field(FLNK, "$(P)$(R)OTP01DelayRaw")
}

record(ao, "$(P)$(R)OTP01WidthTime-SP") {
  field(DESC, "EVR OTP01 trigger width time")
  field(VAL, "0.008")
  field(DRVH, "17000000")
  field(DRVL, "0.008")
  field(EGU, "us")
  field(FLNK, "$(P)$(R)OTP01WidthCalc")
}

record(calcout, "$(P)$(R)OTP01WidthCalc") {
  field(DESC, "EVR OTP01 trigger width calc")
  field(INPA, "$(P)$(R)OTP01WidthTime-SP")
  field(INPB, "$(P)TI-EVG:FPGAClk-Cte")
  field(CALC, "CEIL(A/(B*1000000))-A/(B*1000000)<0.5?CEIL(A/(B*1000000)):FLOOR(A/(B*1000000))")
  field(OUT, "$(P)$(R)OTP01Width-SP PP")
}

record(longout, "$(P)$(R)OTP01Width-SP") {
  field(DESC, "EVR OTP01 trigger width")
  field(VAL, "1")
  field(DRVH, "2147483647")
  field(DRVL, "1")
  field(EGU, "evt_T")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_otp_width_set($(P),$(R),01) $(PORT)")
  field(FLNK, "$(P)$(R)OTP01DelayRaw")
}

record(ao, "$(P)$(R)OTP01DelayTime-SP") {
  field(DESC, "EVR OTP01 trigger delay time")
  field(VAL, "0")
  field(DRVH, "17000000")
  field(DRVL, "0")
  field(EGU, "us")
  field(FLNK, "$(P)$(R)OTP01DelayTimeCalc")
}

record(calcout, "$(P)$(R)OTP01DelayTimeCalc") {
  field(DESC, "EVR OTP01 trigger delay calc")
  field(INPA, "$(P)$(R)OTP01DelayTime-SP")
  field(INPB, "$(P)TI-EVG:FPGAClk-Cte")
  field(CALC, "CEIL(A/(B*1000000))-A/(B*1000000)<0.5?CEIL(A/(B*1000000)):FLOOR(A/(B*1000000))")
  field(OUT, "$(P)$(R)OTP01Delay-SP PP")
}

record(longout, "$(P)$(R)OTP01Delay-SP") {
  field(DESC, "EVR OTP01 event delay")
  field(DRVH, "2147483647")
  field(DRVL, "1")
  field(EGU, "evt_T")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_otp_dly_set($(P),$(R),01) $(PORT)")
  field(FLNK, "$(P)$(R)OTP01DelayRaw")
}

record(bo, "$(P)$(R)OTP01State-Sel") {
  field(DESC, "EVR OTP1 enable")
  field(MASK, "1")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(FLNK, "$(P)$(R)OTP01StateCalc")
}

record(bo, "$(P)$(R)OTP01Polarity-Sel") {
  field(DESC, "EVR OTP1 polarity")
  field(MASK, "1")
  field(ZNAM, "Normal")
  field(ONAM, "Inverse")
  field(FLNK, "$(P)$(R)OTP01PolCalc")
}

record(bo, "$(P)$(R)OTP01Log-Sel") {
  field(DESC, "EVR OTP1 event timestamping enable")
  field(MASK, "1")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(FLNK, "$(P)$(R)OTP01LogCalc")
}

record(bo, "$(P)$(R)OTP01Intlk-Sel") {
  field(DESC, "EVR OTP1 interlock function selection")
  field(MASK, "1")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(FLNK, "$(P)$(R)OTP01IntlkCalc")
}

record(calcout, "$(P)$(R)OTP01StateCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP1 set enable calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OTP01State-Sel.RVAL")
  field(INPB, "$(P)$(R)OTP01Polarity-Sts.VAL")
  field(INPC, "$(P)$(R)OTP01Log-Sts.VAL")
  field(INPD, "$(P)$(R)OTP01Intlk-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
  field(OUT, "@timing.proto evre_otp_en_pol_time_itl_set($(P),$(R),01,State) $(PORT)")
  field(FLNK, "$(P)$(R)OTP01DelayCalc")
}

record(calcout, "$(P)$(R)OTP01PolCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP1 set polarity calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OTP01State-Sts.VAL")
  field(INPB, "$(P)$(R)OTP01Polarity-Sel.RVAL")
  field(INPC, "$(P)$(R)OTP01Log-Sts.VAL")
  field(INPD, "$(P)$(R)OTP01Intlk-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
  field(OUT, "@timing.proto evre_otp_en_pol_time_itl_set($(P),$(R),01,Pol) $(PORT)")
  field(FLNK, "$(P)$(R)OTP01DelayCalc")
}

record(calcout, "$(P)$(R)OTP01LogCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP1 set timestamping calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OTP01State-Sts.VAL")
  field(INPB, "$(P)$(R)OTP01Polarity-Sts.VAL")
  field(INPC, "$(P)$(R)OTP01Log-Sel.RVAL")
  field(INPD, "$(P)$(R)OTP01Intlk-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
  field(OUT, "@timing.proto evre_otp_en_pol_time_itl_set($(P),$(R),01,Log) $(PORT)")
  field(FLNK, "$(P)$(R)OTP01DelayCalc")
}

record(calcout, "$(P)$(R)OTP01IntlkCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP1 set interlock calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OTP01State-Sts.VAL")
  field(INPB, "$(P)$(R)OTP01Polarity-Sts.VAL")
  field(INPC, "$(P)$(R)OTP01Log-Sts.VAL")
  field(INPD, "$(P)$(R)OTP01Intlk-Sel.RVAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
  field(OUT, "@timing.proto evre_otp_en_pol_time_itl_set($(P),$(R),01,Intlk) $(PORT)")
  field(FLNK, "$(P)$(R)OTP01DelayCalc")
}

record(calcout, "$(P)$(R)OTP01DelayCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP1 download EN, POL, and TIME")
  field(INPA, "$(P)$(R)OTP01State-Sel.RVAL")
  field(INPB, "$(P)$(R)OTP01Polarity-Sel.RVAL")
  field(INPC, "$(P)$(R)OTP01Log-Sel.RVAL")
  field(INPD, "$(P)$(R)OTP01Intlk-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
}

record(mbbiDirect, "$(P)$(R)OTP01DelayRaw") {
  field(ASG, "Reserved")
  field(DESC, "OTP1 enable, pol, timelog and intlk RBV")
  field(NOBT, "8")
  field(SCAN, "I/O Intr")
  field(DTYP, "stream")
  field(INP, "@timing.proto evre_otp_enpoltime1RBV_intr $(PORT)")
  field(FLNK, "$(P)$(R)OTP01Intlk-Sts")
}

record(bi, "$(P)$(R)OTP01Intlk-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP1 interlock status")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(INP, "$(P)$(R)OTP01DelayRaw.B4")
  field(FLNK, "$(P)$(R)OTP01Log-Sts")
}

record(bi, "$(P)$(R)OTP01Log-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP1 timestamping status")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(INP, "$(P)$(R)OTP01DelayRaw.B5")
  field(FLNK, "$(P)$(R)OTP01Polarity-Sts")
}

record(bi, "$(P)$(R)OTP01Polarity-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP1 polarity status")
  field(ZNAM, "Normal")
  field(ONAM, "Inverse")
  field(INP, "$(P)$(R)OTP01DelayRaw.B6")
  field(FLNK, "$(P)$(R)OTP01State-Sts")
}

record(bi, "$(P)$(R)OTP01State-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP1 enable status")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(INP, "$(P)$(R)OTP01DelayRaw.B7")
}

record(longin, "$(P)$(R)OTP01NrPulses-RB"){
  field(ASG, "Reserved")
  field(DESC, "EVR OTP1 number of pulses RBV")
  field(EGU, "pulses")
}

record(longin, "$(P)$(R)OTP01Evt-RB") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP1 event RBV")
}

record(longin, "$(P)$(R)OTP01Width-RB") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP1 width RBV")
  field(EGU, "evt_T")
  field(FLNK, "$(P)$(R)OTP01WidthTime-RB")
}

record(longin, "$(P)$(R)OTP01Delay-RB") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP1 delay RBV")
  field(EGU, "evt_T")
  field(FLNK, "$(P)$(R)OTP01DelayTime-RB")
}

record(calc, "$(P)$(R)OTP01WidthTime-RB") {
  field(INPA, "$(P)$(R)OTP01Width-RB")
  field(INPB, "$(P)TI-EVG:FPGAClk-Cte")
  field(PREC, "3")
  field(DESC, "EVR OTP1 width time RBV")
  field(EGU, "us")
  field(CALC, "A*B*1000000")
}

record(calc, "$(P)$(R)OTP01DelayTime-RB") {
  field(INPA, "$(P)$(R)OTP01Delay-RB")
  field(INPB, "$(P)TI-EVG:FPGAClk-Cte")
  field(PREC, "3")
  field(DESC, "EVR OTP1 delay time RBV")
  field(EGU, "us")
  field(CALC, "A*B*1000000")
}

record(longout, "$(P)$(R)cmd_otp_set01") {
  field(ASG, "Reserved")
  field(DESC, "Command code to write to OTP1")
  field(VAL, "0x42") # (0x40 | reg number=2)
}

record(longout, "$(P)$(R)cmd_otp_get01") {
  field(ASG, "Reserved")
  field(DESC, "Command code to read OTP1")
  field(VAL, "0x82") # (0x80 | reg number=2)
}

########################################################################
# OTP2 Register [3]

record(longout, "$(P)$(R)OTP02Evt-SP") {
  field(DESC, "EVR event code")
  field(DRVH, "63")
  field(DRVL, "0")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_otp_ev_set($(P),$(R),02) $(PORT)")
  field(FLNK, "$(P)$(R)OTP02DelayRaw")
}

record(longout, "$(P)$(R)OTP02NrPulses-SP"){
  field(VAL, "1")
  field(DESC, "EVR OTP2 number of pulses")
  field(DRVH, "65535")
  field(DRVL, "1")
  field(EGU, "pulses")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_otp_pulses_set($(P),$(R),02) $(PORT)")
  field(FLNK, "$(P)$(R)OTP02DelayRaw")
}

record(ao, "$(P)$(R)OTP02WidthTime-SP") {
  field(DESC, "EVR OTP02 trigger width time")
  field(VAL, "0.008")
  field(DRVH, "17000000")
  field(DRVL, "0.008")
  field(EGU, "us")
  field(FLNK, "$(P)$(R)OTP02WidthCalc")
}

record(calcout, "$(P)$(R)OTP02WidthCalc") {
  field(DESC, "EVR OTP02 trigger width calc")
  field(INPA, "$(P)$(R)OTP02WidthTime-SP")
  field(INPB, "$(P)TI-EVG:FPGAClk-Cte")
  field(CALC, "CEIL(A/(B*1000000))-A/(B*1000000)<0.5?CEIL(A/(B*1000000)):FLOOR(A/(B*1000000))")
  field(OUT, "$(P)$(R)OTP02Width-SP PP")
}

record(longout, "$(P)$(R)OTP02Width-SP") {
  field(DESC, "EVR OTP02 trigger width")
  field(VAL, "1")
  field(DRVH, "2147483647")
  field(DRVL, "1")
  field(EGU, "evt_T")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_otp_width_set($(P),$(R),02) $(PORT)")
  field(FLNK, "$(P)$(R)OTP02DelayRaw")
}

record(ao, "$(P)$(R)OTP02DelayTime-SP") {
  field(DESC, "EVR OTP02 trigger delay time")
  field(VAL, "0")
  field(DRVH, "17000000")
  field(DRVL, "0")
  field(EGU, "us")
  field(FLNK, "$(P)$(R)OTP02DelayTimeCalc")
}

record(calcout, "$(P)$(R)OTP02DelayTimeCalc") {
  field(DESC, "EVR OTP02 trigger delay calc")
  field(INPA, "$(P)$(R)OTP02DelayTime-SP")
  field(INPB, "$(P)TI-EVG:FPGAClk-Cte")
  field(CALC, "CEIL(A/(B*1000000))-A/(B*1000000)<0.5?CEIL(A/(B*1000000)):FLOOR(A/(B*1000000))")
  field(OUT, "$(P)$(R)OTP02Delay-SP PP")
}

record(longout, "$(P)$(R)OTP02Delay-SP") {
  field(DESC, "EVR OTP02 event delay")
  field(DRVH, "2147483647")
  field(DRVL, "1")
  field(EGU, "evt_T")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_otp_dly_set($(P),$(R),02) $(PORT)")
  field(FLNK, "$(P)$(R)OTP02DelayRaw")
}

record(bo, "$(P)$(R)OTP02State-Sel") {
  field(DESC, "EVR OTP2 enable")
  field(MASK, "1")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(FLNK, "$(P)$(R)OTP02StateCalc")
}

record(bo, "$(P)$(R)OTP02Polarity-Sel") {
  field(DESC, "EVR OTP2 polarity")
  field(MASK, "1")
  field(ZNAM, "Normal")
  field(ONAM, "Inverse")
  field(FLNK, "$(P)$(R)OTP02PolCalc")
}

record(bo, "$(P)$(R)OTP02Log-Sel") {
  field(DESC, "EVR OTP2 event timestamping enable")
  field(MASK, "1")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(FLNK, "$(P)$(R)OTP02LogCalc")
}

record(bo, "$(P)$(R)OTP02Intlk-Sel") {
  field(DESC, "EVR OTP2 interlock function selection")
  field(MASK, "1")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(FLNK, "$(P)$(R)OTP02IntlkCalc")
}

record(calcout, "$(P)$(R)OTP02StateCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP2 set enable calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OTP02State-Sel.RVAL")
  field(INPB, "$(P)$(R)OTP02Polarity-Sts.VAL")
  field(INPC, "$(P)$(R)OTP02Log-Sts.VAL")
  field(INPD, "$(P)$(R)OTP02Intlk-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
  field(OUT, "@timing.proto evre_otp_en_pol_time_itl_set($(P),$(R),02,State) $(PORT)")
  field(FLNK, "$(P)$(R)OTP02DelayCalc")
}

record(calcout, "$(P)$(R)OTP02PolCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP2 set polarity calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OTP02State-Sts.VAL")
  field(INPB, "$(P)$(R)OTP02Polarity-Sel.RVAL")
  field(INPC, "$(P)$(R)OTP02Log-Sts.VAL")
  field(INPD, "$(P)$(R)OTP02Intlk-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
  field(OUT, "@timing.proto evre_otp_en_pol_time_itl_set($(P),$(R),02,Pol) $(PORT)")
  field(FLNK, "$(P)$(R)OTP02DelayCalc")
}

record(calcout, "$(P)$(R)OTP02LogCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP2 set timestamping calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OTP02State-Sts.VAL")
  field(INPB, "$(P)$(R)OTP02Polarity-Sts.VAL")
  field(INPC, "$(P)$(R)OTP02Log-Sel.RVAL")
  field(INPD, "$(P)$(R)OTP02Intlk-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
  field(OUT, "@timing.proto evre_otp_en_pol_time_itl_set($(P),$(R),02,Log) $(PORT)")
  field(FLNK, "$(P)$(R)OTP02DelayCalc")
}

record(calcout, "$(P)$(R)OTP02IntlkCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP2 set interlock calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OTP02State-Sts.VAL")
  field(INPB, "$(P)$(R)OTP02Polarity-Sts.VAL")
  field(INPC, "$(P)$(R)OTP02Log-Sts.VAL")
  field(INPD, "$(P)$(R)OTP02Intlk-Sel.RVAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
  field(OUT, "@timing.proto evre_otp_en_pol_time_itl_set($(P),$(R),02,Intlk) $(PORT)")
  field(FLNK, "$(P)$(R)OTP02DelayCalc")
}

record(calcout, "$(P)$(R)OTP02DelayCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP2 download EN, POL, and TIME")
  field(INPA, "$(P)$(R)OTP02State-Sel.RVAL")
  field(INPB, "$(P)$(R)OTP02Polarity-Sel.RVAL")
  field(INPC, "$(P)$(R)OTP02Log-Sel.RVAL")
  field(INPD, "$(P)$(R)OTP02Intlk-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
}

record(mbbiDirect, "$(P)$(R)OTP02DelayRaw") {
  field(ASG, "Reserved")
  field(DESC, "OTP2 enable, pol, timelog and intlk RBV")
  field(NOBT, "8")
  field(SCAN, "I/O Intr")
  field(DTYP, "stream")
  field(INP, "@timing.proto evre_otp_enpoltime2RBV_intr $(PORT)")
  field(FLNK, "$(P)$(R)OTP02Intlk-Sts")
}

record(bi, "$(P)$(R)OTP02Intlk-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP2 interlock status")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(INP, "$(P)$(R)OTP02DelayRaw.B4")
  field(FLNK, "$(P)$(R)OTP02Log-Sts")
}

record(bi, "$(P)$(R)OTP02Log-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP2 timestamping status")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(INP, "$(P)$(R)OTP02DelayRaw.B5")
  field(FLNK, "$(P)$(R)OTP02Polarity-Sts")
}

record(bi, "$(P)$(R)OTP02Polarity-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP2 polarity status")
  field(ZNAM, "Normal")
  field(ONAM, "Inverse")
  field(INP, "$(P)$(R)OTP02DelayRaw.B6")
  field(FLNK, "$(P)$(R)OTP02State-Sts")
}

record(bi, "$(P)$(R)OTP02State-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP2 enable status")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(INP, "$(P)$(R)OTP02DelayRaw.B7")
}

record(longin, "$(P)$(R)OTP02NrPulses-RB"){
  field(ASG, "Reserved")
  field(DESC, "EVR OTP2 number of pulses RBV")
  field(EGU, "pulses")
}

record(longin, "$(P)$(R)OTP02Evt-RB") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP2 event RBV")
}

record(longin, "$(P)$(R)OTP02Width-RB") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP2 width RBV")
  field(EGU, "evt_T")
  field(FLNK, "$(P)$(R)OTP02WidthTime-RB")
}

record(longin, "$(P)$(R)OTP02Delay-RB") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP2 delay RBV")
  field(EGU, "evt_T")
  field(FLNK, "$(P)$(R)OTP02DelayTime-RB")
}

record(calc, "$(P)$(R)OTP02WidthTime-RB") {
  field(INPA, "$(P)$(R)OTP02Width-RB")
  field(INPB, "$(P)TI-EVG:FPGAClk-Cte")
  field(PREC, "3")
  field(DESC, "EVR OTP2 width time RBV")
  field(EGU, "us")
  field(CALC, "A*B*1000000")
}

record(calc, "$(P)$(R)OTP02DelayTime-RB") {
  field(INPA, "$(P)$(R)OTP02Delay-RB")
  field(INPB, "$(P)TI-EVG:FPGAClk-Cte")
  field(PREC, "3")
  field(DESC, "EVR OTP2 delay time RBV")
  field(EGU, "us")
  field(CALC, "A*B*1000000")
}

record(longout, "$(P)$(R)cmd_otp_set02") {
  field(ASG, "Reserved")
  field(DESC, "Command code to write to OTP2")
  field(VAL, "0x43") # (0x40 | reg number=3)
}

record(longout, "$(P)$(R)cmd_otp_get02") {
  field(ASG, "Reserved")
  field(DESC, "Command code to read OTP2")
  field(VAL, "0x83") # (0x80 | reg number=3)
}

########################################################################
# OTP3 Register [4]

record(longout, "$(P)$(R)OTP03Evt-SP") {
  field(DESC, "EVR event code")
  field(DRVH, "63")
  field(DRVL, "0")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_otp_ev_set($(P),$(R),03) $(PORT)")
  field(FLNK, "$(P)$(R)OTP03DelayRaw")
}

record(longout, "$(P)$(R)OTP03NrPulses-SP"){
  field(VAL, "1")
  field(DESC, "EVR OTP3 number of pulses")
  field(DRVH, "65535")
  field(DRVL, "1")
  field(EGU, "pulses")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_otp_pulses_set($(P),$(R),03) $(PORT)")
  field(FLNK, "$(P)$(R)OTP03DelayRaw")
}

record(ao, "$(P)$(R)OTP03WidthTime-SP") {
  field(DESC, "EVR OTP03 trigger width time")
  field(VAL, "0.008")
  field(DRVH, "17000000")
  field(DRVL, "0.008")
  field(EGU, "us")
  field(FLNK, "$(P)$(R)OTP03WidthCalc")
}

record(calcout, "$(P)$(R)OTP03WidthCalc") {
  field(DESC, "EVR OTP03 trigger width calc")
  field(INPA, "$(P)$(R)OTP03WidthTime-SP")
  field(INPB, "$(P)TI-EVG:FPGAClk-Cte")
  field(CALC, "CEIL(A/(B*1000000))-A/(B*1000000)<0.5?CEIL(A/(B*1000000)):FLOOR(A/(B*1000000))")
  field(OUT, "$(P)$(R)OTP03Width-SP PP")
}

record(longout, "$(P)$(R)OTP03Width-SP") {
  field(DESC, "EVR OTP03 trigger width")
  field(VAL, "1")
  field(DRVH, "2147483647")
  field(DRVL, "1")
  field(EGU, "evt_T")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_otp_width_set($(P),$(R),03) $(PORT)")
  field(FLNK, "$(P)$(R)OTP03DelayRaw")
}

record(ao, "$(P)$(R)OTP03DelayTime-SP") {
  field(DESC, "EVR OTP03 trigger delay time")
  field(VAL, "0")
  field(DRVH, "17000000")
  field(DRVL, "0")
  field(EGU, "us")
  field(FLNK, "$(P)$(R)OTP03DelayTimeCalc")
}

record(calcout, "$(P)$(R)OTP03DelayTimeCalc") {
  field(DESC, "EVR OTP03 trigger delay calc")
  field(INPA, "$(P)$(R)OTP03DelayTime-SP")
  field(INPB, "$(P)TI-EVG:FPGAClk-Cte")
  field(CALC, "CEIL(A/(B*1000000))-A/(B*1000000)<0.5?CEIL(A/(B*1000000)):FLOOR(A/(B*1000000))")
  field(OUT, "$(P)$(R)OTP03Delay-SP PP")
}

record(longout, "$(P)$(R)OTP03Delay-SP") {
  field(DESC, "EVR OTP03 event delay")
  field(DRVH, "2147483647")
  field(DRVL, "1")
  field(EGU, "evt_T")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_otp_dly_set($(P),$(R),03) $(PORT)")
  field(FLNK, "$(P)$(R)OTP03DelayRaw")
}

record(bo, "$(P)$(R)OTP03State-Sel") {
  field(DESC, "EVR OTP3 enable")
  field(MASK, "1")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(FLNK, "$(P)$(R)OTP03StateCalc")
}

record(bo, "$(P)$(R)OTP03Polarity-Sel") {
  field(DESC, "EVR OTP3 polarity")
  field(MASK, "1")
  field(ZNAM, "Normal")
  field(ONAM, "Inverse")
  field(FLNK, "$(P)$(R)OTP03PolCalc")
}

record(bo, "$(P)$(R)OTP03Log-Sel") {
  field(DESC, "EVR OTP3 event timestamping enable")
  field(MASK, "1")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(FLNK, "$(P)$(R)OTP03LogCalc")
}

record(bo, "$(P)$(R)OTP03Intlk-Sel") {
  field(DESC, "EVR OTP3 interlock function selection")
  field(MASK, "1")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(FLNK, "$(P)$(R)OTP03IntlkCalc")
}

record(calcout, "$(P)$(R)OTP03StateCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP3 set enable calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OTP03State-Sel.RVAL")
  field(INPB, "$(P)$(R)OTP03Polarity-Sts.VAL")
  field(INPC, "$(P)$(R)OTP03Log-Sts.VAL")
  field(INPD, "$(P)$(R)OTP03Intlk-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
  field(OUT, "@timing.proto evre_otp_en_pol_time_itl_set($(P),$(R),03,State) $(PORT)")
  field(FLNK, "$(P)$(R)OTP03DelayCalc")
}

record(calcout, "$(P)$(R)OTP03PolCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP3 set polarity calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OTP03State-Sts.VAL")
  field(INPB, "$(P)$(R)OTP03Polarity-Sel.RVAL")
  field(INPC, "$(P)$(R)OTP03Log-Sts.VAL")
  field(INPD, "$(P)$(R)OTP03Intlk-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
  field(OUT, "@timing.proto evre_otp_en_pol_time_itl_set($(P),$(R),03,Pol) $(PORT)")
  field(FLNK, "$(P)$(R)OTP03DelayCalc")
}

record(calcout, "$(P)$(R)OTP03LogCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP3 set timestamping calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OTP03State-Sts.VAL")
  field(INPB, "$(P)$(R)OTP03Polarity-Sts.VAL")
  field(INPC, "$(P)$(R)OTP03Log-Sel.RVAL")
  field(INPD, "$(P)$(R)OTP03Intlk-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
  field(OUT, "@timing.proto evre_otp_en_pol_time_itl_set($(P),$(R),03,Log) $(PORT)")
  field(FLNK, "$(P)$(R)OTP03DelayCalc")
}

record(calcout, "$(P)$(R)OTP03IntlkCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP3 set interlock calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OTP03State-Sts.VAL")
  field(INPB, "$(P)$(R)OTP03Polarity-Sts.VAL")
  field(INPC, "$(P)$(R)OTP03Log-Sts.VAL")
  field(INPD, "$(P)$(R)OTP03Intlk-Sel.RVAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
  field(OUT, "@timing.proto evre_otp_en_pol_time_itl_set($(P),$(R),03,Intlk) $(PORT)")
  field(FLNK, "$(P)$(R)OTP03DelayCalc")
}

record(calcout, "$(P)$(R)OTP03DelayCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP3 download EN, POL, and TIME")
  field(INPA, "$(P)$(R)OTP03State-Sel.RVAL")
  field(INPB, "$(P)$(R)OTP03Polarity-Sel.RVAL")
  field(INPC, "$(P)$(R)OTP03Log-Sel.RVAL")
  field(INPD, "$(P)$(R)OTP03Intlk-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
}

record(mbbiDirect, "$(P)$(R)OTP03DelayRaw") {
  field(ASG, "Reserved")
  field(DESC, "OTP3 enable, pol, timelog and intlk RBV")
  field(NOBT, "8")
  field(SCAN, "I/O Intr")
  field(DTYP, "stream")
  field(INP, "@timing.proto evre_otp_enpoltime3RBV_intr $(PORT)")
  field(FLNK, "$(P)$(R)OTP03Intlk-Sts")
}

record(bi, "$(P)$(R)OTP03Intlk-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP3 interlock status")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(INP, "$(P)$(R)OTP03DelayRaw.B4")
  field(FLNK, "$(P)$(R)OTP03Log-Sts")
}

record(bi, "$(P)$(R)OTP03Log-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP3 timestamping status")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(INP, "$(P)$(R)OTP03DelayRaw.B5")
  field(FLNK, "$(P)$(R)OTP03Polarity-Sts")
}

record(bi, "$(P)$(R)OTP03Polarity-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP3 polarity status")
  field(ZNAM, "Normal")
  field(ONAM, "Inverse")
  field(INP, "$(P)$(R)OTP03DelayRaw.B6")
  field(FLNK, "$(P)$(R)OTP03State-Sts")
}

record(bi, "$(P)$(R)OTP03State-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP3 enable status")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(INP, "$(P)$(R)OTP03DelayRaw.B7")
}

record(longin, "$(P)$(R)OTP03NrPulses-RB"){
  field(ASG, "Reserved")
  field(DESC, "EVR OTP3 number of pulses RBV")
  field(EGU, "pulses")
}

record(longin, "$(P)$(R)OTP03Evt-RB") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP3 event RBV")
}

record(longin, "$(P)$(R)OTP03Width-RB") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP3 width RBV")
  field(EGU, "evt_T")
  field(FLNK, "$(P)$(R)OTP03WidthTime-RB")
}

record(longin, "$(P)$(R)OTP03Delay-RB") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP3 delay RBV")
  field(EGU, "evt_T")
  field(FLNK, "$(P)$(R)OTP03DelayTime-RB")
}

record(calc, "$(P)$(R)OTP03WidthTime-RB") {
  field(INPA, "$(P)$(R)OTP03Width-RB")
  field(INPB, "$(P)TI-EVG:FPGAClk-Cte")
  field(PREC, "3")
  field(DESC, "EVR OTP3 width time RBV")
  field(EGU, "us")
  field(CALC, "A*B*1000000")
}

record(calc, "$(P)$(R)OTP03DelayTime-RB") {
  field(INPA, "$(P)$(R)OTP03Delay-RB")
  field(INPB, "$(P)TI-EVG:FPGAClk-Cte")
  field(PREC, "3")
  field(DESC, "EVR OTP3 delay time RBV")
  field(EGU, "us")
  field(CALC, "A*B*1000000")
}

record(longout, "$(P)$(R)cmd_otp_set03") {
  field(ASG, "Reserved")
  field(DESC, "Command code to write to OTP3")
  field(VAL, "0x44") # (0x40 | reg number=4)
}

record(longout, "$(P)$(R)cmd_otp_get03") {
  field(ASG, "Reserved")
  field(DESC, "Command code to read OTP3")
  field(VAL, "0x84") # (0x80 | reg number=4)
}

########################################################################
# OTP4 Register [5]

record(longout, "$(P)$(R)OTP04Evt-SP") {
  field(DESC, "EVR event code")
  field(DRVH, "63")
  field(DRVL, "0")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_otp_ev_set($(P),$(R),04) $(PORT)")
  field(FLNK, "$(P)$(R)OTP04DelayRaw")
}

record(longout, "$(P)$(R)OTP04NrPulses-SP"){
  field(VAL, "1")
  field(DESC, "EVR OTP4 number of pulses")
  field(DRVH, "65535")
  field(DRVL, "1")
  field(EGU, "pulses")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_otp_pulses_set($(P),$(R),04) $(PORT)")
  field(FLNK, "$(P)$(R)OTP04DelayRaw")
}

record(ao, "$(P)$(R)OTP04WidthTime-SP") {
  field(DESC, "EVR OTP04 trigger width time")
  field(VAL, "0.008")
  field(DRVH, "17000000")
  field(DRVL, "0.008")
  field(EGU, "us")
  field(FLNK, "$(P)$(R)OTP04WidthCalc")
}

record(calcout, "$(P)$(R)OTP04WidthCalc") {
  field(DESC, "EVR OTP04 trigger width calc")
  field(INPA, "$(P)$(R)OTP04WidthTime-SP")
  field(INPB, "$(P)TI-EVG:FPGAClk-Cte")
  field(CALC, "CEIL(A/(B*1000000))-A/(B*1000000)<0.5?CEIL(A/(B*1000000)):FLOOR(A/(B*1000000))")
  field(OUT, "$(P)$(R)OTP04Width-SP PP")
}

record(longout, "$(P)$(R)OTP04Width-SP") {
  field(DESC, "EVR OTP04 trigger width")
  field(VAL, "1")
  field(DRVH, "2147483647")
  field(DRVL, "1")
  field(EGU, "evt_T")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_otp_width_set($(P),$(R),04) $(PORT)")
  field(FLNK, "$(P)$(R)OTP04DelayRaw")
}

record(ao, "$(P)$(R)OTP04DelayTime-SP") {
  field(DESC, "EVR OTP04 trigger delay time")
  field(VAL, "0")
  field(DRVH, "17000000")
  field(DRVL, "0")
  field(EGU, "us")
  field(FLNK, "$(P)$(R)OTP04DelayTimeCalc")
}

record(calcout, "$(P)$(R)OTP04DelayTimeCalc") {
  field(DESC, "EVR OTP04 trigger delay calc")
  field(INPA, "$(P)$(R)OTP04DelayTime-SP")
  field(INPB, "$(P)TI-EVG:FPGAClk-Cte")
  field(CALC, "CEIL(A/(B*1000000))-A/(B*1000000)<0.5?CEIL(A/(B*1000000)):FLOOR(A/(B*1000000))")
  field(OUT, "$(P)$(R)OTP04Delay-SP PP")
}

record(longout, "$(P)$(R)OTP04Delay-SP") {
  field(DESC, "EVR OTP04 event delay")
  field(DRVH, "2147483647")
  field(DRVL, "1")
  field(EGU, "evt_T")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_otp_dly_set($(P),$(R),04) $(PORT)")
  field(FLNK, "$(P)$(R)OTP04DelayRaw")
}

record(bo, "$(P)$(R)OTP04State-Sel") {
  field(DESC, "EVR OTP4 enable")
  field(MASK, "1")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(FLNK, "$(P)$(R)OTP04StateCalc")
}

record(bo, "$(P)$(R)OTP04Polarity-Sel") {
  field(DESC, "EVR OTP4 polarity")
  field(MASK, "1")
  field(ZNAM, "Normal")
  field(ONAM, "Inverse")
  field(FLNK, "$(P)$(R)OTP04PolCalc")
}

record(bo, "$(P)$(R)OTP04Log-Sel") {
  field(DESC, "EVR OTP4 event timestamping enable")
  field(MASK, "1")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(FLNK, "$(P)$(R)OTP04LogCalc")
}

record(bo, "$(P)$(R)OTP04Intlk-Sel") {
  field(DESC, "EVR OTP4 interlock function selection")
  field(MASK, "1")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(FLNK, "$(P)$(R)OTP04IntlkCalc")
}

record(calcout, "$(P)$(R)OTP04StateCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP4 set enable calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OTP04State-Sel.RVAL")
  field(INPB, "$(P)$(R)OTP04Polarity-Sts.VAL")
  field(INPC, "$(P)$(R)OTP04Log-Sts.VAL")
  field(INPD, "$(P)$(R)OTP04Intlk-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
  field(OUT, "@timing.proto evre_otp_en_pol_time_itl_set($(P),$(R),04,State) $(PORT)")
  field(FLNK, "$(P)$(R)OTP04DelayCalc")
}

record(calcout, "$(P)$(R)OTP04PolCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP4 set polarity calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OTP04State-Sts.VAL")
  field(INPB, "$(P)$(R)OTP04Polarity-Sel.RVAL")
  field(INPC, "$(P)$(R)OTP04Log-Sts.VAL")
  field(INPD, "$(P)$(R)OTP04Intlk-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
  field(OUT, "@timing.proto evre_otp_en_pol_time_itl_set($(P),$(R),04,Pol) $(PORT)")
  field(FLNK, "$(P)$(R)OTP04DelayCalc")
}

record(calcout, "$(P)$(R)OTP04LogCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP4 set timestamping calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OTP04State-Sts.VAL")
  field(INPB, "$(P)$(R)OTP04Polarity-Sts.VAL")
  field(INPC, "$(P)$(R)OTP04Log-Sel.RVAL")
  field(INPD, "$(P)$(R)OTP04Intlk-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
  field(OUT, "@timing.proto evre_otp_en_pol_time_itl_set($(P),$(R),04,Log) $(PORT)")
  field(FLNK, "$(P)$(R)OTP04DelayCalc")
}

record(calcout, "$(P)$(R)OTP04IntlkCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP4 set interlock calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OTP04State-Sts.VAL")
  field(INPB, "$(P)$(R)OTP04Polarity-Sts.VAL")
  field(INPC, "$(P)$(R)OTP04Log-Sts.VAL")
  field(INPD, "$(P)$(R)OTP04Intlk-Sel.RVAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
  field(OUT, "@timing.proto evre_otp_en_pol_time_itl_set($(P),$(R),04,Intlk) $(PORT)")
  field(FLNK, "$(P)$(R)OTP04DelayCalc")
}

record(calcout, "$(P)$(R)OTP04DelayCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP4 download EN, POL, and TIME")
  field(INPA, "$(P)$(R)OTP04State-Sel.RVAL")
  field(INPB, "$(P)$(R)OTP04Polarity-Sel.RVAL")
  field(INPC, "$(P)$(R)OTP04Log-Sel.RVAL")
  field(INPD, "$(P)$(R)OTP04Intlk-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
}

record(mbbiDirect, "$(P)$(R)OTP04DelayRaw") {
  field(ASG, "Reserved")
  field(DESC, "OTP4 enable, pol, timelog and intlk RBV")
  field(NOBT, "8")
  field(SCAN, "I/O Intr")
  field(DTYP, "stream")
  field(INP, "@timing.proto evre_otp_enpoltime4RBV_intr $(PORT)")
  field(FLNK, "$(P)$(R)OTP04Intlk-Sts")
}

record(bi, "$(P)$(R)OTP04Intlk-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP4 interlock status")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(INP, "$(P)$(R)OTP04DelayRaw.B4")
  field(FLNK, "$(P)$(R)OTP04Log-Sts")
}

record(bi, "$(P)$(R)OTP04Log-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP4 timestamping status")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(INP, "$(P)$(R)OTP04DelayRaw.B5")
  field(FLNK, "$(P)$(R)OTP04Polarity-Sts")
}

record(bi, "$(P)$(R)OTP04Polarity-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP4 polarity status")
  field(ZNAM, "Normal")
  field(ONAM, "Inverse")
  field(INP, "$(P)$(R)OTP04DelayRaw.B6")
  field(FLNK, "$(P)$(R)OTP04State-Sts")
}

record(bi, "$(P)$(R)OTP04State-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP4 enable status")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(INP, "$(P)$(R)OTP04DelayRaw.B7")
}

record(longin, "$(P)$(R)OTP04NrPulses-RB"){
  field(ASG, "Reserved")
  field(DESC, "EVR OTP4 number of pulses RBV")
  field(EGU, "pulses")
}

record(longin, "$(P)$(R)OTP04Evt-RB") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP4 event RBV")
}

record(longin, "$(P)$(R)OTP04Width-RB") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP4 width RBV")
  field(EGU, "evt_T")
  field(FLNK, "$(P)$(R)OTP04WidthTime-RB")
}

record(longin, "$(P)$(R)OTP04Delay-RB") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP4 delay RBV")
  field(EGU, "evt_T")
  field(FLNK, "$(P)$(R)OTP04DelayTime-RB")
}

record(calc, "$(P)$(R)OTP04WidthTime-RB") {
  field(INPA, "$(P)$(R)OTP04Width-RB")
  field(INPB, "$(P)TI-EVG:FPGAClk-Cte")
  field(PREC, "3")
  field(DESC, "EVR OTP4 width time RBV")
  field(EGU, "us")
  field(CALC, "A*B*1000000")
}

record(calc, "$(P)$(R)OTP04DelayTime-RB") {
  field(INPA, "$(P)$(R)OTP04Delay-RB")
  field(INPB, "$(P)TI-EVG:FPGAClk-Cte")
  field(PREC, "3")
  field(DESC, "EVR OTP4 delay time RBV")
  field(EGU, "us")
  field(CALC, "A*B*1000000")
}

record(longout, "$(P)$(R)cmd_otp_set04") {
  field(ASG, "Reserved")
  field(DESC, "Command code to write to OTP4")
  field(VAL, "0x45") # (0x40 | reg number=5)
}

record(longout, "$(P)$(R)cmd_otp_get04") {
  field(ASG, "Reserved")
  field(DESC, "Command code to read OTP4")
  field(VAL, "0x85") # (0x80 | reg number=5)
}

########################################################################
# OTP5 Register [6]

record(longout, "$(P)$(R)OTP05Evt-SP") {
  field(DESC, "EVR event code")
  field(DRVH, "63")
  field(DRVL, "0")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_otp_ev_set($(P),$(R),05) $(PORT)")
  field(FLNK, "$(P)$(R)OTP05DelayRaw")
}

record(longout, "$(P)$(R)OTP05NrPulses-SP"){
  field(VAL, "1")
  field(DESC, "EVR OTP5 number of pulses")
  field(DRVH, "65535")
  field(DRVL, "1")
  field(EGU, "pulses")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_otp_pulses_set($(P),$(R),05) $(PORT)")
  field(FLNK, "$(P)$(R)OTP05DelayRaw")
}

record(ao, "$(P)$(R)OTP05WidthTime-SP") {
  field(DESC, "EVR OTP05 trigger width time")
  field(VAL, "0.008")
  field(DRVH, "17000000")
  field(DRVL, "0.008")
  field(EGU, "us")
  field(FLNK, "$(P)$(R)OTP05WidthCalc")
}

record(calcout, "$(P)$(R)OTP05WidthCalc") {
  field(DESC, "EVR OTP05 trigger width calc")
  field(INPA, "$(P)$(R)OTP05WidthTime-SP")
  field(INPB, "$(P)TI-EVG:FPGAClk-Cte")
  field(CALC, "CEIL(A/(B*1000000))-A/(B*1000000)<0.5?CEIL(A/(B*1000000)):FLOOR(A/(B*1000000))")
  field(OUT, "$(P)$(R)OTP05Width-SP PP")
}

record(longout, "$(P)$(R)OTP05Width-SP") {
  field(DESC, "EVR OTP05 trigger width")
  field(VAL, "1")
  field(DRVH, "2147483647")
  field(DRVL, "1")
  field(EGU, "evt_T")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_otp_width_set($(P),$(R),05) $(PORT)")
  field(FLNK, "$(P)$(R)OTP05DelayRaw")
}

record(ao, "$(P)$(R)OTP05DelayTime-SP") {
  field(DESC, "EVR OTP05 trigger delay time")
  field(VAL, "0")
  field(DRVH, "17000000")
  field(DRVL, "0")
  field(EGU, "us")
  field(FLNK, "$(P)$(R)OTP05DelayTimeCalc")
}

record(calcout, "$(P)$(R)OTP05DelayTimeCalc") {
  field(DESC, "EVR OTP05 trigger delay calc")
  field(INPA, "$(P)$(R)OTP05DelayTime-SP")
  field(INPB, "$(P)TI-EVG:FPGAClk-Cte")
  field(CALC, "CEIL(A/(B*1000000))-A/(B*1000000)<0.5?CEIL(A/(B*1000000)):FLOOR(A/(B*1000000))")
  field(OUT, "$(P)$(R)OTP05Delay-SP PP")
}

record(longout, "$(P)$(R)OTP05Delay-SP") {
  field(DESC, "EVR OTP05 event delay")
  field(DRVH, "2147483647")
  field(DRVL, "1")
  field(EGU, "evt_T")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_otp_dly_set($(P),$(R),05) $(PORT)")
  field(FLNK, "$(P)$(R)OTP05DelayRaw")
}

record(bo, "$(P)$(R)OTP05State-Sel") {
  field(DESC, "EVR OTP5 enable")
  field(MASK, "1")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(FLNK, "$(P)$(R)OTP05StateCalc")
}

record(bo, "$(P)$(R)OTP05Polarity-Sel") {
  field(DESC, "EVR OTP5 polarity")
  field(MASK, "1")
  field(ZNAM, "Normal")
  field(ONAM, "Inverse")
  field(FLNK, "$(P)$(R)OTP05PolCalc")
}

record(bo, "$(P)$(R)OTP05Log-Sel") {
  field(DESC, "EVR OTP5 event timestamping enable")
  field(MASK, "1")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(FLNK, "$(P)$(R)OTP05LogCalc")
}

record(bo, "$(P)$(R)OTP05Intlk-Sel") {
  field(DESC, "EVR OTP5 interlock function selection")
  field(MASK, "1")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(FLNK, "$(P)$(R)OTP05IntlkCalc")
}

record(calcout, "$(P)$(R)OTP05StateCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP5 set enable calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OTP05State-Sel.RVAL")
  field(INPB, "$(P)$(R)OTP05Polarity-Sts.VAL")
  field(INPC, "$(P)$(R)OTP05Log-Sts.VAL")
  field(INPD, "$(P)$(R)OTP05Intlk-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
  field(OUT, "@timing.proto evre_otp_en_pol_time_itl_set($(P),$(R),05,State) $(PORT)")
  field(FLNK, "$(P)$(R)OTP05DelayCalc")
}

record(calcout, "$(P)$(R)OTP05PolCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP5 set polarity calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OTP05State-Sts.VAL")
  field(INPB, "$(P)$(R)OTP05Polarity-Sel.RVAL")
  field(INPC, "$(P)$(R)OTP05Log-Sts.VAL")
  field(INPD, "$(P)$(R)OTP05Intlk-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
  field(OUT, "@timing.proto evre_otp_en_pol_time_itl_set($(P),$(R),05,Pol) $(PORT)")
  field(FLNK, "$(P)$(R)OTP05DelayCalc")
}

record(calcout, "$(P)$(R)OTP05LogCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP5 set timestamping calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OTP05State-Sts.VAL")
  field(INPB, "$(P)$(R)OTP05Polarity-Sts.VAL")
  field(INPC, "$(P)$(R)OTP05Log-Sel.RVAL")
  field(INPD, "$(P)$(R)OTP05Intlk-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
  field(OUT, "@timing.proto evre_otp_en_pol_time_itl_set($(P),$(R),05,Log) $(PORT)")
  field(FLNK, "$(P)$(R)OTP05DelayCalc")
}

record(calcout, "$(P)$(R)OTP05IntlkCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP5 set interlock calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OTP05State-Sts.VAL")
  field(INPB, "$(P)$(R)OTP05Polarity-Sts.VAL")
  field(INPC, "$(P)$(R)OTP05Log-Sts.VAL")
  field(INPD, "$(P)$(R)OTP05Intlk-Sel.RVAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
  field(OUT, "@timing.proto evre_otp_en_pol_time_itl_set($(P),$(R),05,Intlk) $(PORT)")
  field(FLNK, "$(P)$(R)OTP05DelayCalc")
}

record(calcout, "$(P)$(R)OTP05DelayCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP5 download EN, POL, and TIME")
  field(INPA, "$(P)$(R)OTP05State-Sel.RVAL")
  field(INPB, "$(P)$(R)OTP05Polarity-Sel.RVAL")
  field(INPC, "$(P)$(R)OTP05Log-Sel.RVAL")
  field(INPD, "$(P)$(R)OTP05Intlk-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
}

record(mbbiDirect, "$(P)$(R)OTP05DelayRaw") {
  field(ASG, "Reserved")
  field(DESC, "OTP5 enable, pol, timelog and intlk RBV")
  field(NOBT, "8")
  field(SCAN, "I/O Intr")
  field(DTYP, "stream")
  field(INP, "@timing.proto evre_otp_enpoltime5RBV_intr $(PORT)")
  field(FLNK, "$(P)$(R)OTP05Intlk-Sts")
}

record(bi, "$(P)$(R)OTP05Intlk-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP5 interlock status")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(INP, "$(P)$(R)OTP05DelayRaw.B4")
  field(FLNK, "$(P)$(R)OTP05Log-Sts")
}

record(bi, "$(P)$(R)OTP05Log-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP5 timestamping status")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(INP, "$(P)$(R)OTP05DelayRaw.B5")
  field(FLNK, "$(P)$(R)OTP05Polarity-Sts")
}

record(bi, "$(P)$(R)OTP05Polarity-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP5 polarity status")
  field(ZNAM, "Normal")
  field(ONAM, "Inverse")
  field(INP, "$(P)$(R)OTP05DelayRaw.B6")
  field(FLNK, "$(P)$(R)OTP05State-Sts")
}

record(bi, "$(P)$(R)OTP05State-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP5 enable status")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(INP, "$(P)$(R)OTP05DelayRaw.B7")
}

record(longin, "$(P)$(R)OTP05NrPulses-RB"){
  field(ASG, "Reserved")
  field(DESC, "EVR OTP5 number of pulses RBV")
  field(EGU, "pulses")
}

record(longin, "$(P)$(R)OTP05Evt-RB") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP5 event RBV")
}

record(longin, "$(P)$(R)OTP05Width-RB") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP5 width RBV")
  field(EGU, "evt_T")
  field(FLNK, "$(P)$(R)OTP05WidthTime-RB")
}

record(longin, "$(P)$(R)OTP05Delay-RB") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP5 delay RBV")
  field(EGU, "evt_T")
  field(FLNK, "$(P)$(R)OTP05DelayTime-RB")
}

record(calc, "$(P)$(R)OTP05WidthTime-RB") {
  field(INPA, "$(P)$(R)OTP05Width-RB")
  field(INPB, "$(P)TI-EVG:FPGAClk-Cte")
  field(PREC, "3")
  field(DESC, "EVR OTP5 width time RBV")
  field(EGU, "us")
  field(CALC, "A*B*1000000")
}

record(calc, "$(P)$(R)OTP05DelayTime-RB") {
  field(INPA, "$(P)$(R)OTP05Delay-RB")
  field(INPB, "$(P)TI-EVG:FPGAClk-Cte")
  field(PREC, "3")
  field(DESC, "EVR OTP5 delay time RBV")
  field(EGU, "us")
  field(CALC, "A*B*1000000")
}

record(longout, "$(P)$(R)cmd_otp_set05") {
  field(ASG, "Reserved")
  field(DESC, "Command code to write to OTP5")
  field(VAL, "0x46") # (0x40 | reg number=6)
}

record(longout, "$(P)$(R)cmd_otp_get05") {
  field(ASG, "Reserved")
  field(DESC, "Command code to read OTP5")
  field(VAL, "0x86") # (0x80 | reg number=6)
}

########################################################################
# OTP6 Register [7]

record(longout, "$(P)$(R)OTP06Evt-SP") {
  field(DESC, "EVR event code")
  field(DRVH, "63")
  field(DRVL, "0")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_otp_ev_set($(P),$(R),06) $(PORT)")
  field(FLNK, "$(P)$(R)OTP06DelayRaw")
}

record(longout, "$(P)$(R)OTP06NrPulses-SP"){
  field(VAL, "1")
  field(DESC, "EVR OTP6 number of pulses")
  field(DRVH, "65535")
  field(DRVL, "1")
  field(EGU, "pulses")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_otp_pulses_set($(P),$(R),06) $(PORT)")
  field(FLNK, "$(P)$(R)OTP06DelayRaw")
}

record(ao, "$(P)$(R)OTP06WidthTime-SP") {
  field(DESC, "EVR OTP06 trigger width time")
  field(VAL, "0.008")
  field(DRVH, "17000000")
  field(DRVL, "0.008")
  field(EGU, "us")
  field(FLNK, "$(P)$(R)OTP06WidthCalc")
}

record(calcout, "$(P)$(R)OTP06WidthCalc") {
  field(DESC, "EVR OTP06 trigger width calc")
  field(INPA, "$(P)$(R)OTP06WidthTime-SP")
  field(INPB, "$(P)TI-EVG:FPGAClk-Cte")
  field(CALC, "CEIL(A/(B*1000000))-A/(B*1000000)<0.5?CEIL(A/(B*1000000)):FLOOR(A/(B*1000000))")
  field(OUT, "$(P)$(R)OTP06Width-SP PP")
}

record(longout, "$(P)$(R)OTP06Width-SP") {
  field(DESC, "EVR OTP06 trigger width")
  field(VAL, "1")
  field(DRVH, "2147483647")
  field(DRVL, "1")
  field(EGU, "evt_T")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_otp_width_set($(P),$(R),06) $(PORT)")
  field(FLNK, "$(P)$(R)OTP06DelayRaw")
}

record(ao, "$(P)$(R)OTP06DelayTime-SP") {
  field(DESC, "EVR OTP06 trigger delay time")
  field(VAL, "0")
  field(DRVH, "17000000")
  field(DRVL, "0")
  field(EGU, "us")
  field(FLNK, "$(P)$(R)OTP06DelayTimeCalc")
}

record(calcout, "$(P)$(R)OTP06DelayTimeCalc") {
  field(DESC, "EVR OTP06 trigger delay calc")
  field(INPA, "$(P)$(R)OTP06DelayTime-SP")
  field(INPB, "$(P)TI-EVG:FPGAClk-Cte")
  field(CALC, "CEIL(A/(B*1000000))-A/(B*1000000)<0.5?CEIL(A/(B*1000000)):FLOOR(A/(B*1000000))")
  field(OUT, "$(P)$(R)OTP06Delay-SP PP")
}

record(longout, "$(P)$(R)OTP06Delay-SP") {
  field(DESC, "EVR OTP06 event delay")
  field(DRVH, "2147483647")
  field(DRVL, "1")
  field(EGU, "evt_T")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_otp_dly_set($(P),$(R),06) $(PORT)")
  field(FLNK, "$(P)$(R)OTP06DelayRaw")
}

record(bo, "$(P)$(R)OTP06State-Sel") {
  field(DESC, "EVR OTP6 enable")
  field(MASK, "1")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(FLNK, "$(P)$(R)OTP06StateCalc")
}

record(bo, "$(P)$(R)OTP06Polarity-Sel") {
  field(DESC, "EVR OTP6 polarity")
  field(MASK, "1")
  field(ZNAM, "Normal")
  field(ONAM, "Inverse")
  field(FLNK, "$(P)$(R)OTP06PolCalc")
}

record(bo, "$(P)$(R)OTP06Log-Sel") {
  field(DESC, "EVR OTP6 event timestamping enable")
  field(MASK, "1")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(FLNK, "$(P)$(R)OTP06LogCalc")
}

record(bo, "$(P)$(R)OTP06Intlk-Sel") {
  field(DESC, "EVR OTP6 interlock function selection")
  field(MASK, "1")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(FLNK, "$(P)$(R)OTP06IntlkCalc")
}

record(calcout, "$(P)$(R)OTP06StateCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP6 set enable calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OTP06State-Sel.RVAL")
  field(INPB, "$(P)$(R)OTP06Polarity-Sts.VAL")
  field(INPC, "$(P)$(R)OTP06Log-Sts.VAL")
  field(INPD, "$(P)$(R)OTP06Intlk-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
  field(OUT, "@timing.proto evre_otp_en_pol_time_itl_set($(P),$(R),06,State) $(PORT)")
  field(FLNK, "$(P)$(R)OTP06DelayCalc")
}

record(calcout, "$(P)$(R)OTP06PolCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP6 set polarity calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OTP06State-Sts.VAL")
  field(INPB, "$(P)$(R)OTP06Polarity-Sel.RVAL")
  field(INPC, "$(P)$(R)OTP06Log-Sts.VAL")
  field(INPD, "$(P)$(R)OTP06Intlk-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
  field(OUT, "@timing.proto evre_otp_en_pol_time_itl_set($(P),$(R),06,Pol) $(PORT)")
  field(FLNK, "$(P)$(R)OTP06DelayCalc")
}

record(calcout, "$(P)$(R)OTP06LogCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP6 set timestamping calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OTP06State-Sts.VAL")
  field(INPB, "$(P)$(R)OTP06Polarity-Sts.VAL")
  field(INPC, "$(P)$(R)OTP06Log-Sel.RVAL")
  field(INPD, "$(P)$(R)OTP06Intlk-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
  field(OUT, "@timing.proto evre_otp_en_pol_time_itl_set($(P),$(R),06,Log) $(PORT)")
  field(FLNK, "$(P)$(R)OTP06DelayCalc")
}

record(calcout, "$(P)$(R)OTP06IntlkCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP6 set interlock calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OTP06State-Sts.VAL")
  field(INPB, "$(P)$(R)OTP06Polarity-Sts.VAL")
  field(INPC, "$(P)$(R)OTP06Log-Sts.VAL")
  field(INPD, "$(P)$(R)OTP06Intlk-Sel.RVAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
  field(OUT, "@timing.proto evre_otp_en_pol_time_itl_set($(P),$(R),06,Intlk) $(PORT)")
  field(FLNK, "$(P)$(R)OTP06DelayCalc")
}

record(calcout, "$(P)$(R)OTP06DelayCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP6 download EN, POL, and TIME")
  field(INPA, "$(P)$(R)OTP06State-Sel.RVAL")
  field(INPB, "$(P)$(R)OTP06Polarity-Sel.RVAL")
  field(INPC, "$(P)$(R)OTP06Log-Sel.RVAL")
  field(INPD, "$(P)$(R)OTP06Intlk-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
}

record(mbbiDirect, "$(P)$(R)OTP06DelayRaw") {
  field(ASG, "Reserved")
  field(DESC, "OTP6 enable, pol, timelog and intlk RBV")
  field(NOBT, "8")
  field(SCAN, "I/O Intr")
  field(DTYP, "stream")
  field(INP, "@timing.proto evre_otp_enpoltime6RBV_intr $(PORT)")
  field(FLNK, "$(P)$(R)OTP06Intlk-Sts")
}

record(bi, "$(P)$(R)OTP06Intlk-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP6 interlock status")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(INP, "$(P)$(R)OTP06DelayRaw.B4")
  field(FLNK, "$(P)$(R)OTP06Log-Sts")
}

record(bi, "$(P)$(R)OTP06Log-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP6 timestamping status")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(INP, "$(P)$(R)OTP06DelayRaw.B5")
  field(FLNK, "$(P)$(R)OTP06Polarity-Sts")
}

record(bi, "$(P)$(R)OTP06Polarity-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP6 polarity status")
  field(ZNAM, "Normal")
  field(ONAM, "Inverse")
  field(INP, "$(P)$(R)OTP06DelayRaw.B6")
  field(FLNK, "$(P)$(R)OTP06State-Sts")
}

record(bi, "$(P)$(R)OTP06State-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP6 enable status")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(INP, "$(P)$(R)OTP06DelayRaw.B7")
}

record(longin, "$(P)$(R)OTP06NrPulses-RB"){
  field(ASG, "Reserved")
  field(DESC, "EVR OTP6 number of pulses RBV")
  field(EGU, "pulses")
}

record(longin, "$(P)$(R)OTP06Evt-RB") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP6 event RBV")
}

record(longin, "$(P)$(R)OTP06Width-RB") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP6 width RBV")
  field(EGU, "evt_T")
  field(FLNK, "$(P)$(R)OTP06WidthTime-RB")
}

record(longin, "$(P)$(R)OTP06Delay-RB") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP6 delay RBV")
  field(EGU, "evt_T")
  field(FLNK, "$(P)$(R)OTP06DelayTime-RB")
}

record(calc, "$(P)$(R)OTP06WidthTime-RB") {
  field(INPA, "$(P)$(R)OTP06Width-RB")
  field(INPB, "$(P)TI-EVG:FPGAClk-Cte")
  field(PREC, "3")
  field(DESC, "EVR OTP6 width time RBV")
  field(EGU, "us")
  field(CALC, "A*B*1000000")
}

record(calc, "$(P)$(R)OTP06DelayTime-RB") {
  field(INPA, "$(P)$(R)OTP06Delay-RB")
  field(INPB, "$(P)TI-EVG:FPGAClk-Cte")
  field(PREC, "3")
  field(DESC, "EVR OTP6 delay time RBV")
  field(EGU, "us")
  field(CALC, "A*B*1000000")
}

record(longout, "$(P)$(R)cmd_otp_set06") {
  field(ASG, "Reserved")
  field(DESC, "Command code to write to OTP6")
  field(VAL, "0x47") # (0x40 | reg number=7)
}

record(longout, "$(P)$(R)cmd_otp_get06") {
  field(ASG, "Reserved")
  field(DESC, "Command code to read OTP6")
  field(VAL, "0x87") # (0x80 | reg number=7)
}

########################################################################
# OTP7 Register [8]

record(longout, "$(P)$(R)OTP07Evt-SP") {
  field(DESC, "EVR event code")
  field(DRVH, "63")
  field(DRVL, "0")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_otp_ev_set($(P),$(R),07) $(PORT)")
  field(FLNK, "$(P)$(R)OTP07DelayRaw")
}

record(longout, "$(P)$(R)OTP07NrPulses-SP"){
  field(VAL, "1")
  field(DESC, "EVR OTP7 number of pulses")
  field(DRVH, "65535")
  field(DRVL, "1")
  field(EGU, "pulses")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_otp_pulses_set($(P),$(R),07) $(PORT)")
  field(FLNK, "$(P)$(R)OTP07DelayRaw")
}

record(ao, "$(P)$(R)OTP07WidthTime-SP") {
  field(DESC, "EVR OTP07 trigger width time")
  field(VAL, "0.008")
  field(DRVH, "17000000")
  field(DRVL, "0.008")
  field(EGU, "us")
  field(FLNK, "$(P)$(R)OTP07WidthCalc")
}

record(calcout, "$(P)$(R)OTP07WidthCalc") {
  field(DESC, "EVR OTP07 trigger width calc")
  field(INPA, "$(P)$(R)OTP07WidthTime-SP")
  field(INPB, "$(P)TI-EVG:FPGAClk-Cte")
  field(CALC, "CEIL(A/(B*1000000))-A/(B*1000000)<0.5?CEIL(A/(B*1000000)):FLOOR(A/(B*1000000))")
  field(OUT, "$(P)$(R)OTP07Width-SP PP")
}

record(longout, "$(P)$(R)OTP07Width-SP") {
  field(DESC, "EVR OTP07 trigger width")
  field(VAL, "1")
  field(DRVH, "2147483647")
  field(DRVL, "1")
  field(EGU, "evt_T")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_otp_width_set($(P),$(R),07) $(PORT)")
  field(FLNK, "$(P)$(R)OTP07DelayRaw")
}

record(ao, "$(P)$(R)OTP07DelayTime-SP") {
  field(DESC, "EVR OTP07 trigger delay time")
  field(VAL, "0")
  field(DRVH, "17000000")
  field(DRVL, "0")
  field(EGU, "us")
  field(FLNK, "$(P)$(R)OTP07DelayTimeCalc")
}

record(calcout, "$(P)$(R)OTP07DelayTimeCalc") {
  field(DESC, "EVR OTP07 trigger delay calc")
  field(INPA, "$(P)$(R)OTP07DelayTime-SP")
  field(INPB, "$(P)TI-EVG:FPGAClk-Cte")
  field(CALC, "CEIL(A/(B*1000000))-A/(B*1000000)<0.5?CEIL(A/(B*1000000)):FLOOR(A/(B*1000000))")
  field(OUT, "$(P)$(R)OTP07Delay-SP PP")
}

record(longout, "$(P)$(R)OTP07Delay-SP") {
  field(DESC, "EVR OTP07 event delay")
  field(DRVH, "2147483647")
  field(DRVL, "1")
  field(EGU, "evt_T")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_otp_dly_set($(P),$(R),07) $(PORT)")
  field(FLNK, "$(P)$(R)OTP07DelayRaw")
}

record(bo, "$(P)$(R)OTP07State-Sel") {
  field(DESC, "EVR OTP7 enable")
  field(MASK, "1")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(FLNK, "$(P)$(R)OTP07StateCalc")
}

record(bo, "$(P)$(R)OTP07Polarity-Sel") {
  field(DESC, "EVR OTP7 polarity")
  field(MASK, "1")
  field(ZNAM, "Normal")
  field(ONAM, "Inverse")
  field(FLNK, "$(P)$(R)OTP07PolCalc")
}

record(bo, "$(P)$(R)OTP07Log-Sel") {
  field(DESC, "EVR OTP7 event timestamping enable")
  field(MASK, "1")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(FLNK, "$(P)$(R)OTP07LogCalc")
}

record(bo, "$(P)$(R)OTP07Intlk-Sel") {
  field(DESC, "EVR OTP7 interlock function selection")
  field(MASK, "1")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(FLNK, "$(P)$(R)OTP07IntlkCalc")
}

record(calcout, "$(P)$(R)OTP07StateCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP7 set enable calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OTP07State-Sel.RVAL")
  field(INPB, "$(P)$(R)OTP07Polarity-Sts.VAL")
  field(INPC, "$(P)$(R)OTP07Log-Sts.VAL")
  field(INPD, "$(P)$(R)OTP07Intlk-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
  field(OUT, "@timing.proto evre_otp_en_pol_time_itl_set($(P),$(R),07,State) $(PORT)")
  field(FLNK, "$(P)$(R)OTP07DelayCalc")
}

record(calcout, "$(P)$(R)OTP07PolCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP7 set polarity calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OTP07State-Sts.VAL")
  field(INPB, "$(P)$(R)OTP07Polarity-Sel.RVAL")
  field(INPC, "$(P)$(R)OTP07Log-Sts.VAL")
  field(INPD, "$(P)$(R)OTP07Intlk-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
  field(OUT, "@timing.proto evre_otp_en_pol_time_itl_set($(P),$(R),07,Pol) $(PORT)")
  field(FLNK, "$(P)$(R)OTP07DelayCalc")
}

record(calcout, "$(P)$(R)OTP07LogCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP7 set timestamping calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OTP07State-Sts.VAL")
  field(INPB, "$(P)$(R)OTP07Polarity-Sts.VAL")
  field(INPC, "$(P)$(R)OTP07Log-Sel.RVAL")
  field(INPD, "$(P)$(R)OTP07Intlk-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
  field(OUT, "@timing.proto evre_otp_en_pol_time_itl_set($(P),$(R),07,Log) $(PORT)")
  field(FLNK, "$(P)$(R)OTP07DelayCalc")
}

record(calcout, "$(P)$(R)OTP07IntlkCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP7 set interlock calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OTP07State-Sts.VAL")
  field(INPB, "$(P)$(R)OTP07Polarity-Sts.VAL")
  field(INPC, "$(P)$(R)OTP07Log-Sts.VAL")
  field(INPD, "$(P)$(R)OTP07Intlk-Sel.RVAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
  field(OUT, "@timing.proto evre_otp_en_pol_time_itl_set($(P),$(R),07,Intlk) $(PORT)")
  field(FLNK, "$(P)$(R)OTP07DelayCalc")
}

record(calcout, "$(P)$(R)OTP07DelayCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP7 download EN, POL, and TIME")
  field(INPA, "$(P)$(R)OTP07State-Sel.RVAL")
  field(INPB, "$(P)$(R)OTP07Polarity-Sel.RVAL")
  field(INPC, "$(P)$(R)OTP07Log-Sel.RVAL")
  field(INPD, "$(P)$(R)OTP07Intlk-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
}

record(mbbiDirect, "$(P)$(R)OTP07DelayRaw") {
  field(ASG, "Reserved")
  field(DESC, "OTP7 enable, pol, timelog and intlk RBV")
  field(NOBT, "8")
  field(SCAN, "I/O Intr")
  field(DTYP, "stream")
  field(INP, "@timing.proto evre_otp_enpoltime7RBV_intr $(PORT)")
  field(FLNK, "$(P)$(R)OTP07Intlk-Sts")
}

record(bi, "$(P)$(R)OTP07Intlk-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP7 interlock status")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(INP, "$(P)$(R)OTP07DelayRaw.B4")
  field(FLNK, "$(P)$(R)OTP07Log-Sts")
}

record(bi, "$(P)$(R)OTP07Log-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP7 timestamping status")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(INP, "$(P)$(R)OTP07DelayRaw.B5")
  field(FLNK, "$(P)$(R)OTP07Polarity-Sts")
}

record(bi, "$(P)$(R)OTP07Polarity-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP7 polarity status")
  field(ZNAM, "Normal")
  field(ONAM, "Inverse")
  field(INP, "$(P)$(R)OTP07DelayRaw.B6")
  field(FLNK, "$(P)$(R)OTP07State-Sts")
}

record(bi, "$(P)$(R)OTP07State-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP7 enable status")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(INP, "$(P)$(R)OTP07DelayRaw.B7")
}

record(longin, "$(P)$(R)OTP07NrPulses-RB"){
  field(ASG, "Reserved")
  field(DESC, "EVR OTP7 number of pulses RBV")
  field(EGU, "pulses")
}

record(longin, "$(P)$(R)OTP07Evt-RB") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP7 event RBV")
}

record(longin, "$(P)$(R)OTP07Width-RB") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP7 width RBV")
  field(EGU, "evt_T")
  field(FLNK, "$(P)$(R)OTP07WidthTime-RB")
}

record(longin, "$(P)$(R)OTP07Delay-RB") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP7 delay RBV")
  field(EGU, "evt_T")
  field(FLNK, "$(P)$(R)OTP07DelayTime-RB")
}

record(calc, "$(P)$(R)OTP07WidthTime-RB") {
  field(INPA, "$(P)$(R)OTP07Width-RB")
  field(INPB, "$(P)TI-EVG:FPGAClk-Cte")
  field(PREC, "3")
  field(DESC, "EVR OTP7 width time RBV")
  field(EGU, "us")
  field(CALC, "A*B*1000000")
}

record(calc, "$(P)$(R)OTP07DelayTime-RB") {
  field(INPA, "$(P)$(R)OTP07Delay-RB")
  field(INPB, "$(P)TI-EVG:FPGAClk-Cte")
  field(PREC, "3")
  field(DESC, "EVR OTP7 delay time RBV")
  field(EGU, "us")
  field(CALC, "A*B*1000000")
}

record(longout, "$(P)$(R)cmd_otp_set07") {
  field(ASG, "Reserved")
  field(DESC, "Command code to write to OTP7")
  field(VAL, "0x48") # (0x40 | reg number=8)
}

record(longout, "$(P)$(R)cmd_otp_get07") {
  field(ASG, "Reserved")
  field(DESC, "Command code to read OTP7")
  field(VAL, "0x88") # (0x80 | reg number=8)
}

########################################################################
# OTP8 Register [9]

record(longout, "$(P)$(R)OTP08Evt-SP") {
  field(DESC, "EVR event code")
  field(DRVH, "63")
  field(DRVL, "0")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_otp_ev_set($(P),$(R),08) $(PORT)")
  field(FLNK, "$(P)$(R)OTP08DelayRaw")
}

record(longout, "$(P)$(R)OTP08NrPulses-SP"){
  field(VAL, "1")
  field(DESC, "EVR OTP8 number of pulses")
  field(DRVH, "65535")
  field(DRVL, "1")
  field(EGU, "pulses")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_otp_pulses_set($(P),$(R),08) $(PORT)")
  field(FLNK, "$(P)$(R)OTP08DelayRaw")
}

record(ao, "$(P)$(R)OTP08WidthTime-SP") {
  field(DESC, "EVR OTP08 trigger width time")
  field(VAL, "0.008")
  field(DRVH, "17000000")
  field(DRVL, "0.008")
  field(EGU, "us")
  field(FLNK, "$(P)$(R)OTP08WidthCalc")
}

record(calcout, "$(P)$(R)OTP08WidthCalc") {
  field(DESC, "EVR OTP08 trigger width calc")
  field(INPA, "$(P)$(R)OTP08WidthTime-SP")
  field(INPB, "$(P)TI-EVG:FPGAClk-Cte")
  field(CALC, "CEIL(A/(B*1000000))-A/(B*1000000)<0.5?CEIL(A/(B*1000000)):FLOOR(A/(B*1000000))")
  field(OUT, "$(P)$(R)OTP08Width-SP PP")
}

record(longout, "$(P)$(R)OTP08Width-SP") {
  field(DESC, "EVR OTP08 trigger width")
  field(VAL, "1")
  field(DRVH, "2147483647")
  field(DRVL, "1")
  field(EGU, "evt_T")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_otp_width_set($(P),$(R),08) $(PORT)")
  field(FLNK, "$(P)$(R)OTP08DelayRaw")
}

record(ao, "$(P)$(R)OTP08DelayTime-SP") {
  field(DESC, "EVR OTP08 trigger delay time")
  field(VAL, "0")
  field(DRVH, "17000000")
  field(DRVL, "0")
  field(EGU, "us")
  field(FLNK, "$(P)$(R)OTP08DelayTimeCalc")
}

record(calcout, "$(P)$(R)OTP08DelayTimeCalc") {
  field(DESC, "EVR OTP08 trigger delay calc")
  field(INPA, "$(P)$(R)OTP08DelayTime-SP")
  field(INPB, "$(P)TI-EVG:FPGAClk-Cte")
  field(CALC, "CEIL(A/(B*1000000))-A/(B*1000000)<0.5?CEIL(A/(B*1000000)):FLOOR(A/(B*1000000))")
  field(OUT, "$(P)$(R)OTP08Delay-SP PP")
}

record(longout, "$(P)$(R)OTP08Delay-SP") {
  field(DESC, "EVR OTP08 event delay")
  field(DRVH, "2147483647")
  field(DRVL, "1")
  field(EGU, "evt_T")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_otp_dly_set($(P),$(R),08) $(PORT)")
  field(FLNK, "$(P)$(R)OTP08DelayRaw")
}

record(bo, "$(P)$(R)OTP08State-Sel") {
  field(DESC, "EVR OTP8 enable")
  field(MASK, "1")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(FLNK, "$(P)$(R)OTP08StateCalc")
}

record(bo, "$(P)$(R)OTP08Polarity-Sel") {
  field(DESC, "EVR OTP8 polarity")
  field(MASK, "1")
  field(ZNAM, "Normal")
  field(ONAM, "Inverse")
  field(FLNK, "$(P)$(R)OTP08PolCalc")
}

record(bo, "$(P)$(R)OTP08Log-Sel") {
  field(DESC, "EVR OTP8 event timestamping enable")
  field(MASK, "1")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(FLNK, "$(P)$(R)OTP08LogCalc")
}

record(bo, "$(P)$(R)OTP08Intlk-Sel") {
  field(DESC, "EVR OTP8 interlock function selection")
  field(MASK, "1")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(FLNK, "$(P)$(R)OTP08IntlkCalc")
}

record(calcout, "$(P)$(R)OTP08StateCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP8 set enable calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OTP08State-Sel.RVAL")
  field(INPB, "$(P)$(R)OTP08Polarity-Sts.VAL")
  field(INPC, "$(P)$(R)OTP08Log-Sts.VAL")
  field(INPD, "$(P)$(R)OTP08Intlk-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
  field(OUT, "@timing.proto evre_otp_en_pol_time_itl_set($(P),$(R),08,State) $(PORT)")
  field(FLNK, "$(P)$(R)OTP08DelayCalc")
}

record(calcout, "$(P)$(R)OTP08PolCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP8 set polarity calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OTP08State-Sts.VAL")
  field(INPB, "$(P)$(R)OTP08Polarity-Sel.RVAL")
  field(INPC, "$(P)$(R)OTP08Log-Sts.VAL")
  field(INPD, "$(P)$(R)OTP08Intlk-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
  field(OUT, "@timing.proto evre_otp_en_pol_time_itl_set($(P),$(R),08,Pol) $(PORT)")
  field(FLNK, "$(P)$(R)OTP08DelayCalc")
}

record(calcout, "$(P)$(R)OTP08LogCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP8 set timestamping calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OTP08State-Sts.VAL")
  field(INPB, "$(P)$(R)OTP08Polarity-Sts.VAL")
  field(INPC, "$(P)$(R)OTP08Log-Sel.RVAL")
  field(INPD, "$(P)$(R)OTP08Intlk-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
  field(OUT, "@timing.proto evre_otp_en_pol_time_itl_set($(P),$(R),08,Log) $(PORT)")
  field(FLNK, "$(P)$(R)OTP08DelayCalc")
}

record(calcout, "$(P)$(R)OTP08IntlkCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP8 set interlock calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OTP08State-Sts.VAL")
  field(INPB, "$(P)$(R)OTP08Polarity-Sts.VAL")
  field(INPC, "$(P)$(R)OTP08Log-Sts.VAL")
  field(INPD, "$(P)$(R)OTP08Intlk-Sel.RVAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
  field(OUT, "@timing.proto evre_otp_en_pol_time_itl_set($(P),$(R),08,Intlk) $(PORT)")
  field(FLNK, "$(P)$(R)OTP08DelayCalc")
}

record(calcout, "$(P)$(R)OTP08DelayCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP8 download EN, POL, and TIME")
  field(INPA, "$(P)$(R)OTP08State-Sel.RVAL")
  field(INPB, "$(P)$(R)OTP08Polarity-Sel.RVAL")
  field(INPC, "$(P)$(R)OTP08Log-Sel.RVAL")
  field(INPD, "$(P)$(R)OTP08Intlk-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
}

record(mbbiDirect, "$(P)$(R)OTP08DelayRaw") {
  field(ASG, "Reserved")
  field(DESC, "OTP8 enable, pol, timelog and intlk RBV")
  field(NOBT, "8")
  field(SCAN, "I/O Intr")
  field(DTYP, "stream")
  field(INP, "@timing.proto evre_otp_enpoltime8RBV_intr $(PORT)")
  field(FLNK, "$(P)$(R)OTP08Intlk-Sts")
}

record(bi, "$(P)$(R)OTP08Intlk-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP8 interlock status")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(INP, "$(P)$(R)OTP08DelayRaw.B4")
  field(FLNK, "$(P)$(R)OTP08Log-Sts")
}

record(bi, "$(P)$(R)OTP08Log-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP8 timestamping status")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(INP, "$(P)$(R)OTP08DelayRaw.B5")
  field(FLNK, "$(P)$(R)OTP08Polarity-Sts")
}

record(bi, "$(P)$(R)OTP08Polarity-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP8 polarity status")
  field(ZNAM, "Normal")
  field(ONAM, "Inverse")
  field(INP, "$(P)$(R)OTP08DelayRaw.B6")
  field(FLNK, "$(P)$(R)OTP08State-Sts")
}

record(bi, "$(P)$(R)OTP08State-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP8 enable status")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(INP, "$(P)$(R)OTP08DelayRaw.B7")
}

record(longin, "$(P)$(R)OTP08NrPulses-RB"){
  field(ASG, "Reserved")
  field(DESC, "EVR OTP8 number of pulses RBV")
}

record(longin, "$(P)$(R)OTP08Evt-RB") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP8 event RBV")
}

record(longin, "$(P)$(R)OTP08Width-RB") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP8 width RBV")
  field(EGU, "evt_T")
  field(FLNK, "$(P)$(R)OTP08WidthTime-RB")
}

record(longin, "$(P)$(R)OTP08Delay-RB") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP8 delay RBV")
  field(EGU, "evt_T")
  field(FLNK, "$(P)$(R)OTP08DelayTime-RB")
}

record(calc, "$(P)$(R)OTP08WidthTime-RB") {
  field(INPA, "$(P)$(R)OTP08Width-RB")
  field(INPB, "$(P)TI-EVG:FPGAClk-Cte")
  field(PREC, "3")
  field(DESC, "EVR OTP8 width time RBV")
  field(EGU, "us")
  field(CALC, "A*B*1000000")
}

record(calc, "$(P)$(R)OTP08DelayTime-RB") {
  field(INPA, "$(P)$(R)OTP08Delay-RB")
  field(INPB, "$(P)TI-EVG:FPGAClk-Cte")
  field(PREC, "3")
  field(DESC, "EVR OTP8 delay time RBV")
  field(EGU, "us")
  field(CALC, "A*B*1000000")
}

record(longout, "$(P)$(R)cmd_otp_set08") {
  field(ASG, "Reserved")
  field(DESC, "Command code to write to OTP8")
  field(VAL, "0x49") # (0x40 | reg number=9)
}

record(longout, "$(P)$(R)cmd_otp_get08") {
  field(ASG, "Reserved")
  field(DESC, "Command code to read OTP8")
  field(VAL, "0x89") # (0x80 | reg number=9)
}

########################################################################
# OTP9 Register [10]

record(longout, "$(P)$(R)OTP09Evt-SP") {
  field(DESC, "EVR event code")
  field(DRVH, "63")
  field(DRVL, "0")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_otp_ev_set($(P),$(R),09) $(PORT)")
  field(FLNK, "$(P)$(R)OTP09DelayRaw")
}

record(longout, "$(P)$(R)OTP09NrPulses-SP"){
  field(VAL, "1")
  field(DESC, "EVR OTP9 number of pulses")
  field(DRVH, "65535")
  field(DRVL, "1")
  field(EGU, "pulses")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_otp_pulses_set($(P),$(R),09) $(PORT)")
  field(FLNK, "$(P)$(R)OTP09DelayRaw")
}

record(ao, "$(P)$(R)OTP09WidthTime-SP") {
  field(DESC, "EVR OTP09 trigger width time")
  field(VAL, "0.008")
  field(DRVH, "17000000")
  field(DRVL, "0.008")
  field(EGU, "us")
  field(FLNK, "$(P)$(R)OTP09WidthCalc")
}

record(calcout, "$(P)$(R)OTP09WidthCalc") {
  field(DESC, "EVR OTP09 trigger width calc")
  field(INPA, "$(P)$(R)OTP09WidthTime-SP")
  field(INPB, "$(P)TI-EVG:FPGAClk-Cte")
  field(CALC, "CEIL(A/(B*1000000))-A/(B*1000000)<0.5?CEIL(A/(B*1000000)):FLOOR(A/(B*1000000))")
  field(OUT, "$(P)$(R)OTP09Width-SP PP")
}

record(longout, "$(P)$(R)OTP09Width-SP") {
  field(DESC, "EVR OTP09 trigger width")
  field(VAL, "1")
  field(DRVH, "2147483647")
  field(DRVL, "1")
  field(EGU, "evt_T")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_otp_width_set($(P),$(R),09) $(PORT)")
  field(FLNK, "$(P)$(R)OTP09DelayRaw")
}

record(ao, "$(P)$(R)OTP09DelayTime-SP") {
  field(DESC, "EVR OTP09 trigger delay time")
  field(VAL, "0")
  field(DRVH, "17000000")
  field(DRVL, "0")
  field(EGU, "us")
  field(FLNK, "$(P)$(R)OTP09DelayTimeCalc")
}

record(calcout, "$(P)$(R)OTP09DelayTimeCalc") {
  field(DESC, "EVR OTP09 trigger delay calc")
  field(INPA, "$(P)$(R)OTP09DelayTime-SP")
  field(INPB, "$(P)TI-EVG:FPGAClk-Cte")
  field(CALC, "CEIL(A/(B*1000000))-A/(B*1000000)<0.5?CEIL(A/(B*1000000)):FLOOR(A/(B*1000000))")
  field(OUT, "$(P)$(R)OTP09Delay-SP PP")
}

record(longout, "$(P)$(R)OTP09Delay-SP") {
  field(DESC, "EVR OTP09 event delay")
  field(DRVH, "2147483647")
  field(DRVL, "1")
  field(EGU, "evt_T")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_otp_dly_set($(P),$(R),09) $(PORT)")
  field(FLNK, "$(P)$(R)OTP09DelayRaw")
}

record(bo, "$(P)$(R)OTP09State-Sel") {
  field(DESC, "EVR OTP9 enable")
  field(MASK, "1")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(FLNK, "$(P)$(R)OTP09StateCalc")
}

record(bo, "$(P)$(R)OTP09Polarity-Sel") {
  field(DESC, "EVR OTP9 polarity")
  field(MASK, "1")
  field(ZNAM, "Normal")
  field(ONAM, "Inverse")
  field(FLNK, "$(P)$(R)OTP09PolCalc")
}

record(bo, "$(P)$(R)OTP09Log-Sel") {
  field(DESC, "EVR OTP9 event timestamping enable")
  field(MASK, "1")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(FLNK, "$(P)$(R)OTP09LogCalc")
}

record(bo, "$(P)$(R)OTP09Intlk-Sel") {
  field(DESC, "EVR OTP9 interlock function selection")
  field(MASK, "1")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(FLNK, "$(P)$(R)OTP09IntlkCalc")
}

record(calcout, "$(P)$(R)OTP09StateCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP9 set enable calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OTP09State-Sel.RVAL")
  field(INPB, "$(P)$(R)OTP09Polarity-Sts.VAL")
  field(INPC, "$(P)$(R)OTP09Log-Sts.VAL")
  field(INPD, "$(P)$(R)OTP09Intlk-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
  field(OUT, "@timing.proto evre_otp_en_pol_time_itl_set($(P),$(R),09,State) $(PORT)")
  field(FLNK, "$(P)$(R)OTP09DelayCalc")
}

record(calcout, "$(P)$(R)OTP09PolCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP9 set polarity calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OTP09State-Sts.VAL")
  field(INPB, "$(P)$(R)OTP09Polarity-Sel.RVAL")
  field(INPC, "$(P)$(R)OTP09Log-Sts.VAL")
  field(INPD, "$(P)$(R)OTP09Intlk-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
  field(OUT, "@timing.proto evre_otp_en_pol_time_itl_set($(P),$(R),09,Pol) $(PORT)")
  field(FLNK, "$(P)$(R)OTP09DelayCalc")
}

record(calcout, "$(P)$(R)OTP09LogCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP9 set timestamping calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OTP09State-Sts.VAL")
  field(INPB, "$(P)$(R)OTP09Polarity-Sts.VAL")
  field(INPC, "$(P)$(R)OTP09Log-Sel.RVAL")
  field(INPD, "$(P)$(R)OTP09Intlk-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
  field(OUT, "@timing.proto evre_otp_en_pol_time_itl_set($(P),$(R),09,Log) $(PORT)")
  field(FLNK, "$(P)$(R)OTP09DelayCalc")
}

record(calcout, "$(P)$(R)OTP09IntlkCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP9 set interlock calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OTP09State-Sts.VAL")
  field(INPB, "$(P)$(R)OTP09Polarity-Sts.VAL")
  field(INPC, "$(P)$(R)OTP09Log-Sts.VAL")
  field(INPD, "$(P)$(R)OTP09Intlk-Sel.RVAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
  field(OUT, "@timing.proto evre_otp_en_pol_time_itl_set($(P),$(R),09,Intlk) $(PORT)")
  field(FLNK, "$(P)$(R)OTP09DelayCalc")
}

record(calcout, "$(P)$(R)OTP09DelayCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP9 download EN, POL, and TIME")
  field(INPA, "$(P)$(R)OTP09State-Sel.RVAL")
  field(INPB, "$(P)$(R)OTP09Polarity-Sel.RVAL")
  field(INPC, "$(P)$(R)OTP09Log-Sel.RVAL")
  field(INPD, "$(P)$(R)OTP09Intlk-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
}

record(mbbiDirect, "$(P)$(R)OTP09DelayRaw") {
  field(ASG, "Reserved")
  field(DESC, "OTP9 enable, pol, timelog and intlk RBV")
  field(NOBT, "8")
  field(SCAN, "I/O Intr")
  field(DTYP, "stream")
  field(INP, "@timing.proto evre_otp_enpoltime9RBV_intr $(PORT)")
  field(FLNK, "$(P)$(R)OTP09Intlk-Sts")
}

record(bi, "$(P)$(R)OTP09Intlk-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP9 interlock status")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(INP, "$(P)$(R)OTP09DelayRaw.B4")
  field(FLNK, "$(P)$(R)OTP09Log-Sts")
}

record(bi, "$(P)$(R)OTP09Log-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP9 timestamping status")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(INP, "$(P)$(R)OTP09DelayRaw.B5")
  field(FLNK, "$(P)$(R)OTP09Polarity-Sts")
}

record(bi, "$(P)$(R)OTP09Polarity-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP9 polarity status")
  field(ZNAM, "Normal")
  field(ONAM, "Inverse")
  field(INP, "$(P)$(R)OTP09DelayRaw.B6")
  field(FLNK, "$(P)$(R)OTP09State-Sts")
}

record(bi, "$(P)$(R)OTP09State-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP9 enable status")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(INP, "$(P)$(R)OTP09DelayRaw.B7")
}

record(longin, "$(P)$(R)OTP09NrPulses-RB"){
  field(ASG, "Reserved")
  field(DESC, "EVR OTP9 number of pulses RBV")
  field(EGU, "pulses")
}

record(longin, "$(P)$(R)OTP09Evt-RB") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP9 event RBV")
}

record(longin, "$(P)$(R)OTP09Width-RB") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP9 width RBV")
  field(EGU, "evt_T")
  field(FLNK, "$(P)$(R)OTP09WidthTime-RB")
}

record(longin, "$(P)$(R)OTP09Delay-RB") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP0 delay RBV")
  field(EGU, "evt_T")
  field(FLNK, "$(P)$(R)OTP09DelayTime-RB")
}

record(calc, "$(P)$(R)OTP09WidthTime-RB") {
  field(INPA, "$(P)$(R)OTP09Width-RB")
  field(INPB, "$(P)TI-EVG:FPGAClk-Cte")
  field(PREC, "3")
  field(DESC, "EVR OTP9 width time RBV")
  field(EGU, "us")
  field(CALC, "A*B*1000000")
}

record(calc, "$(P)$(R)OTP09DelayTime-RB") {
  field(INPA, "$(P)$(R)OTP09Delay-RB")
  field(INPB, "$(P)TI-EVG:FPGAClk-Cte")
  field(PREC, "3")
  field(DESC, "EVR OTP9 delay time RBV")
  field(EGU, "us")
  field(CALC, "A*B*1000000")
}

record(longout, "$(P)$(R)cmd_otp_set09") {
  field(ASG, "Reserved")
  field(DESC, "Command code to write to OTP9")
  field(VAL, "0x4A") # (0x40 | reg number=10)
}

record(longout, "$(P)$(R)cmd_otp_get09") {
  field(ASG, "Reserved")
  field(DESC, "Command code to read OTP9")
  field(VAL, "0x8A") # (0x80 | reg number=10)
}

########################################################################
# OTP10 Register [11]

record(longout, "$(P)$(R)OTP10Evt-SP") {
  field(DESC, "EVR event code")
  field(DRVH, "63")
  field(DRVL, "0")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_otp_ev_set($(P),$(R),10) $(PORT)")
  field(FLNK, "$(P)$(R)OTP10DelayRaw")
}

record(longout, "$(P)$(R)OTP10NrPulses-SP"){
  field(VAL, "1")
  field(DESC, "EVR OTP10 number of pulses")
  field(DRVH, "65535")
  field(DRVL, "1")
  field(EGU, "pulses")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_otp_pulses_set($(P),$(R),10) $(PORT)")
  field(FLNK, "$(P)$(R)OTP10DelayRaw")
}

record(ao, "$(P)$(R)OTP10WidthTime-SP") {
  field(DESC, "EVR OTP10 trigger width time")
  field(VAL, "0.008")
  field(DRVH, "17000000")
  field(DRVL, "0.008")
  field(EGU, "us")
  field(FLNK, "$(P)$(R)OTP10WidthCalc")
}

record(calcout, "$(P)$(R)OTP10WidthCalc") {
  field(DESC, "EVR OTP10 trigger width calc")
  field(INPA, "$(P)$(R)OTP10WidthTime-SP")
  field(INPB, "$(P)TI-EVG:FPGAClk-Cte")
  field(CALC, "CEIL(A/(B*1000000))-A/(B*1000000)<0.5?CEIL(A/(B*1000000)):FLOOR(A/(B*1000000))")
  field(OUT, "$(P)$(R)OTP10Width-SP PP")
}

record(longout, "$(P)$(R)OTP10Width-SP") {
  field(DESC, "EVR OTP10 trigger width")
  field(VAL, "1")
  field(DRVH, "2147483647")
  field(DRVL, "1")
  field(EGU, "evt_T")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_otp_width_set($(P),$(R),10) $(PORT)")
  field(FLNK, "$(P)$(R)OTP10DelayRaw")
}

record(ao, "$(P)$(R)OTP10DelayTime-SP") {
  field(DESC, "EVR OTP10 trigger delay time")
  field(VAL, "0")
  field(DRVH, "17000000")
  field(DRVL, "0")
  field(EGU, "us")
  field(FLNK, "$(P)$(R)OTP10DelayTimeCalc")
}

record(calcout, "$(P)$(R)OTP10DelayTimeCalc") {
  field(DESC, "EVR OTP10 trigger delay calc")
  field(INPA, "$(P)$(R)OTP10DelayTime-SP")
  field(INPB, "$(P)TI-EVG:FPGAClk-Cte")
  field(CALC, "CEIL(A/(B*1000000))-A/(B*1000000)<0.5?CEIL(A/(B*1000000)):FLOOR(A/(B*1000000))")
  field(OUT, "$(P)$(R)OTP10Delay-SP PP")
}

record(longout, "$(P)$(R)OTP10Delay-SP") {
  field(DESC, "EVR OTP10 event delay")
  field(DRVH, "2147483647")
  field(DRVL, "1")
  field(EGU, "evt_T")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_otp_dly_set($(P),$(R),10) $(PORT)")
  field(FLNK, "$(P)$(R)OTP10DelayRaw")
}

record(bo, "$(P)$(R)OTP10State-Sel") {
  field(DESC, "EVR OTP10 enable")
  field(MASK, "1")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(FLNK, "$(P)$(R)OTP10StateCalc")
}

record(bo, "$(P)$(R)OTP10Polarity-Sel") {
  field(DESC, "EVR OTP10 polarity")
  field(MASK, "1")
  field(ZNAM, "Normal")
  field(ONAM, "Inverse")
  field(FLNK, "$(P)$(R)OTP10PolCalc")
}

record(bo, "$(P)$(R)OTP10Log-Sel") {
  field(DESC, "EVR OTP10 event timestamping enable")
  field(MASK, "1")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(FLNK, "$(P)$(R)OTP10LogCalc")
}

record(bo, "$(P)$(R)OTP10Intlk-Sel") {
  field(DESC, "EVR OTP10 interlock function selection")
  field(MASK, "1")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(FLNK, "$(P)$(R)OTP10IntlkCalc")
}

record(calcout, "$(P)$(R)OTP10StateCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP10 set enable calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OTP10State-Sel.RVAL")
  field(INPB, "$(P)$(R)OTP10Polarity-Sts.VAL")
  field(INPC, "$(P)$(R)OTP10Log-Sts.VAL")
  field(INPD, "$(P)$(R)OTP10Intlk-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
  field(OUT, "@timing.proto evre_otp_en_pol_time_itl_set($(P),$(R),10,State) $(PORT)")
  field(FLNK, "$(P)$(R)OTP10DelayCalc")
}

record(calcout, "$(P)$(R)OTP10PolCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP10 set polarity calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OTP10State-Sts.VAL")
  field(INPB, "$(P)$(R)OTP10Polarity-Sel.RVAL")
  field(INPC, "$(P)$(R)OTP10Log-Sts.VAL")
  field(INPD, "$(P)$(R)OTP10Intlk-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
  field(OUT, "@timing.proto evre_otp_en_pol_time_itl_set($(P),$(R),10,Pol) $(PORT)")
  field(FLNK, "$(P)$(R)OTP10DelayCalc")
}

record(calcout, "$(P)$(R)OTP10LogCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP10 set timestamping calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OTP10State-Sts.VAL")
  field(INPB, "$(P)$(R)OTP10Polarity-Sts.VAL")
  field(INPC, "$(P)$(R)OTP10Log-Sel.RVAL")
  field(INPD, "$(P)$(R)OTP10Intlk-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
  field(OUT, "@timing.proto evre_otp_en_pol_time_itl_set($(P),$(R),10,Log) $(PORT)")
  field(FLNK, "$(P)$(R)OTP10DelayCalc")
}

record(calcout, "$(P)$(R)OTP10IntlkCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP10 set interlock calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OTP10State-Sts.VAL")
  field(INPB, "$(P)$(R)OTP10Polarity-Sts.VAL")
  field(INPC, "$(P)$(R)OTP10Log-Sts.VAL")
  field(INPD, "$(P)$(R)OTP10Intlk-Sel.RVAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
  field(OUT, "@timing.proto evre_otp_en_pol_time_itl_set($(P),$(R),10,Intlk) $(PORT)")
  field(FLNK, "$(P)$(R)OTP10DelayCalc")
}

record(calcout, "$(P)$(R)OTP10DelayCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP10 download EN, POL, and TIME")
  field(INPA, "$(P)$(R)OTP10State-Sel.RVAL")
  field(INPB, "$(P)$(R)OTP10Polarity-Sel.RVAL")
  field(INPC, "$(P)$(R)OTP10Log-Sel.RVAL")
  field(INPD, "$(P)$(R)OTP10Intlk-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
}

record(mbbiDirect, "$(P)$(R)OTP10DelayRaw") {
  field(ASG, "Reserved")
  field(DESC, "OTP10 enable, pol, timelog and intlk RBV")
  field(NOBT, "8")
  field(SCAN, "I/O Intr")
  field(DTYP, "stream")
  field(INP, "@timing.proto evre_otp_enpoltimeARBV_intr $(PORT)")
  field(FLNK, "$(P)$(R)OTP10Intlk-Sts")
}

record(bi, "$(P)$(R)OTP10Intlk-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP10 interlock status")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(INP, "$(P)$(R)OTP10DelayRaw.B4")
  field(FLNK, "$(P)$(R)OTP10Log-Sts")
}

record(bi, "$(P)$(R)OTP10Log-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP10 timestamping status")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(INP, "$(P)$(R)OTP10DelayRaw.B5")
  field(FLNK, "$(P)$(R)OTP10Polarity-Sts")
}

record(bi, "$(P)$(R)OTP10Polarity-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP10 polarity status")
  field(ZNAM, "Normal")
  field(ONAM, "Inverse")
  field(INP, "$(P)$(R)OTP10DelayRaw.B6")
  field(FLNK, "$(P)$(R)OTP10State-Sts")
}

record(bi, "$(P)$(R)OTP10State-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP10 enable status")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(INP, "$(P)$(R)OTP10DelayRaw.B7")
}

record(longin, "$(P)$(R)OTP10NrPulses-RB"){
  field(ASG, "Reserved")
  field(DESC, "EVR OTP10 number of pulses RBV")
  field(EGU, "pulses")
}

record(longin, "$(P)$(R)OTP10Evt-RB") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP10 event RBV")
}

record(longin, "$(P)$(R)OTP10Width-RB") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP10 width RBV")
  field(EGU, "evt_T")
  field(FLNK, "$(P)$(R)OTP10WidthTime-RB")
}

record(longin, "$(P)$(R)OTP10Delay-RB") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP10 delay RBV")
  field(EGU, "evt_T")
  field(FLNK, "$(P)$(R)OTP10DelayTime-RB")
}

record(calc, "$(P)$(R)OTP10WidthTime-RB") {
  field(INPA, "$(P)$(R)OTP10Width-RB")
  field(INPB, "$(P)TI-EVG:FPGAClk-Cte")
  field(PREC, "3")
  field(DESC, "EVR OTP10 width time RBV")
  field(EGU, "us")
  field(CALC, "A*B*1000000")
}

record(calc, "$(P)$(R)OTP10DelayTime-RB") {
  field(INPA, "$(P)$(R)OTP10Delay-RB")
  field(INPB, "$(P)TI-EVG:FPGAClk-Cte")
  field(PREC, "3")
  field(DESC, "EVR OTP10 delay time RBV")
  field(EGU, "us")
  field(CALC, "A*B*1000000")
}

record(longout, "$(P)$(R)cmd_otp_set10") {
  field(ASG, "Reserved")
  field(DESC, "Command code to write to OTP10")
  field(VAL, "0x4B") # (0x40 | reg number=11)
}

record(longout, "$(P)$(R)cmd_otp_get10") {
  field(ASG, "Reserved")
  field(DESC, "Command code to read OTP10")
  field(VAL, "0x8B") # (0x80 | reg number=11)
}

########################################################################
# OTP11 Register [12]

record(longout, "$(P)$(R)OTP11Evt-SP") {
  field(DESC, "EVR event code")
  field(DRVH, "63")
  field(DRVL, "0")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_otp_ev_set($(P),$(R),11) $(PORT)")
  field(FLNK, "$(P)$(R)OTP11DelayRaw")
}

record(longout, "$(P)$(R)OTP11NrPulses-SP"){
  field(VAL, "1")
  field(DESC, "EVR OTP11 number of pulses")
  field(DRVH, "65535")
  field(DRVL, "1")
  field(EGU, "pulses")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_otp_pulses_set($(P),$(R),11) $(PORT)")
  field(FLNK, "$(P)$(R)OTP11DelayRaw")
}

record(ao, "$(P)$(R)OTP11WidthTime-SP") {
  field(DESC, "EVR OTP11 trigger width time")
  field(VAL, "0.008")
  field(DRVH, "17000000")
  field(DRVL, "0.008")
  field(EGU, "us")
  field(FLNK, "$(P)$(R)OTP11WidthCalc")
}

record(calcout, "$(P)$(R)OTP11WidthCalc") {
  field(DESC, "EVR OTP11 trigger width calc")
  field(INPA, "$(P)$(R)OTP11WidthTime-SP")
  field(INPB, "$(P)TI-EVG:FPGAClk-Cte")
  field(CALC, "CEIL(A/(B*1000000))-A/(B*1000000)<0.5?CEIL(A/(B*1000000)):FLOOR(A/(B*1000000))")
  field(OUT, "$(P)$(R)OTP11Width-SP PP")
}

record(longout, "$(P)$(R)OTP11Width-SP") {
  field(DESC, "EVR OTP11 trigger width")
  field(VAL, "1")
  field(DRVH, "2147483647")
  field(DRVL, "1")
  field(EGU, "evt_T")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_otp_width_set($(P),$(R),11) $(PORT)")
  field(FLNK, "$(P)$(R)OTP11DelayRaw")
}

record(ao, "$(P)$(R)OTP11DelayTime-SP") {
  field(DESC, "EVR OTP11 trigger delay time")
  field(VAL, "0")
  field(DRVH, "17000000")
  field(DRVL, "0")
  field(EGU, "us")
  field(FLNK, "$(P)$(R)OTP11DelayTimeCalc")
}

record(calcout, "$(P)$(R)OTP11DelayTimeCalc") {
  field(DESC, "EVR OTP11 trigger delay calc")
  field(INPA, "$(P)$(R)OTP11DelayTime-SP")
  field(INPB, "$(P)TI-EVG:FPGAClk-Cte")
  field(CALC, "CEIL(A/(B*1000000))-A/(B*1000000)<0.5?CEIL(A/(B*1000000)):FLOOR(A/(B*1000000))")
  field(OUT, "$(P)$(R)OTP11Delay-SP PP")
}

record(longout, "$(P)$(R)OTP11Delay-SP") {
  field(DESC, "EVR OTP11 event delay")
  field(DRVH, "2147483647")
  field(DRVL, "1")
  field(EGU, "evt_T")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_otp_dly_set($(P),$(R),11) $(PORT)")
  field(FLNK, "$(P)$(R)OTP11DelayRaw")
}

record(bo, "$(P)$(R)OTP11State-Sel") {
  field(DESC, "EVR OTP11 enable")
  field(MASK, "1")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(FLNK, "$(P)$(R)OTP11StateCalc")
}

record(bo, "$(P)$(R)OTP11Polarity-Sel") {
  field(DESC, "EVR OTP11 polarity")
  field(MASK, "1")
  field(ZNAM, "Normal")
  field(ONAM, "Inverse")
  field(FLNK, "$(P)$(R)OTP11PolCalc")
}

record(bo, "$(P)$(R)OTP11Log-Sel") {
  field(DESC, "EVR OTP11 event timestamping enable")
  field(MASK, "1")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(FLNK, "$(P)$(R)OTP11LogCalc")
}

record(bo, "$(P)$(R)OTP11Intlk-Sel") {
  field(DESC, "EVR OTP11 interlock function selection")
  field(MASK, "1")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(FLNK, "$(P)$(R)OTP11IntlkCalc")
}

record(calcout, "$(P)$(R)OTP11StateCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP11 set enable calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OTP11State-Sel.RVAL")
  field(INPB, "$(P)$(R)OTP11Polarity-Sts.VAL")
  field(INPC, "$(P)$(R)OTP11Log-Sts.VAL")
  field(INPD, "$(P)$(R)OTP11Intlk-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
  field(OUT, "@timing.proto evre_otp_en_pol_time_itl_set($(P),$(R),11,State) $(PORT)")
  field(FLNK, "$(P)$(R)OTP11DelayCalc")
}

record(calcout, "$(P)$(R)OTP11PolCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP11 set polarity calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OTP11State-Sts.VAL")
  field(INPB, "$(P)$(R)OTP11Polarity-Sel.RVAL")
  field(INPC, "$(P)$(R)OTP11Log-Sts.VAL")
  field(INPD, "$(P)$(R)OTP11Intlk-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
  field(OUT, "@timing.proto evre_otp_en_pol_time_itl_set($(P),$(R),11,Pol) $(PORT)")
  field(FLNK, "$(P)$(R)OTP11DelayCalc")
}

record(calcout, "$(P)$(R)OTP11LogCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP11 set timestamping calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OTP11State-Sts.VAL")
  field(INPB, "$(P)$(R)OTP11Polarity-Sts.VAL")
  field(INPC, "$(P)$(R)OTP11Log-Sel.RVAL")
  field(INPD, "$(P)$(R)OTP11Intlk-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
  field(OUT, "@timing.proto evre_otp_en_pol_time_itl_set($(P),$(R),11,Log) $(PORT)")
  field(FLNK, "$(P)$(R)OTP11DelayCalc")
}

record(calcout, "$(P)$(R)OTP11IntlkCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP11 set interlock calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OTP11State-Sts.VAL")
  field(INPB, "$(P)$(R)OTP11Polarity-Sts.VAL")
  field(INPC, "$(P)$(R)OTP11Log-Sts.VAL")
  field(INPD, "$(P)$(R)OTP11Intlk-Sel.RVAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
  field(OUT, "@timing.proto evre_otp_en_pol_time_itl_set($(P),$(R),11,Intlk) $(PORT)")
  field(FLNK, "$(P)$(R)OTP11DelayCalc")
}

record(calcout, "$(P)$(R)OTP11DelayCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP11 download EN, POL, and TIME")
  field(INPA, "$(P)$(R)OTP11State-Sel.RVAL")
  field(INPB, "$(P)$(R)OTP11Polarity-Sel.RVAL")
  field(INPC, "$(P)$(R)OTP11Log-Sel.RVAL")
  field(INPD, "$(P)$(R)OTP11Intlk-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
}

record(mbbiDirect, "$(P)$(R)OTP11DelayRaw") {
  field(ASG, "Reserved")
  field(DESC, "OTP11 enable, pol, timelog and intlk RBV")
  field(NOBT, "8")
  field(SCAN, "I/O Intr")
  field(DTYP, "stream")
  field(INP, "@timing.proto evre_otp_enpoltimeBRBV_intr $(PORT)")
  field(FLNK, "$(P)$(R)OTP11Intlk-Sts")
}

record(bi, "$(P)$(R)OTP11Intlk-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP11 interlock status")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(INP, "$(P)$(R)OTP11DelayRaw.B4")
  field(FLNK, "$(P)$(R)OTP11Log-Sts")
}

record(bi, "$(P)$(R)OTP11Log-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP11 timestamping status")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(INP, "$(P)$(R)OTP11DelayRaw.B5")
  field(FLNK, "$(P)$(R)OTP11Polarity-Sts")
}

record(bi, "$(P)$(R)OTP11Polarity-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP11 polarity status")
  field(ZNAM, "Normal")
  field(ONAM, "Inverse")
  field(INP, "$(P)$(R)OTP11DelayRaw.B6")
  field(FLNK, "$(P)$(R)OTP11State-Sts")
}

record(bi, "$(P)$(R)OTP11State-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP11 enable status")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(INP, "$(P)$(R)OTP11DelayRaw.B7")
}

record(longin, "$(P)$(R)OTP11NrPulses-RB"){
  field(ASG, "Reserved")
  field(DESC, "EVR OTP11 number of pulses RBV")
  field(EGU, "pulses")
}

record(longin, "$(P)$(R)OTP11Evt-RB") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP11 event RBV")
}

record(longin, "$(P)$(R)OTP11Width-RB") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP11 width RBV")
  field(EGU, "evt_T")
  field(FLNK, "$(P)$(R)OTP11WidthTime-RB")
}

record(longin, "$(P)$(R)OTP11Delay-RB") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP11 delay RBV")
  field(EGU, "evt_T")
  field(FLNK, "$(P)$(R)OTP11DelayTime-RB")
}

record(calc, "$(P)$(R)OTP11WidthTime-RB") {
  field(INPA, "$(P)$(R)OTP11Width-RB")
  field(INPB, "$(P)TI-EVG:FPGAClk-Cte")
  field(PREC, "3")
  field(DESC, "EVR OTP11 width time RBV")
  field(EGU, "us")
  field(CALC, "A*B*1000000")
}

record(calc, "$(P)$(R)OTP11DelayTime-RB") {
  field(INPA, "$(P)$(R)OTP11Delay-RB")
  field(INPB, "$(P)TI-EVG:FPGAClk-Cte")
  field(PREC, "3")
  field(DESC, "EVR OTP11 delay time RBV")
  field(EGU, "us")
  field(CALC, "A*B*1000000")
}

record(longout, "$(P)$(R)cmd_otp_set11") {
  field(ASG, "Reserved")
  field(DESC, "Command code to write to OTP11")
  field(VAL, "0x4C") # (0x40 | reg number=12)
}

record(longout, "$(P)$(R)cmd_otp_get11") {
  field(ASG, "Reserved")
  field(DESC, "Command code to read OTP11")
  field(VAL, "0x8C") # (0x80 | reg number=12)
}

########################################################################
# OTP12 Register [13]

record(longout, "$(P)$(R)OTP12Evt-SP") {
  field(DESC, "EVR event code")
  field(DRVH, "63")
  field(DRVL, "0")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_otp_ev_set($(P),$(R),12) $(PORT)")
  field(FLNK, "$(P)$(R)OTP12DelayRaw")
}

record(longout, "$(P)$(R)OTP12NrPulses-SP"){
  field(VAL, "1")
  field(DESC, "EVR OTP12 number of pulses")
  field(DRVH, "65535")
  field(DRVL, "1")
  field(EGU, "pulses")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_otp_pulses_set($(P),$(R),12) $(PORT)")
  field(FLNK, "$(P)$(R)OTP12DelayRaw")
}

record(ao, "$(P)$(R)OTP12WidthTime-SP") {
  field(DESC, "EVR OTP12 trigger width time")
  field(VAL, "0.008")
  field(DRVH, "17000000")
  field(DRVL, "0.008")
  field(EGU, "us")
  field(FLNK, "$(P)$(R)OTP12WidthCalc")
}

record(calcout, "$(P)$(R)OTP12WidthCalc") {
  field(DESC, "EVR OTP12 trigger width calc")
  field(INPA, "$(P)$(R)OTP12WidthTime-SP")
  field(INPB, "$(P)TI-EVG:FPGAClk-Cte")
  field(CALC, "CEIL(A/(B*1000000))-A/(B*1000000)<0.5?CEIL(A/(B*1000000)):FLOOR(A/(B*1000000))")
  field(OUT, "$(P)$(R)OTP12Width-SP PP")
}

record(longout, "$(P)$(R)OTP12Width-SP") {
  field(DESC, "EVR OTP12 trigger width")
  field(VAL, "1")
  field(DRVH, "2147483647")
  field(DRVL, "1")
  field(EGU, "evt_T")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_otp_width_set($(P),$(R),12) $(PORT)")
  field(FLNK, "$(P)$(R)OTP12DelayRaw")
}

record(ao, "$(P)$(R)OTP12DelayTime-SP") {
  field(DESC, "EVR OTP12 trigger delay time")
  field(VAL, "0")
  field(DRVH, "17000000")
  field(DRVL, "0")
  field(EGU, "us")
  field(FLNK, "$(P)$(R)OTP12DelayTimeCalc")
}

record(calcout, "$(P)$(R)OTP12DelayTimeCalc") {
  field(DESC, "EVR OTP12 trigger delay calc")
  field(INPA, "$(P)$(R)OTP12DelayTime-SP")
  field(INPB, "$(P)TI-EVG:FPGAClk-Cte")
  field(CALC, "CEIL(A/(B*1000000))-A/(B*1000000)<0.5?CEIL(A/(B*1000000)):FLOOR(A/(B*1000000))")
  field(OUT, "$(P)$(R)OTP12Delay-SP PP")
}

record(longout, "$(P)$(R)OTP12Delay-SP") {
  field(DESC, "EVR OTP12 event delay")
  field(DRVH, "2147483647")
  field(DRVL, "1")
  field(EGU, "evt_T")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_otp_dly_set($(P),$(R),12) $(PORT)")
  field(FLNK, "$(P)$(R)OTP12DelayRaw")
}

record(bo, "$(P)$(R)OTP12State-Sel") {
  field(DESC, "EVR OTP12 enable")
  field(MASK, "1")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(FLNK, "$(P)$(R)OTP12StateCalc")
}

record(bo, "$(P)$(R)OTP12Polarity-Sel") {
  field(DESC, "EVR OTP12 polarity")
  field(MASK, "1")
  field(ZNAM, "Normal")
  field(ONAM, "Inverse")
  field(FLNK, "$(P)$(R)OTP12PolCalc")
}

record(bo, "$(P)$(R)OTP12Log-Sel") {
  field(DESC, "EVR OTP12 event timestamping enable")
  field(MASK, "1")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(FLNK, "$(P)$(R)OTP12LogCalc")
}

record(bo, "$(P)$(R)OTP12Intlk-Sel") {
  field(DESC, "EVR OTP12 interlock function selection")
  field(MASK, "1")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(FLNK, "$(P)$(R)OTP12IntlkCalc")
}

record(calcout, "$(P)$(R)OTP12StateCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP12 set enable calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OTP12State-Sel.RVAL")
  field(INPB, "$(P)$(R)OTP12Polarity-Sts.VAL")
  field(INPC, "$(P)$(R)OTP12Log-Sts.VAL")
  field(INPD, "$(P)$(R)OTP12Intlk-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
  field(OUT, "@timing.proto evre_otp_en_pol_time_itl_set($(P),$(R),12,State) $(PORT)")
  field(FLNK, "$(P)$(R)OTP12DelayCalc")
}

record(calcout, "$(P)$(R)OTP12PolCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP12 set polarity calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OTP12State-Sts.VAL")
  field(INPB, "$(P)$(R)OTP12Polarity-Sel.RVAL")
  field(INPC, "$(P)$(R)OTP12Log-Sts.VAL")
  field(INPD, "$(P)$(R)OTP12Intlk-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
  field(OUT, "@timing.proto evre_otp_en_pol_time_itl_set($(P),$(R),12,Pol) $(PORT)")
  field(FLNK, "$(P)$(R)OTP12DelayCalc")
}

record(calcout, "$(P)$(R)OTP12LogCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP12 set timestamping calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OTP12State-Sts.VAL")
  field(INPB, "$(P)$(R)OTP12Polarity-Sts.VAL")
  field(INPC, "$(P)$(R)OTP12Log-Sel.RVAL")
  field(INPD, "$(P)$(R)OTP12Intlk-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
  field(OUT, "@timing.proto evre_otp_en_pol_time_itl_set($(P),$(R),12,Log) $(PORT)")
  field(FLNK, "$(P)$(R)OTP12DelayCalc")
}

record(calcout, "$(P)$(R)OTP12IntlkCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP12 set interlock calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OTP12State-Sts.VAL")
  field(INPB, "$(P)$(R)OTP12Polarity-Sts.VAL")
  field(INPC, "$(P)$(R)OTP12Log-Sts.VAL")
  field(INPD, "$(P)$(R)OTP12Intlk-Sel.RVAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
  field(OUT, "@timing.proto evre_otp_en_pol_time_itl_set($(P),$(R),12,Intlk) $(PORT)")
  field(FLNK, "$(P)$(R)OTP12DelayCalc")
}

record(calcout, "$(P)$(R)OTP12DelayCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP12 download EN, POL, and TIME")
  field(INPA, "$(P)$(R)OTP12State-Sel.RVAL")
  field(INPB, "$(P)$(R)OTP12Polarity-Sel.RVAL")
  field(INPC, "$(P)$(R)OTP12Log-Sel.RVAL")
  field(INPD, "$(P)$(R)OTP12Intlk-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
}

record(mbbiDirect, "$(P)$(R)OTP12DelayRaw") {
  field(ASG, "Reserved")
  field(DESC, "OTP12 enable, pol, timelog and intlk RBV")
  field(NOBT, "8")
  field(SCAN, "I/O Intr")
  field(DTYP, "stream")
  field(INP, "@timing.proto evre_otp_enpoltimeCRBV_intr $(PORT)")
  field(FLNK, "$(P)$(R)OTP12Intlk-Sts")
}

record(bi, "$(P)$(R)OTP12Intlk-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP12 interlock status")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(INP, "$(P)$(R)OTP12DelayRaw.B4")
  field(FLNK, "$(P)$(R)OTP12Log-Sts")
}

record(bi, "$(P)$(R)OTP12Log-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP12 timestamping status")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(INP, "$(P)$(R)OTP12DelayRaw.B5")
  field(FLNK, "$(P)$(R)OTP12Polarity-Sts")
}

record(bi, "$(P)$(R)OTP12Polarity-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP12 polarity status")
  field(ZNAM, "Normal")
  field(ONAM, "Inverse")
  field(INP, "$(P)$(R)OTP12DelayRaw.B6")
  field(FLNK, "$(P)$(R)OTP12State-Sts")
}

record(bi, "$(P)$(R)OTP12State-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP12 enable status")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(INP, "$(P)$(R)OTP12DelayRaw.B7")
}

record(longin, "$(P)$(R)OTP12NrPulses-RB"){
  field(ASG, "Reserved")
  field(DESC, "EVR OTP12 number of pulses RBV")
  field(EGU, "pulses")
}

record(longin, "$(P)$(R)OTP12Evt-RB") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP12 event RBV")
}

record(longin, "$(P)$(R)OTP12Width-RB") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP12 width RBV")
  field(EGU, "evt_T")
  field(FLNK, "$(P)$(R)OTP12WidthTime-RB")
}

record(longin, "$(P)$(R)OTP12Delay-RB") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP12 delay RBV")
  field(EGU, "evt_T")
  field(FLNK, "$(P)$(R)OTP12DelayTime-RB")
}

record(calc, "$(P)$(R)OTP12WidthTime-RB") {
  field(INPA, "$(P)$(R)OTP12Width-RB")
  field(INPB, "$(P)TI-EVG:FPGAClk-Cte")
  field(PREC, "3")
  field(DESC, "EVR OTP12 width time RBV")
  field(EGU, "us")
  field(CALC, "A*B*1000000")
}

record(calc, "$(P)$(R)OTP12DelayTime-RB") {
  field(INPA, "$(P)$(R)OTP12Delay-RB")
  field(INPB, "$(P)TI-EVG:FPGAClk-Cte")
  field(PREC, "3")
  field(DESC, "EVR OTP12 delay time RBV")
  field(EGU, "us")
  field(CALC, "A*B*1000000")
}

record(longout, "$(P)$(R)cmd_otp_set12") {
  field(ASG, "Reserved")
  field(DESC, "Command code to write to OTP12")
  field(VAL, "0x4D") # (0x40 | reg number=13)
}

record(longout, "$(P)$(R)cmd_otp_get12") {
  field(ASG, "Reserved")
  field(DESC, "Command code to read OTP12")
  field(VAL, "0x8D") # (0x80 | reg number=13)
}

########################################################################
# OTP13 Register [14]

record(longout, "$(P)$(R)OTP13Evt-SP") {
  field(DESC, "EVR event code")
  field(DRVH, "63")
  field(DRVL, "0")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_otp_ev_set($(P),$(R),13) $(PORT)")
  field(FLNK, "$(P)$(R)OTP13DelayRaw")
}

record(longout, "$(P)$(R)OTP13NrPulses-SP"){
  field(VAL, "1")
  field(DESC, "EVR OTP13 number of pulses")
  field(DRVH, "65535")
  field(DRVL, "1")
  field(EGU, "pulses")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_otp_pulses_set($(P),$(R),13) $(PORT)")
  field(FLNK, "$(P)$(R)OTP13DelayRaw")
}

record(ao, "$(P)$(R)OTP13WidthTime-SP") {
  field(DESC, "EVR OTP13 trigger width time")
  field(VAL, "0.008")
  field(DRVH, "17000000")
  field(DRVL, "0.008")
  field(EGU, "us")
  field(FLNK, "$(P)$(R)OTP13WidthCalc")
}

record(calcout, "$(P)$(R)OTP13WidthCalc") {
  field(DESC, "EVR OTP13 trigger width calc")
  field(INPA, "$(P)$(R)OTP13WidthTime-SP")
  field(INPB, "$(P)TI-EVG:FPGAClk-Cte")
  field(CALC, "CEIL(A/(B*1000000))-A/(B*1000000)<0.5?CEIL(A/(B*1000000)):FLOOR(A/(B*1000000))")
  field(OUT, "$(P)$(R)OTP13Width-SP PP")
}

record(longout, "$(P)$(R)OTP13Width-SP") {
  field(DESC, "EVR OTP13 trigger width")
  field(VAL, "1")
  field(DRVH, "2147483647")
  field(DRVL, "1")
  field(EGU, "evt_T")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_otp_width_set($(P),$(R),13) $(PORT)")
  field(FLNK, "$(P)$(R)OTP13DelayRaw")
}

record(ao, "$(P)$(R)OTP13DelayTime-SP") {
  field(DESC, "EVR OTP13 trigger delay time")
  field(VAL, "0")
  field(DRVH, "17000000")
  field(DRVL, "0")
  field(EGU, "us")
  field(FLNK, "$(P)$(R)OTP13DelayTimeCalc")
}

record(calcout, "$(P)$(R)OTP13DelayTimeCalc") {
  field(DESC, "EVR OTP13 trigger delay calc")
  field(INPA, "$(P)$(R)OTP13DelayTime-SP")
  field(INPB, "$(P)TI-EVG:FPGAClk-Cte")
  field(CALC, "CEIL(A/(B*1000000))-A/(B*1000000)<0.5?CEIL(A/(B*1000000)):FLOOR(A/(B*1000000))")
  field(OUT, "$(P)$(R)OTP13Delay-SP PP")
}

record(longout, "$(P)$(R)OTP13Delay-SP") {
  field(DESC, "EVR OTP13 event delay")
  field(DRVH, "2147483647")
  field(DRVL, "1")
  field(EGU, "evt_T")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_otp_dly_set($(P),$(R),13) $(PORT)")
  field(FLNK, "$(P)$(R)OTP13DelayRaw")
}

record(bo, "$(P)$(R)OTP13State-Sel") {
  field(DESC, "EVR OTP13 enable")
  field(MASK, "1")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(FLNK, "$(P)$(R)OTP13StateCalc")
}

record(bo, "$(P)$(R)OTP13Polarity-Sel") {
  field(DESC, "EVR OTP13 polarity")
  field(MASK, "1")
  field(ZNAM, "Normal")
  field(ONAM, "Inverse")
  field(FLNK, "$(P)$(R)OTP13PolCalc")
}

record(bo, "$(P)$(R)OTP13Log-Sel") {
  field(DESC, "EVR OTP13 event timestamping enable")
  field(MASK, "1")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(FLNK, "$(P)$(R)OTP13LogCalc")
}

record(bo, "$(P)$(R)OTP13Intlk-Sel") {
  field(DESC, "EVR OTP13 interlock function selection")
  field(MASK, "1")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(FLNK, "$(P)$(R)OTP13IntlkCalc")
}

record(calcout, "$(P)$(R)OTP13StateCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP13 set enable calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OTP13State-Sel.RVAL")
  field(INPB, "$(P)$(R)OTP13Polarity-Sts.VAL")
  field(INPC, "$(P)$(R)OTP13Log-Sts.VAL")
  field(INPD, "$(P)$(R)OTP13Intlk-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
  field(OUT, "@timing.proto evre_otp_en_pol_time_itl_set($(P),$(R),13,State) $(PORT)")
  field(FLNK, "$(P)$(R)OTP13DelayCalc")
}

record(calcout, "$(P)$(R)OTP13PolCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP13 set polarity calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OTP13State-Sts.VAL")
  field(INPB, "$(P)$(R)OTP13Polarity-Sel.RVAL")
  field(INPC, "$(P)$(R)OTP13Log-Sts.VAL")
  field(INPD, "$(P)$(R)OTP13Intlk-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
  field(OUT, "@timing.proto evre_otp_en_pol_time_itl_set($(P),$(R),13,Pol) $(PORT)")
  field(FLNK, "$(P)$(R)OTP13DelayCalc")
}

record(calcout, "$(P)$(R)OTP13LogCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP13 set timestamping calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OTP13State-Sts.VAL")
  field(INPB, "$(P)$(R)OTP13Polarity-Sts.VAL")
  field(INPC, "$(P)$(R)OTP13Log-Sel.RVAL")
  field(INPD, "$(P)$(R)OTP13Intlk-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
  field(OUT, "@timing.proto evre_otp_en_pol_time_itl_set($(P),$(R),13,Log) $(PORT)")
  field(FLNK, "$(P)$(R)OTP13DelayCalc")
}

record(calcout, "$(P)$(R)OTP13IntlkCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP13 set interlock calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OTP13State-Sts.VAL")
  field(INPB, "$(P)$(R)OTP13Polarity-Sts.VAL")
  field(INPC, "$(P)$(R)OTP13Log-Sts.VAL")
  field(INPD, "$(P)$(R)OTP13Intlk-Sel.RVAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
  field(OUT, "@timing.proto evre_otp_en_pol_time_itl_set($(P),$(R),13,Intlk) $(PORT)")
  field(FLNK, "$(P)$(R)OTP13DelayCalc")
}

record(calcout, "$(P)$(R)OTP13DelayCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP13 download EN, POL, and TIME")
  field(INPA, "$(P)$(R)OTP13State-Sel.RVAL")
  field(INPB, "$(P)$(R)OTP13Polarity-Sel.RVAL")
  field(INPC, "$(P)$(R)OTP13Log-Sel.RVAL")
  field(INPD, "$(P)$(R)OTP13Intlk-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
}

record(mbbiDirect, "$(P)$(R)OTP13DelayRaw") {
  field(ASG, "Reserved")
  field(DESC, "OTP13 enable, pol, timelog and intlk RBV")
  field(NOBT, "8")
  field(SCAN, "I/O Intr")
  field(DTYP, "stream")
  field(INP, "@timing.proto evre_otp_enpoltimeDRBV_intr $(PORT)")
  field(FLNK, "$(P)$(R)OTP13Intlk-Sts")
}

record(bi, "$(P)$(R)OTP13Intlk-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP13 interlock status")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(INP, "$(P)$(R)OTP13DelayRaw.B4")
  field(FLNK, "$(P)$(R)OTP13Log-Sts")
}

record(bi, "$(P)$(R)OTP13Log-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP13 timestamping status")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(INP, "$(P)$(R)OTP13DelayRaw.B5")
  field(FLNK, "$(P)$(R)OTP13Polarity-Sts")
}

record(bi, "$(P)$(R)OTP13Polarity-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP13 polarity status")
  field(ZNAM, "Normal")
  field(ONAM, "Inverse")
  field(INP, "$(P)$(R)OTP13DelayRaw.B6")
  field(FLNK, "$(P)$(R)OTP13State-Sts")
}

record(bi, "$(P)$(R)OTP13State-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP13 enable status")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(INP, "$(P)$(R)OTP13DelayRaw.B7")
}

record(longin, "$(P)$(R)OTP13NrPulses-RB"){
  field(ASG, "Reserved")
  field(DESC, "EVR OTP13 number of pulses RBV")
  field(EGU, "pulses")
}

record(longin, "$(P)$(R)OTP13Evt-RB") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP13 event RBV")
}

record(longin, "$(P)$(R)OTP13Width-RB") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP13 width RBV")
  field(EGU, "evt_T")
  field(FLNK, "$(P)$(R)OTP13WidthTime-RB")
}

record(longin, "$(P)$(R)OTP13Delay-RB") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP13 delay RBV")
  field(EGU, "evt_T")
  field(FLNK, "$(P)$(R)OTP13DelayTime-RB")
}

record(calc, "$(P)$(R)OTP13WidthTime-RB") {
  field(INPA, "$(P)$(R)OTP13Width-RB")
  field(INPB, "$(P)TI-EVG:FPGAClk-Cte")
  field(PREC, "3")
  field(DESC, "EVR OTP13 width time RBV")
  field(EGU, "us")
  field(CALC, "A*B*1000000")
}

record(calc, "$(P)$(R)OTP13DelayTime-RB") {
  field(INPA, "$(P)$(R)OTP13Delay-RB")
  field(INPB, "$(P)TI-EVG:FPGAClk-Cte")
  field(PREC, "3")
  field(DESC, "EVR OTP13 delay time RBV")
  field(EGU, "us")
  field(CALC, "A*B*1000000")
}

record(longout, "$(P)$(R)cmd_otp_set13") {
  field(ASG, "Reserved")
  field(DESC, "Command code to write to OTP13")
  field(VAL, "0x4E") # (0x40 | reg number=14)
}

record(longout, "$(P)$(R)cmd_otp_get13") {
  field(ASG, "Reserved")
  field(DESC, "Command code to read OTP13")
  field(VAL, "0x8E") # (0x80 | reg number=14)
}

########################################################################
# OTP14 Register [15]

record(longout, "$(P)$(R)OTP14Evt-SP") {
  field(DESC, "EVR event code")
  field(DRVH, "63")
  field(DRVL, "0")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_otp_ev_set($(P),$(R),14) $(PORT)")
  field(FLNK, "$(P)$(R)OTP14DelayRaw")
}

record(longout, "$(P)$(R)OTP14NrPulses-SP"){
  field(VAL, "1")
  field(DESC, "EVR OTP14 number of pulses")
  field(DRVH, "65535")
  field(DRVL, "1")
  field(EGU, "pulses")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_otp_pulses_set($(P),$(R),14) $(PORT)")
  field(FLNK, "$(P)$(R)OTP14DelayRaw")
}

record(ao, "$(P)$(R)OTP14WidthTime-SP") {
  field(DESC, "EVR OTP14 trigger width time")
  field(VAL, "0.008")
  field(DRVH, "17000000")
  field(DRVL, "0.008")
  field(EGU, "us")
  field(FLNK, "$(P)$(R)OTP14WidthCalc")
}

record(calcout, "$(P)$(R)OTP14WidthCalc") {
  field(DESC, "EVR OTP14 trigger width calc")
  field(INPA, "$(P)$(R)OTP14WidthTime-SP")
  field(INPB, "$(P)TI-EVG:FPGAClk-Cte")
  field(CALC, "CEIL(A/(B*1000000))-A/(B*1000000)<0.5?CEIL(A/(B*1000000)):FLOOR(A/(B*1000000))")
  field(OUT, "$(P)$(R)OTP14Width-SP PP")
}

record(longout, "$(P)$(R)OTP14Width-SP") {
  field(DESC, "EVR OTP14 trigger width")
  field(VAL, "1")
  field(DRVH, "2147483647")
  field(DRVL, "1")
  field(EGU, "evt_T")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_otp_width_set($(P),$(R),14) $(PORT)")
  field(FLNK, "$(P)$(R)OTP14DelayRaw")
}

record(ao, "$(P)$(R)OTP14DelayTime-SP") {
  field(DESC, "EVR OTP14 trigger delay time")
  field(VAL, "0")
  field(DRVH, "17000000")
  field(DRVL, "0")
  field(EGU, "us")
  field(FLNK, "$(P)$(R)OTP14DelayTimeCalc")
}

record(calcout, "$(P)$(R)OTP14DelayTimeCalc") {
  field(DESC, "EVR OTP14 trigger delay calc")
  field(INPA, "$(P)$(R)OTP14DelayTime-SP")
  field(INPB, "$(P)TI-EVG:FPGAClk-Cte")
  field(CALC, "CEIL(A/(B*1000000))-A/(B*1000000)<0.5?CEIL(A/(B*1000000)):FLOOR(A/(B*1000000))")
  field(OUT, "$(P)$(R)OTP14Delay-SP PP")
}

record(longout, "$(P)$(R)OTP14Delay-SP") {
  field(DESC, "EVR OTP14 event delay")
  field(DRVH, "2147483647")
  field(DRVL, "1")
  field(EGU, "evt_T")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_otp_dly_set($(P),$(R),14) $(PORT)")
  field(FLNK, "$(P)$(R)OTP14DelayRaw")
}

record(bo, "$(P)$(R)OTP14State-Sel") {
  field(DESC, "EVR OTP14 enable")
  field(MASK, "1")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(FLNK, "$(P)$(R)OTP14StateCalc")
}

record(bo, "$(P)$(R)OTP14Polarity-Sel") {
  field(DESC, "EVR OTP14 polarity")
  field(MASK, "1")
  field(ZNAM, "Normal")
  field(ONAM, "Inverse")
  field(FLNK, "$(P)$(R)OTP14PolCalc")
}

record(bo, "$(P)$(R)OTP14Log-Sel") {
  field(DESC, "EVR OTP14 event timestamping enable")
  field(MASK, "1")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(FLNK, "$(P)$(R)OTP14LogCalc")
}

record(bo, "$(P)$(R)OTP14Intlk-Sel") {
  field(DESC, "EVR OTP14 interlock function selection")
  field(MASK, "1")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(FLNK, "$(P)$(R)OTP14IntlkCalc")
}

record(calcout, "$(P)$(R)OTP14StateCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP14 set enable calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OTP14State-Sel.RVAL")
  field(INPB, "$(P)$(R)OTP14Polarity-Sts.VAL")
  field(INPC, "$(P)$(R)OTP14Log-Sts.VAL")
  field(INPD, "$(P)$(R)OTP14Intlk-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
  field(OUT, "@timing.proto evre_otp_en_pol_time_itl_set($(P),$(R),14,State) $(PORT)")
  field(FLNK, "$(P)$(R)OTP14DelayCalc")
}

record(calcout, "$(P)$(R)OTP14PolCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP14 set polarity calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OTP14State-Sts.VAL")
  field(INPB, "$(P)$(R)OTP14Polarity-Sel.RVAL")
  field(INPC, "$(P)$(R)OTP14Log-Sts.VAL")
  field(INPD, "$(P)$(R)OTP14Intlk-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
  field(OUT, "@timing.proto evre_otp_en_pol_time_itl_set($(P),$(R),14,Pol) $(PORT)")
  field(FLNK, "$(P)$(R)OTP14DelayCalc")
}

record(calcout, "$(P)$(R)OTP14LogCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP14 set timestamping calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OTP14State-Sts.VAL")
  field(INPB, "$(P)$(R)OTP14Polarity-Sts.VAL")
  field(INPC, "$(P)$(R)OTP14Log-Sel.RVAL")
  field(INPD, "$(P)$(R)OTP14Intlk-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
  field(OUT, "@timing.proto evre_otp_en_pol_time_itl_set($(P),$(R),14,Log) $(PORT)")
  field(FLNK, "$(P)$(R)OTP14DelayCalc")
}

record(calcout, "$(P)$(R)OTP14IntlkCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP14 set interlock calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OTP14State-Sts.VAL")
  field(INPB, "$(P)$(R)OTP14Polarity-Sts.VAL")
  field(INPC, "$(P)$(R)OTP14Log-Sts.VAL")
  field(INPD, "$(P)$(R)OTP14Intlk-Sel.RVAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
  field(OUT, "@timing.proto evre_otp_en_pol_time_itl_set($(P),$(R),14,Intlk) $(PORT)")
  field(FLNK, "$(P)$(R)OTP14DelayCalc")
}

record(calcout, "$(P)$(R)OTP14DelayCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP14 download EN, POL, and TIME")
  field(INPA, "$(P)$(R)OTP14State-Sel.RVAL")
  field(INPB, "$(P)$(R)OTP14Polarity-Sel.RVAL")
  field(INPC, "$(P)$(R)OTP14Log-Sel.RVAL")
  field(INPD, "$(P)$(R)OTP14Intlk-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
}

record(mbbiDirect, "$(P)$(R)OTP14DelayRaw") {
  field(ASG, "Reserved")
  field(DESC, "OTP14 enable, pol, timelog and intlk RBV")
  field(NOBT, "8")
  field(SCAN, "I/O Intr")
  field(DTYP, "stream")
  field(INP, "@timing.proto evre_otp_enpoltimeERBV_intr $(PORT)")
  field(FLNK, "$(P)$(R)OTP14Intlk-Sts")
}

record(bi, "$(P)$(R)OTP14Intlk-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP14 interlock status")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(INP, "$(P)$(R)OTP14DelayRaw.B4")
  field(FLNK, "$(P)$(R)OTP14Log-Sts")
}

record(bi, "$(P)$(R)OTP14Log-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP14 timestamping status")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(INP, "$(P)$(R)OTP14DelayRaw.B5")
  field(FLNK, "$(P)$(R)OTP14Polarity-Sts")
}

record(bi, "$(P)$(R)OTP14Polarity-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP14 polarity status")
  field(ZNAM, "Normal")
  field(ONAM, "Inverse")
  field(INP, "$(P)$(R)OTP14DelayRaw.B6")
  field(FLNK, "$(P)$(R)OTP14State-Sts")
}

record(bi, "$(P)$(R)OTP14State-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP14 enable status")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(INP, "$(P)$(R)OTP14DelayRaw.B7")
}

record(longin, "$(P)$(R)OTP14NrPulses-RB"){
  field(ASG, "Reserved")
  field(DESC, "EVR OTP14 number of pulses RBV")
  field(EGU, "pulses")
}

record(longin, "$(P)$(R)OTP14Evt-RB") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP14 event RBV")
}

record(longin, "$(P)$(R)OTP14Width-RB") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP14 width RBV")
  field(EGU, "evt_T")
  field(FLNK, "$(P)$(R)OTP14WidthTime-RB")
}

record(longin, "$(P)$(R)OTP14Delay-RB") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP14 delay RBV")
  field(EGU, "evt_T")
  field(FLNK, "$(P)$(R)OTP14DelayTime-RB")
}

record(calc, "$(P)$(R)OTP14WidthTime-RB") {
  field(INPA, "$(P)$(R)OTP14Width-RB")
  field(INPB, "$(P)TI-EVG:FPGAClk-Cte")
  field(PREC, "3")
  field(DESC, "EVR OTP14 width time RBV")
  field(EGU, "us")
  field(CALC, "A*B*1000000")
}

record(calc, "$(P)$(R)OTP14DelayTime-RB") {
  field(INPA, "$(P)$(R)OTP14Delay-RB")
  field(INPB, "$(P)TI-EVG:FPGAClk-Cte")
  field(PREC, "3")
  field(DESC, "EVR OTP14 delay time RBV")
  field(EGU, "us")
  field(CALC, "A*B*1000000")
}

record(longout, "$(P)$(R)cmd_otp_set14") {
  field(ASG, "Reserved")
  field(DESC, "Command code to write to OTP14")
  field(VAL, "0x4F") # (0x40 | reg number=15)
}

record(longout, "$(P)$(R)cmd_otp_get14") {
  field(ASG, "Reserved")
  field(DESC, "Command code to read OTP14")
  field(VAL, "0x8F") # (0x80 | reg number=15)
}

########################################################################
# OTP15 Register [16]

record(longout, "$(P)$(R)OTP15Evt-SP") {
  field(DESC, "EVR event code")
  field(DRVH, "63")
  field(DRVL, "0")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_otp_ev_set($(P),$(R),15) $(PORT)")
  field(FLNK, "$(P)$(R)OTP15DelayRaw")
}

record(longout, "$(P)$(R)OTP15NrPulses-SP"){
  field(VAL, "1")
  field(DESC, "EVR OTP15 number of pulses")
  field(DRVH, "65535")
  field(DRVL, "1")
  field(EGU, "pulses")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_otp_pulses_set($(P),$(R),15) $(PORT)")
  field(FLNK, "$(P)$(R)OTP15DelayRaw")
}

record(ao, "$(P)$(R)OTP15WidthTime-SP") {
  field(DESC, "EVR OTP15 trigger width time")
  field(VAL, "0.008")
  field(DRVH, "17000000")
  field(DRVL, "0.008")
  field(EGU, "us")
  field(FLNK, "$(P)$(R)OTP15WidthCalc")
}

record(calcout, "$(P)$(R)OTP15WidthCalc") {
  field(DESC, "EVR OTP15 trigger width calc")
  field(INPA, "$(P)$(R)OTP15WidthTime-SP")
  field(INPB, "$(P)TI-EVG:FPGAClk-Cte")
  field(CALC, "CEIL(A/(B*1000000))-A/(B*1000000)<0.5?CEIL(A/(B*1000000)):FLOOR(A/(B*1000000))")
  field(OUT, "$(P)$(R)OTP15Width-SP PP")
}

record(longout, "$(P)$(R)OTP15Width-SP") {
  field(DESC, "EVR OTP15 trigger width")
  field(VAL, "1")
  field(DRVH, "2147483647")
  field(DRVL, "1")
  field(EGU, "evt_T")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_otp_width_set($(P),$(R),15) $(PORT)")
  field(FLNK, "$(P)$(R)OTP15DelayRaw")
}

record(ao, "$(P)$(R)OTP15DelayTime-SP") {
  field(DESC, "EVR OTP15 trigger delay time")
  field(VAL, "0")
  field(DRVH, "17000000")
  field(DRVL, "0")
  field(EGU, "us")
  field(FLNK, "$(P)$(R)OTP15DelayTimeCalc")
}

record(calcout, "$(P)$(R)OTP15DelayTimeCalc") {
  field(DESC, "EVR OTP15 trigger delay calc")
  field(INPA, "$(P)$(R)OTP15DelayTime-SP")
  field(INPB, "$(P)TI-EVG:FPGAClk-Cte")
  field(CALC, "CEIL(A/(B*1000000))-A/(B*1000000)<0.5?CEIL(A/(B*1000000)):FLOOR(A/(B*1000000))")
  field(OUT, "$(P)$(R)OTP15Delay-SP PP")
}

record(longout, "$(P)$(R)OTP15Delay-SP") {
  field(DESC, "EVR OTP15 event delay")
  field(DRVH, "2147483647")
  field(DRVL, "1")
  field(EGU, "evt_T")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_otp_dly_set($(P),$(R),15) $(PORT)")
  field(FLNK, "$(P)$(R)OTP15DelayRaw")
}

record(bo, "$(P)$(R)OTP15State-Sel") {
  field(DESC, "EVR OTP15 enable")
  field(MASK, "1")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(FLNK, "$(P)$(R)OTP15StateCalc")
}

record(bo, "$(P)$(R)OTP15Polarity-Sel") {
  field(DESC, "EVR OTP15 polarity")
  field(MASK, "1")
  field(ZNAM, "Normal")
  field(ONAM, "Inverse")
  field(FLNK, "$(P)$(R)OTP15PolCalc")
}

record(bo, "$(P)$(R)OTP15Log-Sel") {
  field(DESC, "EVR OTP15 event timestamping enable")
  field(MASK, "1")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(FLNK, "$(P)$(R)OTP15LogCalc")
}

record(bo, "$(P)$(R)OTP15Intlk-Sel") {
  field(DESC, "EVR OTP15 interlock function selection")
  field(MASK, "1")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(FLNK, "$(P)$(R)OTP15IntlkCalc")
}

record(calcout, "$(P)$(R)OTP15StateCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP15 set enable calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OTP15State-Sel.RVAL")
  field(INPB, "$(P)$(R)OTP15Polarity-Sts.VAL")
  field(INPC, "$(P)$(R)OTP15Log-Sts.VAL")
  field(INPD, "$(P)$(R)OTP15Intlk-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
  field(OUT, "@timing.proto evre_otp_en_pol_time_itl_set($(P),$(R),15,State) $(PORT)")
  field(FLNK, "$(P)$(R)OTP15DelayCalc")
}

record(calcout, "$(P)$(R)OTP15PolCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP15 set polarity calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OTP15State-Sts.VAL")
  field(INPB, "$(P)$(R)OTP15Polarity-Sel.RVAL")
  field(INPC, "$(P)$(R)OTP15Log-Sts.VAL")
  field(INPD, "$(P)$(R)OTP15Intlk-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
  field(OUT, "@timing.proto evre_otp_en_pol_time_itl_set($(P),$(R),15,Pol) $(PORT)")
  field(FLNK, "$(P)$(R)OTP15DelayCalc")
}

record(calcout, "$(P)$(R)OTP15LogCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP15 set timestamping calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OTP15State-Sts.VAL")
  field(INPB, "$(P)$(R)OTP15Polarity-Sts.VAL")
  field(INPC, "$(P)$(R)OTP15Log-Sel.RVAL")
  field(INPD, "$(P)$(R)OTP15Intlk-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
  field(OUT, "@timing.proto evre_otp_en_pol_time_itl_set($(P),$(R),15,Log) $(PORT)")
  field(FLNK, "$(P)$(R)OTP15DelayCalc")
}

record(calcout, "$(P)$(R)OTP15IntlkCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP15 set interlock calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OTP15State-Sts.VAL")
  field(INPB, "$(P)$(R)OTP15Polarity-Sts.VAL")
  field(INPC, "$(P)$(R)OTP15Log-Sts.VAL")
  field(INPD, "$(P)$(R)OTP15Intlk-Sel.RVAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
  field(OUT, "@timing.proto evre_otp_en_pol_time_itl_set($(P),$(R),15,Intlk) $(PORT)")
  field(FLNK, "$(P)$(R)OTP15DelayCalc")
}

record(calcout, "$(P)$(R)OTP15DelayCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP15 download EN, POL, and TIME")
  field(INPA, "$(P)$(R)OTP15State-Sel.RVAL")
  field(INPB, "$(P)$(R)OTP15Polarity-Sel.RVAL")
  field(INPC, "$(P)$(R)OTP15Log-Sel.RVAL")
  field(INPD, "$(P)$(R)OTP15Intlk-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
}

record(mbbiDirect, "$(P)$(R)OTP15DelayRaw") {
  field(ASG, "Reserved")
  field(DESC, "OTP15 enable, pol, timelog and intlk RBV")
  field(NOBT, "8")
  field(SCAN, "I/O Intr")
  field(DTYP, "stream")
  field(INP, "@timing.proto evre_otp_enpoltimeFRBV_intr $(PORT)")
  field(FLNK, "$(P)$(R)OTP15Intlk-Sts")
}

record(bi, "$(P)$(R)OTP15Intlk-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP15 interlock status")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(INP, "$(P)$(R)OTP15DelayRaw.B4")
  field(FLNK, "$(P)$(R)OTP15Log-Sts")
}

record(bi, "$(P)$(R)OTP15Log-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP15 timestamping status")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(INP, "$(P)$(R)OTP15DelayRaw.B5")
  field(FLNK, "$(P)$(R)OTP15Polarity-Sts")
}

record(bi, "$(P)$(R)OTP15Polarity-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP15 polarity status")
  field(ZNAM, "Normal")
  field(ONAM, "Inverse")
  field(INP, "$(P)$(R)OTP15DelayRaw.B6")
  field(FLNK, "$(P)$(R)OTP15State-Sts")
}

record(bi, "$(P)$(R)OTP15State-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP15 enable status")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(INP, "$(P)$(R)OTP15DelayRaw.B7")
}

record(longin, "$(P)$(R)OTP15NrPulses-RB"){
  field(ASG, "Reserved")
  field(DESC, "EVR OTP15 number of pulses RBV")
  field(EGU, "pulses")
}

record(longin, "$(P)$(R)OTP15Evt-RB") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP15 event RBV")
}

record(longin, "$(P)$(R)OTP15Width-RB") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP15 width RBV")
  field(EGU, "evt_T")
  field(FLNK, "$(P)$(R)OTP15WidthTime-RB")
}

record(longin, "$(P)$(R)OTP15Delay-RB") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP15 delay RBV")
  field(EGU, "evt_T")
  field(FLNK, "$(P)$(R)OTP15DelayTime-RB")
}

record(calc, "$(P)$(R)OTP15WidthTime-RB") {
  field(INPA, "$(P)$(R)OTP15Width-RB")
  field(INPB, "$(P)TI-EVG:FPGAClk-Cte")
  field(PREC, "3")
  field(DESC, "EVR OTP15 width time RBV")
  field(EGU, "us")
  field(CALC, "A*B*1000000")
}

record(calc, "$(P)$(R)OTP15DelayTime-RB") {
  field(INPA, "$(P)$(R)OTP15Delay-RB")
  field(INPB, "$(P)TI-EVG:FPGAClk-Cte")
  field(PREC, "3")
  field(DESC, "EVR OTP15 delay time RBV")
  field(EGU, "us")
  field(CALC, "A*B*1000000")
}

record(longout, "$(P)$(R)cmd_otp_set15") {
  field(ASG, "Reserved")
  field(DESC, "Command code to write to OTP15")
  field(VAL, "0x50") # (0x40 | reg number=16)
}

record(longout, "$(P)$(R)cmd_otp_get15") {
  field(ASG, "Reserved")
  field(DESC, "Command code to read OTP15")
  field(VAL, "0x90") # (0x80 | reg number=16)
}

########################################################################
# OUT0 Register [17]

record(mbbiDirect, "$(P)$(R)OUT0IntlkRaw") {
  field(ASG, "Reserved")
  field(DESC, "EVR OUT0 interlock raw status")
  field(NOBT, "8")
  field(SHFT, "7")
  field(SCAN, "I/O Intr")
  field(DTYP, "stream")
  field(INP, "@timing.proto evre_out_itl0RAW_intr $(PORT)")
  field(FLNK, "$(P)$(R)OUT0Intlk-Sts")
}

record(bi, "$(P)$(R)OUT0Intlk-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OUT0 interlock status")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(INP, "$(P)$(R)OUT0IntlkRaw.B0")
}

record(mbbi, "$(P)$(R)OUT0Src-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OUT0 source selection status")
  field(NOBT, "7")
  field(SCAN, "I/O Intr")
  field(DTYP, "stream")
  field(ONST, "Trigger")
  field(ONVL, "0x30")
  field(TWST, "Clock0")
  field(TWVL, "0x20")
  field(THST, "Clock1")
  field(THVL, "0x21")
  field(FRST, "Clock2")
  field(FRVL, "0x22")
  field(FVST, "Clock3")
  field(FVVL, "0x23")
  field(SXST, "Clock4")
  field(SXVL, "0x24")
  field(SVST, "Clock5")
  field(SVVL, "0x25")
  field(EIST, "Clock6")
  field(EIVL, "0x26")
  field(NIST, "Clock7")
  field(NIVL, "0x27")
  field(ZRST, "Dsbl")
  field(ZRVL, "0x0")
  field(INP, "@timing.proto evre_out_sel0RAW_intr $(PORT)")
}

record(longin, "$(P)$(R)OUT0FineDelay-RB") {
  field(ASG, "Reserved")
  field(DESC, "EVR OUT0 fine delay status")
  field(EGU, "5ps")
}

record(longin, "$(P)$(R)OUT0RFDelay-RB") {
  field(ASG, "Reserved")
  field(DESC, "EVR OUT0 RF delay status")
  field(EGU, "evt_T/20")
}

record(longout, "$(P)$(R)OUT0RFDelay-SP"){
  field(DESC, "EVR OUT0 RF delay")
  field(DRVL, "0")
  field(DRVH, "31")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_out_rfdly_set($(P),$(R),0) $(PORT)")
}

record(longout, "$(P)$(R)OUT0FineDelay-SP"){
  field(DESC, "EVR OUT0 fine delay")
  field(DRVL, "0")
  field(DRVH, "1023")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_out_finedly_set($(P),$(R),0) $(PORT)")
}

record(longout, "$(P)$(R)OUT0SrcTrig-SP"){
  field(DESC, "EVR OUT0 source trigger")
  field(DRVL, "0")
  field(DRVH, "23")
  field(VAL, "16")
  field(PINI, "1")
  field(FLNK, "$(P)$(R)OUT0SrcTrigCalc")
}

record(calc, "$(P)$(R)OUT0SrcTrig-RB"){
  field(DESC, "EVR OUT0 source trigger RBV")
  field(INPA, "$(P)$(R)OUT0SrcTrigFan")
  field(CALC, "(A>=16 && A<=31)?A-16:A-32")
}

record(calcout, "$(P)$(R)OUT0SrcTrigCalc"){
  field(DESC, "EVR OUT0 source trigger calc")
  field(INPA, "$(P)$(R)OUT0SrcTrig-SP")
  field(CALC, "(A>=0 && A<=15)?A+16:A+32")
  field(OUT, "$(P)$(R)OUT0SrcTrigFan PP")
}

record(dfanout, "$(P)$(R)OUT0SrcTrigFan"){
  field(DESC, "EVR OUT0 source trigger fan")
  field(OUTA, "$(P)$(R)OUT0Src-Sel.ONVL PP")
  field(OUTB, "$(P)$(R)OUT0Src-Sts.ONVL PP")
  field(FLNK, "$(P)$(R)OUT0SrcTrig-RB")
}

record(mbbo, "$(P)$(R)OUT0Src-Sel"){
  field(DESC, "EVR OUT0 source selection")
  field(ONST, "Trigger")
  field(ONVL, "0x30")
  field(TWST, "Clock0")
  field(TWVL, "0x20")
  field(THST, "Clock1")
  field(THVL, "0x21")
  field(FRST, "Clock2")
  field(FRVL, "0x22")
  field(FVST, "Clock3")
  field(FVVL, "0x23")
  field(SXST, "Clock4")
  field(SXVL, "0x24")
  field(SVST, "Clock5")
  field(SVVL, "0x25")
  field(EIST, "Clock6")
  field(EIVL, "0x26")
  field(NIST, "Clock7")
  field(NIVL, "0x27")
  field(ZRST, "Dsbl")
  field(ZRVL, "0x0")
  field(FLNK, "$(P)$(R)OUT0SrcHw")
}

record(calcout, "$(P)$(R)OUT0SrcHw"){
  field(ASG, "Reserved")
  field(DESC, "EVR OUT0 source selection write reg")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OUT0Src-Sel.RVAL")
  field(CALC, "A")
  field(OUT, "@timing.proto evre_out_src_set($(P),$(R),0) $(PORT)")
}

record(calcout, "$(P)$(R)OUT0IntlkCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OUT0 set interlock function calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OUT0Intlk-Sel.RVAL")
  field(CALC, "A<<7")
  field(OUT, "@timing.proto evre_out_itl_set($(P),$(R),0) $(PORT)")
}

record(bo, "$(P)$(R)OUT0Intlk-Sel"){
  field(DESC, "EVR OUT0 interlock function selection")
  field(MASK, "1")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(FLNK, "$(P)$(R)OUT0IntlkCalc")
}

record(longout, "$(P)$(R)cmd_out_get0") {
  field(ASG, "Reserved")
  field(DESC, "Command code to read OUT0")
  field(VAL, "0x91") # (0x80 | (reg number=17))
}

record(longout, "$(P)$(R)cmd_out_set0") {
  field(ASG, "Reserved")
  field(DESC, "Command code to write to OUT0")
  field(VAL, "0x51")
}

########################################################################
# OUT1 Register [18]

record(mbbiDirect, "$(P)$(R)OUT1IntlkRaw") {
  field(ASG, "Reserved")
  field(DESC, "EVR OUT1 interlock raw status")
  field(NOBT, "8")
  field(SHFT, "7")
  field(SCAN, "I/O Intr")
  field(DTYP, "stream")
  field(INP, "@timing.proto evre_out_itl1RAW_intr $(PORT)")
  field(FLNK, "$(P)$(R)OUT1Intlk-Sts")
}

record(bi, "$(P)$(R)OUT1Intlk-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OUT1 interlock status")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(INP, "$(P)$(R)OUT1IntlkRaw.B0")
}

record(mbbi, "$(P)$(R)OUT1Src-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OUT1 source selection status")
  field(NOBT, "7")
  field(SCAN, "I/O Intr")
  field(DTYP, "stream")
  field(ONST, "Trigger")
  field(ONVL, "0x31")
  field(TWST, "Clock0")
  field(TWVL, "0x20")
  field(THST, "Clock1")
  field(THVL, "0x21")
  field(FRST, "Clock2")
  field(FRVL, "0x22")
  field(FVST, "Clock3")
  field(FVVL, "0x23")
  field(SXST, "Clock4")
  field(SXVL, "0x24")
  field(SVST, "Clock5")
  field(SVVL, "0x25")
  field(EIST, "Clock6")
  field(EIVL, "0x26")
  field(NIST, "Clock7")
  field(NIVL, "0x27")
  field(ZRST, "Dsbl")
  field(ZRVL, "0x0")
  field(INP, "@timing.proto evre_out_sel1RAW_intr $(PORT)")
}

record(longin, "$(P)$(R)OUT1FineDelay-RB") {
  field(ASG, "Reserved")
  field(DESC, "EVR OUT1 fine delay status")
  field(EGU, "5ps")
}

record(longin, "$(P)$(R)OUT1RFDelay-RB") {
  field(ASG, "Reserved")
  field(DESC, "EVR OUT1 RF delay status")
  field(EGU, "evt_T/20")
}

record(longout, "$(P)$(R)OUT1RFDelay-SP"){
  field(DESC, "EVR OUT1 RF delay")
  field(DRVL, "0")
  field(DRVH, "31")
  field(EGU, "evt_T/20")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_out_rfdly_set($(P),$(R),1) $(PORT)")
}

record(longout, "$(P)$(R)OUT1FineDelay-SP"){
  field(DESC, "EVR OUT1 fine delay")
  field(DRVL, "0")
  field(DRVH, "1023")
  field(EGU, "5ps")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_out_finedly_set($(P),$(R),1) $(PORT)")
}

record(longout, "$(P)$(R)OUT1SrcTrig-SP"){
  field(DESC, "EVR OUT1 source trigger")
  field(DRVL, "0")
  field(DRVH, "23")
  field(VAL, "17")
  field(PINI, "1")
  field(FLNK, "$(P)$(R)OUT1SrcTrigCalc")
}

record(calc, "$(P)$(R)OUT1SrcTrig-RB"){
  field(DESC, "EVR OUT1 source trigger RBV")
  field(INPA, "$(P)$(R)OUT1SrcTrigFan")
  field(CALC, "(A>=16 && A<=31)?A-16:A-32")
}

record(calcout, "$(P)$(R)OUT1SrcTrigCalc"){
  field(DESC, "EVR OUT1 source trigger calc")
  field(INPA, "$(P)$(R)OUT1SrcTrig-SP")
  field(CALC, "(A>=0 && A<=15)?A+16:A+32")
  field(OUT, "$(P)$(R)OUT1SrcTrigFan PP")
}

record(dfanout, "$(P)$(R)OUT1SrcTrigFan"){
  field(DESC, "EVR OUT1 source trigger fan")
  field(OUTA, "$(P)$(R)OUT1Src-Sel.ONVL PP")
  field(OUTB, "$(P)$(R)OUT1Src-Sts.ONVL PP")
  field(FLNK, "$(P)$(R)OUT1SrcTrig-RB")
}

record(mbbo, "$(P)$(R)OUT1Src-Sel"){
  field(DESC, "EVR OUT1 source selection")
  field(ONST, "Trigger")
  field(ONVL, "0x31")
  field(TWST, "Clock0")
  field(TWVL, "0x20")
  field(THST, "Clock1")
  field(THVL, "0x21")
  field(FRST, "Clock2")
  field(FRVL, "0x22")
  field(FVST, "Clock3")
  field(FVVL, "0x23")
  field(SXST, "Clock4")
  field(SXVL, "0x24")
  field(SVST, "Clock5")
  field(SVVL, "0x25")
  field(EIST, "Clock6")
  field(EIVL, "0x26")
  field(NIST, "Clock7")
  field(NIVL, "0x27")
  field(ZRST, "Dsbl")
  field(ZRVL, "0x0")
  field(FLNK, "$(P)$(R)OUT1SrcHw")
}

record(calcout, "$(P)$(R)OUT1SrcHw"){
  field(ASG, "Reserved")
  field(DESC, "EVR OUT1 source selection write reg")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OUT1Src-Sel.RVAL")
  field(CALC, "A")
  field(OUT, "@timing.proto evre_out_src_set($(P),$(R),1) $(PORT)")
}

record(calcout, "$(P)$(R)OUT1IntlkCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OUT1 set interlock function calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OUT1Intlk-Sel.RVAL")
  field(CALC, "A<<7")
  field(OUT, "@timing.proto evre_out_itl_set($(P),$(R),1) $(PORT)")
}

record(bo, "$(P)$(R)OUT1Intlk-Sel"){
  field(DESC, "EVR OUT1 interlock function selection")
  field(MASK, "1")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(FLNK, "$(P)$(R)OUT1IntlkCalc")
}

record(longout, "$(P)$(R)cmd_out_get1") {
  field(ASG, "Reserved")
  field(DESC, "Command code to read OUT1")
  field(VAL, "0x92") # (0x80 | (reg number=18))
}

record(longout, "$(P)$(R)cmd_out_set1") {
  field(ASG, "Reserved")
  field(DESC, "Command code to write to OUT1")
  field(VAL, "0x52")
}

########################################################################
# OUT2 Register [19]

record(mbbiDirect, "$(P)$(R)OUT2IntlkRaw") {
  field(ASG, "Reserved")
  field(DESC, "EVR OUT2 interlock raw status")
  field(NOBT, "8")
  field(SHFT, "7")
  field(SCAN, "I/O Intr")
  field(DTYP, "stream")
  field(INP, "@timing.proto evre_out_itl2RAW_intr $(PORT)")
  field(FLNK, "$(P)$(R)OUT2Intlk-Sts")
}

record(bi, "$(P)$(R)OUT2Intlk-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OUT2 interlock status")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(INP, "$(P)$(R)OUT2IntlkRaw.B0")
}

record(mbbi, "$(P)$(R)OUT2Src-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OUT2 source selection status")
  field(NOBT, "7")
  field(SCAN, "I/O Intr")
  field(DTYP, "stream")
  field(ONST, "Trigger")
  field(ONVL, "0x32")
  field(TWST, "Clock0")
  field(TWVL, "0x20")
  field(THST, "Clock1")
  field(THVL, "0x21")
  field(FRST, "Clock2")
  field(FRVL, "0x22")
  field(FVST, "Clock3")
  field(FVVL, "0x23")
  field(SXST, "Clock4")
  field(SXVL, "0x24")
  field(SVST, "Clock5")
  field(SVVL, "0x25")
  field(EIST, "Clock6")
  field(EIVL, "0x26")
  field(NIST, "Clock7")
  field(NIVL, "0x27")
  field(ZRST, "Dsbl")
  field(ZRVL, "0x0")
  field(INP, "@timing.proto evre_out_sel2RAW_intr $(PORT)")
}

record(longin, "$(P)$(R)OUT2FineDelay-RB") {
  field(ASG, "Reserved")
  field(DESC, "EVR OUT2 fine delay status")
  field(EGU, "5ps")
}

record(longin, "$(P)$(R)OUT2RFDelay-RB") {
  field(ASG, "Reserved")
  field(DESC, "EVR OUT2 RF delay status")
  field(EGU, "evt_T/20")
}

record(longout, "$(P)$(R)OUT2RFDelay-SP"){
  field(DESC, "EVR OUT2 RF delay")
  field(DRVL, "0")
  field(DRVH, "31")
  field(EGU, "evt_T/20")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_out_rfdly_set($(P),$(R),2) $(PORT)")
}

record(longout, "$(P)$(R)OUT2FineDelay-SP"){
  field(DESC, "EVR OUT2 fine delay")
  field(DRVL, "0")
  field(DRVH, "1023")
  field(EGU, "5ps")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_out_finedly_set($(P),$(R),2) $(PORT)")
}

record(longout, "$(P)$(R)OUT2SrcTrig-SP"){
  field(DESC, "EVR OUT2 source trigger")
  field(DRVL, "0")
  field(DRVH, "23")
  field(VAL, "18")
  field(PINI, "1")
  field(FLNK, "$(P)$(R)OUT2SrcTrigCalc")
}

record(calc, "$(P)$(R)OUT2SrcTrig-RB"){
  field(DESC, "EVR OUT2 source trigger RBV")
  field(INPA, "$(P)$(R)OUT2SrcTrigFan")
  field(CALC, "(A>=16 && A<=31)?A-16:A-32")
}

record(calcout, "$(P)$(R)OUT2SrcTrigCalc"){
  field(DESC, "EVR OUT2 source trigger calc")
  field(INPA, "$(P)$(R)OUT2SrcTrig-SP")
  field(CALC, "(A>=0 && A<=15)?A+16:A+32")
  field(OUT, "$(P)$(R)OUT2SrcTrigFan PP")
}

record(dfanout, "$(P)$(R)OUT2SrcTrigFan"){
  field(DESC, "EVR OUT2 source trigger fan")
  field(OUTA, "$(P)$(R)OUT2Src-Sel.ONVL PP")
  field(OUTB, "$(P)$(R)OUT2Src-Sts.ONVL PP")
  field(FLNK, "$(P)$(R)OUT2SrcTrig-RB")
}

record(mbbo, "$(P)$(R)OUT2Src-Sel"){
  field(DESC, "EVR OUT2 source selection")
  field(ONST, "Trigger")
  field(ONVL, "0x32")
  field(TWST, "Clock0")
  field(TWVL, "0x20")
  field(THST, "Clock1")
  field(THVL, "0x21")
  field(FRST, "Clock2")
  field(FRVL, "0x22")
  field(FVST, "Clock3")
  field(FVVL, "0x23")
  field(SXST, "Clock4")
  field(SXVL, "0x24")
  field(SVST, "Clock5")
  field(SVVL, "0x25")
  field(EIST, "Clock6")
  field(EIVL, "0x26")
  field(NIST, "Clock7")
  field(NIVL, "0x27")
  field(ZRST, "Dsbl")
  field(ZRVL, "0x0")
  field(FLNK, "$(P)$(R)OUT2SrcHw")
}

record(calcout, "$(P)$(R)OUT2SrcHw"){
  field(ASG, "Reserved")
  field(DESC, "EVR OUT2 source selection write reg")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OUT2Src-Sel.RVAL")
  field(CALC, "A")
  field(OUT, "@timing.proto evre_out_src_set($(P),$(R),2) $(PORT)")
}

record(calcout, "$(P)$(R)OUT2IntlkCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OUT2 set interlock function calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OUT2Intlk-Sel.RVAL")
  field(CALC, "A<<7")
  field(OUT, "@timing.proto evre_out_itl_set($(P),$(R),2) $(PORT)")
}

record(bo, "$(P)$(R)OUT2Intlk-Sel"){
  field(DESC, "EVR OUT2 interlock function selection")
  field(MASK, "1")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(FLNK, "$(P)$(R)OUT2IntlkCalc")
}

record(longout, "$(P)$(R)cmd_out_get2") {
  field(ASG, "Reserved")
  field(DESC, "Command code to read OUT2")
  field(VAL, "0x93") # (0x80 | (reg number=19))
}

record(longout, "$(P)$(R)cmd_out_set2") {
  field(ASG, "Reserved")
  field(DESC, "Command code to write to OUT2")
  field(VAL, "0x53")
}

########################################################################
# OUT3 Register [20]

record(mbbiDirect, "$(P)$(R)OUT3IntlkRaw") {
  field(ASG, "Reserved")
  field(DESC, "EVR OUT3 interlock raw status")
  field(NOBT, "8")
  field(SHFT, "7")
  field(SCAN, "I/O Intr")
  field(DTYP, "stream")
  field(INP, "@timing.proto evre_out_itl3RAW_intr $(PORT)")
  field(FLNK, "$(P)$(R)OUT3Intlk-Sts")
}

record(bi, "$(P)$(R)OUT3Intlk-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OUT3 interlock status")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(INP, "$(P)$(R)OUT3IntlkRaw.B0")
}

record(mbbi, "$(P)$(R)OUT3Src-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OUT3 source selection status")
  field(NOBT, "7")
  field(SCAN, "I/O Intr")
  field(DTYP, "stream")
  field(ONST, "Trigger")
  field(ONVL, "0x33")
  field(TWST, "Clock0")
  field(TWVL, "0x20")
  field(THST, "Clock1")
  field(THVL, "0x21")
  field(FRST, "Clock2")
  field(FRVL, "0x22")
  field(FVST, "Clock3")
  field(FVVL, "0x23")
  field(SXST, "Clock4")
  field(SXVL, "0x24")
  field(SVST, "Clock5")
  field(SVVL, "0x25")
  field(EIST, "Clock6")
  field(EIVL, "0x26")
  field(NIST, "Clock7")
  field(NIVL, "0x27")
  field(ZRST, "Dsbl")
  field(ZRVL, "0x0")
  field(INP, "@timing.proto evre_out_sel3RAW_intr $(PORT)")
}

record(longin, "$(P)$(R)OUT3FineDelay-RB") {
  field(ASG, "Reserved")
  field(DESC, "EVR OUT3 fine delay status")
  field(EGU, "5ps")
}

record(longin, "$(P)$(R)OUT3RFDelay-RB") {
  field(ASG, "Reserved")
  field(DESC, "EVR OUT3 RF delay status")
  field(EGU, "evt_T/20")
}

record(longout, "$(P)$(R)OUT3RFDelay-SP"){
  field(DESC, "EVR OUT3 RF delay")
  field(DRVL, "0")
  field(DRVH, "31")
  field(EGU, "evt_T/20")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_out_rfdly_set($(P),$(R),3) $(PORT)")
}

record(longout, "$(P)$(R)OUT3FineDelay-SP"){
  field(DESC, "EVR OUT3 fine delay")
  field(DRVL, "0")
  field(DRVH, "1023")
  field(EGU, "5ps")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_out_finedly_set($(P),$(R),3) $(PORT)")
}

record(longout, "$(P)$(R)OUT3SrcTrig-SP"){
  field(DESC, "EVR OUT3 source trigger")
  field(DRVL, "0")
  field(DRVH, "23")
  field(VAL, "19")
  field(PINI, "1")
  field(FLNK, "$(P)$(R)OUT3SrcTrigCalc")
}

record(calc, "$(P)$(R)OUT3SrcTrig-RB"){
  field(DESC, "EVR OUT3 source trigger RBV")
  field(INPA, "$(P)$(R)OUT3SrcTrigFan")
  field(CALC, "(A>=16 && A<=31)?A-16:A-32")
}

record(calcout, "$(P)$(R)OUT3SrcTrigCalc"){
  field(DESC, "EVR OUT3 source trigger calc")
  field(INPA, "$(P)$(R)OUT3SrcTrig-SP")
  field(CALC, "(A>=0 && A<=15)?A+16:A+32")
  field(OUT, "$(P)$(R)OUT3SrcTrigFan PP")
}

record(dfanout, "$(P)$(R)OUT3SrcTrigFan"){
  field(DESC, "EVR OUT3 source trigger fan")
  field(OUTA, "$(P)$(R)OUT3Src-Sel.ONVL PP")
  field(OUTB, "$(P)$(R)OUT3Src-Sts.ONVL PP")
  field(FLNK, "$(P)$(R)OUT3SrcTrig-RB")
}

record(mbbo, "$(P)$(R)OUT3Src-Sel"){
  field(DESC, "EVR OUT3 source selection")
  field(ONST, "Trigger")
  field(ONVL, "0x33")
  field(TWST, "Clock0")
  field(TWVL, "0x20")
  field(THST, "Clock1")
  field(THVL, "0x21")
  field(FRST, "Clock2")
  field(FRVL, "0x22")
  field(FVST, "Clock3")
  field(FVVL, "0x23")
  field(SXST, "Clock4")
  field(SXVL, "0x24")
  field(SVST, "Clock5")
  field(SVVL, "0x25")
  field(EIST, "Clock6")
  field(EIVL, "0x26")
  field(NIST, "Clock7")
  field(NIVL, "0x27")
  field(ZRST, "Dsbl")
  field(ZRVL, "0x0")
  field(FLNK, "$(P)$(R)OUT3SrcHw")
}

record(calcout, "$(P)$(R)OUT3SrcHw"){
  field(ASG, "Reserved")
  field(DESC, "EVR OUT3 source selection write reg")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OUT3Src-Sel.RVAL")
  field(CALC, "A")
  field(OUT, "@timing.proto evre_out_src_set($(P),$(R),3) $(PORT)")
}

record(calcout, "$(P)$(R)OUT3IntlkCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OUT3 set interlock function calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OUT3Intlk-Sel.RVAL")
  field(CALC, "A<<7")
  field(OUT, "@timing.proto evre_out_itl_set($(P),$(R),3) $(PORT)")
}

record(bo, "$(P)$(R)OUT3Intlk-Sel"){
  field(DESC, "EVR OUT3 interlock function selection")
  field(MASK, "1")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(FLNK, "$(P)$(R)OUT3IntlkCalc")
}

record(longout, "$(P)$(R)cmd_out_get3") {
  field(ASG, "Reserved")
  field(DESC, "Command code to read OUT3")
  field(VAL, "0x94") # (0x80 | (reg number=20))
}

record(longout, "$(P)$(R)cmd_out_set3") {
  field(ASG, "Reserved")
  field(DESC, "Command code to write to OUT3")
  field(VAL, "0x54")
}

########################################################################
# OUT4 Register [21]

record(mbbiDirect, "$(P)$(R)OUT4IntlkRaw") {
  field(ASG, "Reserved")
  field(DESC, "EVR OUT4 interlock raw status")
  field(NOBT, "8")
  field(SHFT, "7")
  field(SCAN, "I/O Intr")
  field(DTYP, "stream")
  field(INP, "@timing.proto evre_out_itl4RAW_intr $(PORT)")
  field(FLNK, "$(P)$(R)OUT4Intlk-Sts")
}

record(bi, "$(P)$(R)OUT4Intlk-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OUT4 interlock status")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(INP, "$(P)$(R)OUT4IntlkRaw.B0")
}

record(mbbi, "$(P)$(R)OUT4Src-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OUT4 source selection status")
  field(NOBT, "7")
  field(SCAN, "I/O Intr")
  field(DTYP, "stream")
  field(ONST, "Trigger")
  field(ONVL, "0x34")
  field(TWST, "Clock0")
  field(TWVL, "0x20")
  field(THST, "Clock1")
  field(THVL, "0x21")
  field(FRST, "Clock2")
  field(FRVL, "0x22")
  field(FVST, "Clock3")
  field(FVVL, "0x23")
  field(SXST, "Clock4")
  field(SXVL, "0x24")
  field(SVST, "Clock5")
  field(SVVL, "0x25")
  field(EIST, "Clock6")
  field(EIVL, "0x26")
  field(NIST, "Clock7")
  field(NIVL, "0x27")
  field(ZRST, "Dsbl")
  field(ZRVL, "0x0")
  field(INP, "@timing.proto evre_out_sel4RAW_intr $(PORT)")
}

record(longin, "$(P)$(R)OUT4FineDelay-RB") {
  field(ASG, "Reserved")
  field(DESC, "EVR OUT4 fine delay status")
  field(EGU, "5ps")
}

record(longin, "$(P)$(R)OUT4RFDelay-RB") {
  field(ASG, "Reserved")
  field(DESC, "EVR OUT4 RF delay status")
  field(EGU, "evt_T/20")
}

record(longout, "$(P)$(R)OUT4RFDelay-SP"){
  field(DESC, "EVR OUT4 RF delay")
  field(DRVL, "0")
  field(DRVH, "31")
  field(EGU, "evt_T/20")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_out_rfdly_set($(P),$(R),4) $(PORT)")
}

record(longout, "$(P)$(R)OUT4FineDelay-SP"){
  field(DESC, "EVR OUT4 fine delay")
  field(DRVL, "0")
  field(DRVH, "1023")
  field(EGU, "5ps")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_out_finedly_set($(P),$(R),4) $(PORT)")
}

record(longout, "$(P)$(R)OUT4SrcTrig-SP"){
  field(DESC, "EVR OUT4 source trigger")
  field(DRVL, "0")
  field(DRVH, "23")
  field(VAL, "20")
  field(PINI, "1")
  field(FLNK, "$(P)$(R)OUT4SrcTrigCalc")
}

record(calc, "$(P)$(R)OUT4SrcTrig-RB"){
  field(DESC, "EVR OUT4 source trigger RBV")
  field(INPA, "$(P)$(R)OUT4SrcTrigFan")
  field(CALC, "(A>=16 && A<=31)?A-16:A-32")
}

record(calcout, "$(P)$(R)OUT4SrcTrigCalc"){
  field(DESC, "EVR OUT4 source trigger calc")
  field(INPA, "$(P)$(R)OUT4SrcTrig-SP")
  field(CALC, "(A>=0 && A<=15)?A+16:A+32")
  field(OUT, "$(P)$(R)OUT4SrcTrigFan PP")
}

record(dfanout, "$(P)$(R)OUT4SrcTrigFan"){
  field(DESC, "EVR OUT4 source trigger fan")
  field(OUTA, "$(P)$(R)OUT4Src-Sel.ONVL PP")
  field(OUTB, "$(P)$(R)OUT4Src-Sts.ONVL PP")
  field(FLNK, "$(P)$(R)OUT4SrcTrig-RB")
}

record(mbbo, "$(P)$(R)OUT4Src-Sel"){
  field(DESC, "EVR OUT4 source selection")
  field(ONST, "Trigger")
  field(ONVL, "0x34")
  field(TWST, "Clock0")
  field(TWVL, "0x20")
  field(THST, "Clock1")
  field(THVL, "0x21")
  field(FRST, "Clock2")
  field(FRVL, "0x22")
  field(FVST, "Clock3")
  field(FVVL, "0x23")
  field(SXST, "Clock4")
  field(SXVL, "0x24")
  field(SVST, "Clock5")
  field(SVVL, "0x25")
  field(EIST, "Clock6")
  field(EIVL, "0x26")
  field(NIST, "Clock7")
  field(NIVL, "0x27")
  field(ZRST, "Dsbl")
  field(ZRVL, "0x0")
  field(FLNK, "$(P)$(R)OUT4SrcHw")
}

record(calcout, "$(P)$(R)OUT4SrcHw"){
  field(ASG, "Reserved")
  field(DESC, "EVR OUT4 source selection write reg")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OUT4Src-Sel.RVAL")
  field(CALC, "A")
  field(OUT, "@timing.proto evre_out_src_set($(P),$(R),4) $(PORT)")
}

record(calcout, "$(P)$(R)OUT4IntlkCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OUT4 set interlock function calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OUT4Intlk-Sel.RVAL")
  field(CALC, "A<<7")
  field(OUT, "@timing.proto evre_out_itl_set($(P),$(R),4) $(PORT)")
}

record(bo, "$(P)$(R)OUT4Intlk-Sel"){
  field(DESC, "EVR OUT4 interlock function selection")
  field(MASK, "1")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(FLNK, "$(P)$(R)OUT4IntlkCalc")
}

record(longout, "$(P)$(R)cmd_out_get4") {
  field(ASG, "Reserved")
  field(DESC, "Command code to read OUT4")
  field(VAL, "0x95") # (0x80 | (reg number=21))
}

record(longout, "$(P)$(R)cmd_out_set4") {
  field(ASG, "Reserved")
  field(DESC, "Command code to write to OUT4")
  field(VAL, "0x55")
}

########################################################################
# OUT5 Register [22]

record(mbbiDirect, "$(P)$(R)OUT5IntlkRaw") {
  field(ASG, "Reserved")
  field(DESC, "EVR OUT5 interlock raw status")
  field(NOBT, "8")
  field(SHFT, "7")
  field(SCAN, "I/O Intr")
  field(DTYP, "stream")
  field(INP, "@timing.proto evre_out_itl5RAW_intr $(PORT)")
  field(FLNK, "$(P)$(R)OUT5Intlk-Sts")
}

record(bi, "$(P)$(R)OUT5Intlk-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OUT5 interlock status")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(INP, "$(P)$(R)OUT5IntlkRaw.B0")
}

record(mbbi, "$(P)$(R)OUT5Src-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OUT5 source selection status")
  field(NOBT, "7")
  field(SCAN, "I/O Intr")
  field(DTYP, "stream")
  field(ONST, "Trigger")
  field(ONVL, "0x35")
  field(TWST, "Clock0")
  field(TWVL, "0x20")
  field(THST, "Clock1")
  field(THVL, "0x21")
  field(FRST, "Clock2")
  field(FRVL, "0x22")
  field(FVST, "Clock3")
  field(FVVL, "0x23")
  field(SXST, "Clock4")
  field(SXVL, "0x24")
  field(SVST, "Clock5")
  field(SVVL, "0x25")
  field(EIST, "Clock6")
  field(EIVL, "0x26")
  field(NIST, "Clock7")
  field(NIVL, "0x27")
  field(ZRST, "Dsbl")
  field(ZRVL, "0x0")
  field(INP, "@timing.proto evre_out_sel5RAW_intr $(PORT)")
}

record(longin, "$(P)$(R)OUT5FineDelay-RB") {
  field(ASG, "Reserved")
  field(DESC, "EVR OUT5 fine delay status")
  field(EGU, "5ps")
}

record(longin, "$(P)$(R)OUT5RFDelay-RB") {
  field(ASG, "Reserved")
  field(DESC, "EVR OUT5 RF delay status")
  field(EGU, "evt_T/20")
}

record(longout, "$(P)$(R)OUT5RFDelay-SP"){
  field(DESC, "EVR OUT5 RF delay")
  field(DRVL, "0")
  field(DRVH, "31")
  field(EGU, "evt_T/20")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_out_rfdly_set($(P),$(R),5) $(PORT)")
}

record(longout, "$(P)$(R)OUT5FineDelay-SP"){
  field(DESC, "EVR OUT5 fine delay")
  field(DRVL, "0")
  field(DRVH, "1023")
  field(EGU, "5ps")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_out_finedly_set($(P),$(R),5) $(PORT)")
}

record(longout, "$(P)$(R)OUT5SrcTrig-SP"){
  field(DESC, "EVR OUT5 source trigger")
  field(DRVL, "0")
  field(DRVH, "23")
  field(VAL, "21")
  field(PINI, "1")
  field(FLNK, "$(P)$(R)OUT5SrcTrigCalc")
}

record(calc, "$(P)$(R)OUT5SrcTrig-RB"){
  field(DESC, "EVR OUT5 source trigger RBV")
  field(INPA, "$(P)$(R)OUT5SrcTrigFan")
  field(CALC, "(A>=16 && A<=31)?A-16:A-32")
}

record(calcout, "$(P)$(R)OUT5SrcTrigCalc"){
  field(DESC, "EVR OUT5 source trigger calc")
  field(INPA, "$(P)$(R)OUT5SrcTrig-SP")
  field(CALC, "(A>=0 && A<=15)?A+16:A+32")
  field(OUT, "$(P)$(R)OUT5SrcTrigFan PP")
}

record(dfanout, "$(P)$(R)OUT5SrcTrigFan"){
  field(DESC, "EVR OUT5 source trigger fan")
  field(OUTA, "$(P)$(R)OUT5Src-Sel.ONVL PP")
  field(OUTB, "$(P)$(R)OUT5Src-Sts.ONVL PP")
  field(FLNK, "$(P)$(R)OUT5SrcTrig-RB")
}

record(mbbo, "$(P)$(R)OUT5Src-Sel"){
  field(DESC, "EVR OUT5 source selection")
  field(ONST, "Trigger")
  field(ONVL, "0x35")
  field(TWST, "Clock0")
  field(TWVL, "0x20")
  field(THST, "Clock1")
  field(THVL, "0x21")
  field(FRST, "Clock2")
  field(FRVL, "0x22")
  field(FVST, "Clock3")
  field(FVVL, "0x23")
  field(SXST, "Clock4")
  field(SXVL, "0x24")
  field(SVST, "Clock5")
  field(SVVL, "0x25")
  field(EIST, "Clock6")
  field(EIVL, "0x26")
  field(NIST, "Clock7")
  field(NIVL, "0x27")
  field(ZRST, "Dsbl")
  field(ZRVL, "0x0")
  field(FLNK, "$(P)$(R)OUT5SrcHw")
}

record(calcout, "$(P)$(R)OUT5SrcHw"){
  field(ASG, "Reserved")
  field(DESC, "EVR OUT5 source selection write reg")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OUT5Src-Sel.RVAL")
  field(CALC, "A")
  field(OUT, "@timing.proto evre_out_src_set($(P),$(R),5) $(PORT)")
}

record(calcout, "$(P)$(R)OUT5IntlkCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OUT5 set interlock function calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OUT5Intlk-Sel.RVAL")
  field(CALC, "A<<7")
  field(OUT, "@timing.proto evre_out_itl_set($(P),$(R),5) $(PORT)")
}

record(bo, "$(P)$(R)OUT5Intlk-Sel"){
  field(DESC, "EVR OUT5 interlock function selection")
  field(MASK, "1")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(FLNK, "$(P)$(R)OUT5IntlkCalc")
}

record(longout, "$(P)$(R)cmd_out_get5") {
  field(ASG, "Reserved")
  field(DESC, "Command code to read OUT5")
  field(VAL, "0x96") # (0x80 | (reg number=22))
}

record(longout, "$(P)$(R)cmd_out_set5") {
  field(ASG, "Reserved")
  field(DESC, "Command code to write to OUT5")
  field(VAL, "0x56")
}

########################################################################
# OUT6 Register [23]

record(mbbiDirect, "$(P)$(R)OUT6IntlkRaw") {
  field(ASG, "Reserved")
  field(DESC, "EVR OUT6 interlock raw status")
  field(NOBT, "8")
  field(SHFT, "7")
  field(SCAN, "I/O Intr")
  field(DTYP, "stream")
  field(INP, "@timing.proto evre_out_itl6RAW_intr $(PORT)")
  field(FLNK, "$(P)$(R)OUT6Intlk-Sts")
}

record(bi, "$(P)$(R)OUT6Intlk-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OUT6 interlock status")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(INP, "$(P)$(R)OUT6IntlkRaw.B0")
}

record(mbbi, "$(P)$(R)OUT6Src-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OUT6 source selection status")
  field(NOBT, "7")
  field(SCAN, "I/O Intr")
  field(DTYP, "stream")
  field(ONST, "Trigger")
  field(ONVL, "0x36")
  field(TWST, "Clock0")
  field(TWVL, "0x20")
  field(THST, "Clock1")
  field(THVL, "0x21")
  field(FRST, "Clock2")
  field(FRVL, "0x22")
  field(FVST, "Clock3")
  field(FVVL, "0x23")
  field(SXST, "Clock4")
  field(SXVL, "0x24")
  field(SVST, "Clock5")
  field(SVVL, "0x25")
  field(EIST, "Clock6")
  field(EIVL, "0x26")
  field(NIST, "Clock7")
  field(NIVL, "0x27")
  field(ZRST, "Dsbl")
  field(ZRVL, "0x0")
  field(INP, "@timing.proto evre_out_sel6RAW_intr $(PORT)")
}

record(longin, "$(P)$(R)OUT6FineDelay-RB") {
  field(ASG, "Reserved")
  field(DESC, "EVR OUT6 fine delay status")
  field(EGU, "5ps")
}

record(longin, "$(P)$(R)OUT6RFDelay-RB") {
  field(ASG, "Reserved")
  field(DESC, "EVR OUT6 RF delay status")
  field(EGU, "evt_T/20")
}

record(longout, "$(P)$(R)OUT6RFDelay-SP"){
  field(DESC, "EVR OUT6 RF delay")
  field(DRVL, "0")
  field(DRVH, "31")
  field(EGU, "evt_T/20")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_out_rfdly_set($(P),$(R),6) $(PORT)")
}

record(longout, "$(P)$(R)OUT6FineDelay-SP"){
  field(DESC, "EVR OUT6 fine delay")
  field(DRVL, "0")
  field(DRVH, "1023")
  field(EGU, "5ps")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_out_finedly_set($(P),$(R),6) $(PORT)")
}

record(longout, "$(P)$(R)OUT6SrcTrig-SP"){
  field(DESC, "EVR OUT6 source trigger")
  field(DRVL, "0")
  field(DRVH, "23")
  field(VAL, "22")
  field(PINI, "1")
  field(FLNK, "$(P)$(R)OUT6SrcTrigCalc")
}

record(calc, "$(P)$(R)OUT6SrcTrig-RB"){
  field(DESC, "EVR OUT6 source trigger RBV")
  field(INPA, "$(P)$(R)OUT6SrcTrigFan")
  field(CALC, "(A>=16 && A<=31)?A-16:A-32")
}

record(calcout, "$(P)$(R)OUT6SrcTrigCalc"){
  field(DESC, "EVR OUT6 source trigger calc")
  field(INPA, "$(P)$(R)OUT6SrcTrig-SP")
  field(CALC, "(A>=0 && A<=15)?A+16:A+32")
  field(OUT, "$(P)$(R)OUT6SrcTrigFan PP")
}

record(dfanout, "$(P)$(R)OUT6SrcTrigFan"){
  field(DESC, "EVR OUT6 source trigger fan")
  field(OUTA, "$(P)$(R)OUT6Src-Sel.ONVL PP")
  field(OUTB, "$(P)$(R)OUT6Src-Sts.ONVL PP")
  field(FLNK, "$(P)$(R)OUT6SrcTrig-RB")
}

record(mbbo, "$(P)$(R)OUT6Src-Sel"){
  field(DESC, "EVR OUT6 source selection")
  field(ONST, "Trigger")
  field(ONVL, "0x36")
  field(TWST, "Clock0")
  field(TWVL, "0x20")
  field(THST, "Clock1")
  field(THVL, "0x21")
  field(FRST, "Clock2")
  field(FRVL, "0x22")
  field(FVST, "Clock3")
  field(FVVL, "0x23")
  field(SXST, "Clock4")
  field(SXVL, "0x24")
  field(SVST, "Clock5")
  field(SVVL, "0x25")
  field(EIST, "Clock6")
  field(EIVL, "0x26")
  field(NIST, "Clock7")
  field(NIVL, "0x27")
  field(ZRST, "Dsbl")
  field(ZRVL, "0x0")
  field(FLNK, "$(P)$(R)OUT6SrcHw")
}

record(calcout, "$(P)$(R)OUT6SrcHw"){
  field(ASG, "Reserved")
  field(DESC, "EVR OUT6 source selection write reg")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OUT6Src-Sel.RVAL")
  field(CALC, "A")
  field(OUT, "@timing.proto evre_out_src_set($(P),$(R),6) $(PORT)")
}

record(calcout, "$(P)$(R)OUT6IntlkCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OUT6 set interlock function calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OUT6Intlk-Sel.RVAL")
  field(CALC, "A<<7")
  field(OUT, "@timing.proto evre_out_itl_set($(P),$(R),6) $(PORT)")
}

record(bo, "$(P)$(R)OUT6Intlk-Sel"){
  field(DESC, "EVR OUT6 interlock function selection")
  field(MASK, "1")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(FLNK, "$(P)$(R)OUT6IntlkCalc")
}

record(longout, "$(P)$(R)cmd_out_get6") {
  field(ASG, "Reserved")
  field(DESC, "Command code to read OUT6")
  field(VAL, "0x97") # (0x80 | (reg number=23))
}

record(longout, "$(P)$(R)cmd_out_set6") {
  field(ASG, "Reserved")
  field(DESC, "Command code to write to OUT6")
  field(VAL, "0x57")
}

########################################################################
# OUT7 Register [24]

record(mbbiDirect, "$(P)$(R)OUT7IntlkRaw") {
  field(ASG, "Reserved")
  field(DESC, "EVR OUT7 interlock raw status")
  field(NOBT, "8")
  field(SHFT, "7")
  field(SCAN, "I/O Intr")
  field(DTYP, "stream")
  field(INP, "@timing.proto evre_out_itl7RAW_intr $(PORT)")
  field(FLNK, "$(P)$(R)OUT7Intlk-Sts")
}

record(bi, "$(P)$(R)OUT7Intlk-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OUT7 interlock status")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(INP, "$(P)$(R)OUT7IntlkRaw.B0")
}

record(mbbi, "$(P)$(R)OUT7Src-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OUT7 source selection status")
  field(NOBT, "7")
  field(SCAN, "I/O Intr")
  field(DTYP, "stream")
  field(ONST, "Trigger")
  field(ONVL, "0x37")
  field(TWST, "Clock0")
  field(TWVL, "0x20")
  field(THST, "Clock1")
  field(THVL, "0x21")
  field(FRST, "Clock2")
  field(FRVL, "0x22")
  field(FVST, "Clock3")
  field(FVVL, "0x23")
  field(SXST, "Clock4")
  field(SXVL, "0x24")
  field(SVST, "Clock5")
  field(SVVL, "0x25")
  field(EIST, "Clock6")
  field(EIVL, "0x26")
  field(NIST, "Clock7")
  field(NIVL, "0x27")
  field(ZRST, "Dsbl")
  field(ZRVL, "0x0")
  field(INP, "@timing.proto evre_out_sel7RAW_intr $(PORT)")
}

record(longin, "$(P)$(R)OUT7FineDelay-RB") {
  field(ASG, "Reserved")
  field(DESC, "EVR OUT7 fine delay status")
  field(EGU, "5ps")
}

record(longin, "$(P)$(R)OUT7RFDelay-RB") {
  field(ASG, "Reserved")
  field(DESC, "EVR OUT7 RF delay status")
  field(EGU, "evt_T/20")
}

record(longout, "$(P)$(R)OUT7RFDelay-SP"){
  field(DESC, "EVR OUT7 RF delay")
  field(DRVL, "0")
  field(DRVH, "31")
  field(EGU, "evt_T/20")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_out_rfdly_set($(P),$(R),7) $(PORT)")
}

record(longout, "$(P)$(R)OUT7FineDelay-SP"){
  field(DESC, "EVR OUT7 fine delay")
  field(DRVL, "0")
  field(DRVH, "1023")
  field(EGU, "5ps")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_out_finedly_set($(P),$(R),7) $(PORT)")
}

record(longout, "$(P)$(R)OUT7SrcTrig-SP"){
  field(DESC, "EVR OUT7 source trigger")
  field(DRVL, "0")
  field(DRVH, "23")
  field(VAL, "23")
  field(PINI, "1")
  field(FLNK, "$(P)$(R)OUT7SrcTrigCalc")
}

record(calc, "$(P)$(R)OUT7SrcTrig-RB"){
  field(DESC, "EVR OUT7 source trigger RBV")
  field(INPA, "$(P)$(R)OUT7SrcTrigFan")
  field(CALC, "(A>=16 && A<=31)?A-16:A-32")
}

record(calcout, "$(P)$(R)OUT7SrcTrigCalc"){
  field(DESC, "EVR OUT7 source trigger calc")
  field(INPA, "$(P)$(R)OUT7SrcTrig-SP")
  field(CALC, "(A>=0 && A<=15)?A+16:A+32")
  field(OUT, "$(P)$(R)OUT7SrcTrigFan PP")
}

record(dfanout, "$(P)$(R)OUT7SrcTrigFan"){
  field(DESC, "EVR OUT7 source trigger fan")
  field(OUTA, "$(P)$(R)OUT7Src-Sel.ONVL PP")
  field(OUTB, "$(P)$(R)OUT7Src-Sts.ONVL PP")
  field(FLNK, "$(P)$(R)OUT7SrcTrig-RB")
}

record(mbbo, "$(P)$(R)OUT7Src-Sel"){
  field(DESC, "EVR OUT7 source selection")
  field(ONST, "Trigger")
  field(ONVL, "0x37")
  field(TWST, "Clock0")
  field(TWVL, "0x20")
  field(THST, "Clock1")
  field(THVL, "0x21")
  field(FRST, "Clock2")
  field(FRVL, "0x22")
  field(FVST, "Clock3")
  field(FVVL, "0x23")
  field(SXST, "Clock4")
  field(SXVL, "0x24")
  field(SVST, "Clock5")
  field(SVVL, "0x25")
  field(EIST, "Clock6")
  field(EIVL, "0x26")
  field(NIST, "Clock7")
  field(NIVL, "0x27")
  field(ZRST, "Dsbl")
  field(ZRVL, "0x0")
  field(FLNK, "$(P)$(R)OUT7SrcHw")
}

record(calcout, "$(P)$(R)OUT7SrcHw"){
  field(ASG, "Reserved")
  field(DESC, "EVR OUT7 source selection write reg")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OUT7Src-Sel.RVAL")
  field(CALC, "A")
  field(OUT, "@timing.proto evre_out_src_set($(P),$(R),7) $(PORT)")
}

record(calcout, "$(P)$(R)OUT7IntlkCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OUT7 set interlock function calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OUT7Intlk-Sel.RVAL")
  field(CALC, "A<<7")
  field(OUT, "@timing.proto evre_out_itl_set($(P),$(R),7) $(PORT)")
}

record(bo, "$(P)$(R)OUT7Intlk-Sel"){
  field(DESC, "EVR OUT7 interlock function selection")
  field(MASK, "1")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(FLNK, "$(P)$(R)OUT7IntlkCalc")
}

record(longout, "$(P)$(R)cmd_out_get7") {
  field(ASG, "Reserved")
  field(DESC, "Command code to read OUT7")
  field(VAL, "0x98") # (0x80 | (reg number=24))
}

record(longout, "$(P)$(R)cmd_out_set7") {
  field(ASG, "Reserved")
  field(DESC, "Command code to write to OUT7")
  field(VAL, "0x58")
}

########################################################################
# OTP16 Register [25]

record(longout, "$(P)$(R)OTP16Evt-SP") {
  field(DESC, "EVR OTP16 event code")
  field(DRVH, "63")
  field(DRVL, "0")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_otp_ev_set($(P),$(R),16) $(PORT)")
  field(FLNK, "$(P)$(R)OTP16DelayRaw")
}

record(longout, "$(P)$(R)OTP16NrPulses-SP"){
  field(VAL, "1")
  field(DESC, "EVR OTP16 number of pulses")
  field(DRVH, "65535")
  field(DRVL, "1")
  field(EGU, "pulses")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_otp_pulses_set($(P),$(R),16) $(PORT)")
  field(FLNK, "$(P)$(R)OTP16DelayRaw")
}

record(ao, "$(P)$(R)OTP16WidthTime-SP") {
  field(DESC, "EVR OTP16 trigger width time")
  field(VAL, "0.008")
  field(DRVH, "17000000")
  field(DRVL, "0.008")
  field(EGU, "us")
  field(FLNK, "$(P)$(R)OTP16WidthCalc")
}

record(calcout, "$(P)$(R)OTP16WidthCalc") {
  field(DESC, "EVR OTP16 trigger width calc")
  field(INPA, "$(P)$(R)OTP16WidthTime-SP")
  field(INPB, "$(P)TI-EVG:FPGAClk-Cte")
  field(CALC, "CEIL(A/(B*1000000))-A/(B*1000000)<0.5?CEIL(A/(B*1000000)):FLOOR(A/(B*1000000))")
  field(OUT, "$(P)$(R)OTP16Width-SP PP")
}

record(longout, "$(P)$(R)OTP16Width-SP") {
  field(DESC, "EVR OTP16 trigger width")
  field(VAL, "1")
  field(DRVH, "2147483647")
  field(DRVL, "1")
  field(EGU, "evt_T")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_otp_width_set($(P),$(R),16) $(PORT)")
  field(FLNK, "$(P)$(R)OTP16DelayRaw")
}

record(ao, "$(P)$(R)OTP16DelayTime-SP") {
  field(DESC, "EVR OTP16 trigger delay time")
  field(VAL, "0")
  field(DRVH, "17000000")
  field(DRVL, "0")
  field(EGU, "us")
  field(FLNK, "$(P)$(R)OTP16DelayTimeCalc")
}

record(calcout, "$(P)$(R)OTP16DelayTimeCalc") {
  field(DESC, "EVR OTP16 trigger delay calc")
  field(INPA, "$(P)$(R)OTP16DelayTime-SP")
  field(INPB, "$(P)TI-EVG:FPGAClk-Cte")
  field(CALC, "CEIL(A/(B*1000000))-A/(B*1000000)<0.5?CEIL(A/(B*1000000)):FLOOR(A/(B*1000000))")
  field(OUT, "$(P)$(R)OTP16Delay-SP PP")
}

record(longout, "$(P)$(R)OTP16Delay-SP") {
  field(DESC, "EVR OTP16 event delay")
  field(DRVH, "2147483647")
  field(DRVL, "1")
  field(EGU, "evt_T")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_otp_dly_set($(P),$(R),16) $(PORT)")
  field(FLNK, "$(P)$(R)OTP16DelayRaw")
}

record(bo, "$(P)$(R)OTP16State-Sel") {
  field(DESC, "EVR OTP16 enable")
  field(MASK, "1")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(FLNK, "$(P)$(R)OTP16StateCalc")
}

record(bo, "$(P)$(R)OTP16Polarity-Sel") {
  field(DESC, "EVR OTP16 polarity")
  field(MASK, "1")
  field(ZNAM, "Normal")
  field(ONAM, "Inverse")
  field(FLNK, "$(P)$(R)OTP16PolCalc")
}

record(bo, "$(P)$(R)OTP16Log-Sel") {
  field(DESC, "EVR OTP16 event timestamping enable")
  field(MASK, "1")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(FLNK, "$(P)$(R)OTP16LogCalc")
}

record(bo, "$(P)$(R)OTP16Intlk-Sel") {
  field(DESC, "EVR OTP16 interlock function selection")
  field(MASK, "1")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(FLNK, "$(P)$(R)OTP16IntlkCalc")
}

record(calcout, "$(P)$(R)OTP16StateCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP16 set enable calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OTP16State-Sel.RVAL")
  field(INPB, "$(P)$(R)OTP16Polarity-Sts.VAL")
  field(INPC, "$(P)$(R)OTP16Log-Sts.VAL")
  field(INPD, "$(P)$(R)OTP16Intlk-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
  field(OUT, "@timing.proto evre_otp_en_pol_time_itl_set($(P),$(R),16,State) $(PORT)")
  field(FLNK, "$(P)$(R)OTP16DelayCalc")
}

record(calcout, "$(P)$(R)OTP16PolCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP16 set polarity calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OTP16State-Sts.VAL")
  field(INPB, "$(P)$(R)OTP16Polarity-Sel.RVAL")
  field(INPC, "$(P)$(R)OTP16Log-Sts.VAL")
  field(INPD, "$(P)$(R)OTP16Intlk-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
  field(OUT, "@timing.proto evre_otp_en_pol_time_itl_set($(P),$(R),16,Pol) $(PORT)")
  field(FLNK, "$(P)$(R)OTP16DelayCalc")
}

record(calcout, "$(P)$(R)OTP16LogCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP16 set timestamping calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OTP16State-Sts.VAL")
  field(INPB, "$(P)$(R)OTP16Polarity-Sts.VAL")
  field(INPC, "$(P)$(R)OTP16Log-Sel.RVAL")
  field(INPD, "$(P)$(R)OTP16Intlk-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
  field(OUT, "@timing.proto evre_otp_en_pol_time_itl_set($(P),$(R),16,Log) $(PORT)")
  field(FLNK, "$(P)$(R)OTP16DelayCalc")
}

record(calcout, "$(P)$(R)OTP16IntlkCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP16 set interlock calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OTP16State-Sts.VAL")
  field(INPB, "$(P)$(R)OTP16Polarity-Sts.VAL")
  field(INPC, "$(P)$(R)OTP16Log-Sts.VAL")
  field(INPD, "$(P)$(R)OTP16Intlk-Sel.RVAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
  field(OUT, "@timing.proto evre_otp_en_pol_time_itl_set($(P),$(R),16,Intlk) $(PORT)")
  field(FLNK, "$(P)$(R)OTP16DelayCalc")
}

record(calcout, "$(P)$(R)OTP16DelayCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP16 download EN, POL, and TIME")
  field(INPA, "$(P)$(R)OTP16State-Sel.RVAL")
  field(INPB, "$(P)$(R)OTP16Polarity-Sel.RVAL")
  field(INPC, "$(P)$(R)OTP16Log-Sel.RVAL")
  field(INPD, "$(P)$(R)OTP16Intlk-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
}

record(mbbiDirect, "$(P)$(R)OTP16DelayRaw") {
  field(ASG, "Reserved")
  field(DESC, "OTP16 enable, pol, timelog and intlk RBV")
  field(NOBT, "8")
  field(SCAN, "I/O Intr")
  field(DTYP, "stream")
  field(INP, "@timing.proto evre_otp_enpoltimeGRBV_intr $(PORT)")
  field(FLNK, "$(P)$(R)OTP16Intlk-Sts")
}

record(bi, "$(P)$(R)OTP16Intlk-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP16 interlock status")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(INP, "$(P)$(R)OTP16DelayRaw.B4")
  field(FLNK, "$(P)$(R)OTP16Log-Sts")
}

record(bi, "$(P)$(R)OTP16Log-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP16 timestamping status")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(INP, "$(P)$(R)OTP16DelayRaw.B5")
  field(FLNK, "$(P)$(R)OTP16Polarity-Sts")
}

record(bi, "$(P)$(R)OTP16Polarity-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP16 polarity status")
  field(ZNAM, "Normal")
  field(ONAM, "Inverse")
  field(INP, "$(P)$(R)OTP16DelayRaw.B6")
  field(FLNK, "$(P)$(R)OTP16State-Sts")
}

record(bi, "$(P)$(R)OTP16State-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP16 enable status")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(INP, "$(P)$(R)OTP16DelayRaw.B7")
}

record(longin, "$(P)$(R)OTP16NrPulses-RB"){
  field(ASG, "Reserved")
  field(DESC, "EVR OTP16 number of pulses RBV")
  field(EGU, "pulses")
}

record(longin, "$(P)$(R)OTP16Evt-RB") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP16 event RBV")
}

record(longin, "$(P)$(R)OTP16Width-RB") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP16 width RBV")
  field(EGU, "evt_T")
  field(FLNK, "$(P)$(R)OTP16WidthTime-RB")
}

record(longin, "$(P)$(R)OTP16Delay-RB") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP16 delay RBV")
  field(EGU, "evt_T")
  field(FLNK, "$(P)$(R)OTP16DelayTime-RB")
}

record(calc, "$(P)$(R)OTP16WidthTime-RB") {
  field(INPA, "$(P)$(R)OTP16Width-RB")
  field(INPB, "$(P)TI-EVG:FPGAClk-Cte")
  field(PREC, "3")
  field(DESC, "EVR OTP16 width time RBV")
  field(EGU, "us")
  field(CALC, "A*B*1000000")
}

record(calc, "$(P)$(R)OTP16DelayTime-RB") {
  field(INPA, "$(P)$(R)OTP16Delay-RB")
  field(INPB, "$(P)TI-EVG:FPGAClk-Cte")
  field(PREC, "3")
  field(DESC, "EVR OTP16 delay time RBV")
  field(EGU, "us")
  field(CALC, "A*B*1000000")
}

record(longout, "$(P)$(R)cmd_otp_set16") {
  field(ASG, "Reserved")
  field(DESC, "Command code to write to OTP16")
  field(VAL, "0x59") # (0x40 | reg number=25)
}

record(longout, "$(P)$(R)cmd_otp_get16") {
  field(ASG, "Reserved")
  field(DESC, "Command code to read OTP16")
  field(VAL, "0x99") # (0x80 | reg number=25)
}

########################################################################
# OTP17 Register [26]

record(longout, "$(P)$(R)OTP17Evt-SP") {
  field(DESC, "EVR OTP17 event code")
  field(DRVH, "63")
  field(DRVL, "0")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_otp_ev_set($(P),$(R),17) $(PORT)")
  field(FLNK, "$(P)$(R)OTP17DelayRaw")
}

record(longout, "$(P)$(R)OTP17NrPulses-SP"){
  field(VAL, "1")
  field(DESC, "EVR OTP17 number of pulses")
  field(DRVH, "65535")
  field(DRVL, "1")
  field(EGU, "pulses")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_otp_pulses_set($(P),$(R),17) $(PORT)")
  field(FLNK, "$(P)$(R)OTP17DelayRaw")
}

record(ao, "$(P)$(R)OTP17WidthTime-SP") {
  field(DESC, "EVR OTP17 trigger width time")
  field(VAL, "0.008")
  field(DRVH, "17000000")
  field(DRVL, "0.008")
  field(EGU, "us")
  field(FLNK, "$(P)$(R)OTP17WidthCalc")
}

record(calcout, "$(P)$(R)OTP17WidthCalc") {
  field(DESC, "EVR OTP17 trigger width calc")
  field(INPA, "$(P)$(R)OTP17WidthTime-SP")
  field(INPB, "$(P)TI-EVG:FPGAClk-Cte")
  field(CALC, "CEIL(A/(B*1000000))-A/(B*1000000)<0.5?CEIL(A/(B*1000000)):FLOOR(A/(B*1000000))")
  field(OUT, "$(P)$(R)OTP17Width-SP PP")
}

record(longout, "$(P)$(R)OTP17Width-SP") {
  field(DESC, "EVR OTP17 trigger width")
  field(VAL, "1")
  field(DRVH, "2147483647")
  field(DRVL, "1")
  field(EGU, "evt_T")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_otp_width_set($(P),$(R),17) $(PORT)")
  field(FLNK, "$(P)$(R)OTP17DelayRaw")
}

record(ao, "$(P)$(R)OTP17DelayTime-SP") {
  field(DESC, "EVR OTP17 trigger delay time")
  field(VAL, "0")
  field(DRVH, "17000000")
  field(DRVL, "0")
  field(EGU, "us")
  field(FLNK, "$(P)$(R)OTP17DelayTimeCalc")
}

record(calcout, "$(P)$(R)OTP17DelayTimeCalc") {
  field(DESC, "EVR OTP17 trigger delay calc")
  field(INPA, "$(P)$(R)OTP17DelayTime-SP")
  field(INPB, "$(P)TI-EVG:FPGAClk-Cte")
  field(CALC, "CEIL(A/(B*1000000))-A/(B*1000000)<0.5?CEIL(A/(B*1000000)):FLOOR(A/(B*1000000))")
  field(OUT, "$(P)$(R)OTP17Delay-SP PP")
}

record(longout, "$(P)$(R)OTP17Delay-SP") {
  field(DESC, "EVR OTP17 event delay")
  field(DRVH, "2147483647")
  field(DRVL, "1")
  field(EGU, "evt_T")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_otp_dly_set($(P),$(R),17) $(PORT)")
  field(FLNK, "$(P)$(R)OTP17DelayRaw")
}

record(bo, "$(P)$(R)OTP17State-Sel") {
  field(DESC, "EVR OTP17 enable")
  field(MASK, "1")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(FLNK, "$(P)$(R)OTP17StateCalc")
}

record(bo, "$(P)$(R)OTP17Polarity-Sel") {
  field(DESC, "EVR OTP17 polarity")
  field(MASK, "1")
  field(ZNAM, "Normal")
  field(ONAM, "Inverse")
  field(FLNK, "$(P)$(R)OTP17PolCalc")
}

record(bo, "$(P)$(R)OTP17Log-Sel") {
  field(DESC, "EVR OTP17 event timestamping enable")
  field(MASK, "1")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(FLNK, "$(P)$(R)OTP17LogCalc")
}

record(bo, "$(P)$(R)OTP17Intlk-Sel") {
  field(DESC, "EVR OTP17 interlock function selection")
  field(MASK, "1")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(FLNK, "$(P)$(R)OTP17IntlkCalc")
}

record(calcout, "$(P)$(R)OTP17StateCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP17 set enable calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OTP17State-Sel.RVAL")
  field(INPB, "$(P)$(R)OTP17Polarity-Sts.VAL")
  field(INPC, "$(P)$(R)OTP17Log-Sts.VAL")
  field(INPD, "$(P)$(R)OTP17Intlk-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
  field(OUT, "@timing.proto evre_otp_en_pol_time_itl_set($(P),$(R),17,State) $(PORT)")
  field(FLNK, "$(P)$(R)OTP17DelayCalc")
}

record(calcout, "$(P)$(R)OTP17PolCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP17 set polarity calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OTP17State-Sts.VAL")
  field(INPB, "$(P)$(R)OTP17Polarity-Sel.RVAL")
  field(INPC, "$(P)$(R)OTP17Log-Sts.VAL")
  field(INPD, "$(P)$(R)OTP17Intlk-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
  field(OUT, "@timing.proto evre_otp_en_pol_time_itl_set($(P),$(R),17,Pol) $(PORT)")
  field(FLNK, "$(P)$(R)OTP17DelayCalc")
}

record(calcout, "$(P)$(R)OTP17LogCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP17 set timestamping calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OTP17State-Sts.VAL")
  field(INPB, "$(P)$(R)OTP17Polarity-Sts.VAL")
  field(INPC, "$(P)$(R)OTP17Log-Sel.RVAL")
  field(INPD, "$(P)$(R)OTP17Intlk-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
  field(OUT, "@timing.proto evre_otp_en_pol_time_itl_set($(P),$(R),17,Log) $(PORT)")
  field(FLNK, "$(P)$(R)OTP17DelayCalc")
}

record(calcout, "$(P)$(R)OTP17IntlkCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP17 set interlock calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OTP17State-Sts.VAL")
  field(INPB, "$(P)$(R)OTP17Polarity-Sts.VAL")
  field(INPC, "$(P)$(R)OTP17Log-Sts.VAL")
  field(INPD, "$(P)$(R)OTP17Intlk-Sel.RVAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
  field(OUT, "@timing.proto evre_otp_en_pol_time_itl_set($(P),$(R),17,Intlk) $(PORT)")
  field(FLNK, "$(P)$(R)OTP17DelayCalc")
}

record(calcout, "$(P)$(R)OTP17DelayCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP17 download EN, POL, and TIME")
  field(INPA, "$(P)$(R)OTP17State-Sel.RVAL")
  field(INPB, "$(P)$(R)OTP17Polarity-Sel.RVAL")
  field(INPC, "$(P)$(R)OTP17Log-Sel.RVAL")
  field(INPD, "$(P)$(R)OTP17Intlk-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
}

record(mbbiDirect, "$(P)$(R)OTP17DelayRaw") {
  field(ASG, "Reserved")
  field(DESC, "OTP17 enable, pol, timelog and intlk RBV")
  field(NOBT, "8")
  field(SCAN, "I/O Intr")
  field(DTYP, "stream")
  field(INP, "@timing.proto evre_otp_enpoltimeHRBV_intr $(PORT)")
  field(FLNK, "$(P)$(R)OTP17Intlk-Sts")
}

record(bi, "$(P)$(R)OTP17Intlk-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP17 interlock status")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(INP, "$(P)$(R)OTP17DelayRaw.B4")
  field(FLNK, "$(P)$(R)OTP17Log-Sts")
}

record(bi, "$(P)$(R)OTP17Log-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP17 timestamping status")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(INP, "$(P)$(R)OTP17DelayRaw.B5")
  field(FLNK, "$(P)$(R)OTP17Polarity-Sts")
}

record(bi, "$(P)$(R)OTP17Polarity-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP17 polarity status")
  field(ZNAM, "Normal")
  field(ONAM, "Inverse")
  field(INP, "$(P)$(R)OTP17DelayRaw.B6")
  field(FLNK, "$(P)$(R)OTP17State-Sts")
}

record(bi, "$(P)$(R)OTP17State-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP17 enable status")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(INP, "$(P)$(R)OTP17DelayRaw.B7")
}

record(longin, "$(P)$(R)OTP17NrPulses-RB"){
  field(ASG, "Reserved")
  field(DESC, "EVR OTP17 number of pulses RBV")
  field(EGU, "pulses")
}

record(longin, "$(P)$(R)OTP17Evt-RB") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP17 event RBV")
}

record(longin, "$(P)$(R)OTP17Width-RB") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP17 width RBV")
  field(EGU, "evt_T")
  field(FLNK, "$(P)$(R)OTP17WidthTime-RB")
}

record(longin, "$(P)$(R)OTP17Delay-RB") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP17 delay RBV")
  field(EGU, "evt_T")
  field(FLNK, "$(P)$(R)OTP17DelayTime-RB")
}

record(calc, "$(P)$(R)OTP17WidthTime-RB") {
  field(INPA, "$(P)$(R)OTP17Width-RB")
  field(INPB, "$(P)TI-EVG:FPGAClk-Cte")
  field(PREC, "3")
  field(DESC, "EVR OTP17 width time RBV")
  field(EGU, "us")
  field(CALC, "A*B*1000000")
}

record(calc, "$(P)$(R)OTP17DelayTime-RB") {
  field(INPA, "$(P)$(R)OTP17Delay-RB")
  field(INPB, "$(P)TI-EVG:FPGAClk-Cte")
  field(PREC, "3")
  field(DESC, "EVR OTP17 delay time RBV")
  field(EGU, "us")
  field(CALC, "A*B*1000000")
}

record(longout, "$(P)$(R)cmd_otp_set17") {
  field(ASG, "Reserved")
  field(DESC, "Command code to write to OTP17")
  field(VAL, "0x5A") # (0x40 | reg number=26)
}

record(longout, "$(P)$(R)cmd_otp_get17") {
  field(ASG, "Reserved")
  field(DESC, "Command code to read OTP17")
  field(VAL, "0x9A") # (0x80 | reg number=26)
}

########################################################################
# OTP18 Register [27]

record(longout, "$(P)$(R)OTP18Evt-SP") {
  field(DESC, "EVR OTP18  event code")
  field(DRVH, "63")
  field(DRVL, "0")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_otp_ev_set($(P),$(R),18) $(PORT)")
  field(FLNK, "$(P)$(R)OTP18DelayRaw")
}

record(longout, "$(P)$(R)OTP18NrPulses-SP"){
  field(VAL, "1")
  field(DESC, "EVR OTP18  number of pulses")
  field(DRVH, "65535")
  field(DRVL, "1")
  field(EGU, "pulses")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_otp_pulses_set($(P),$(R),18) $(PORT)")
  field(FLNK, "$(P)$(R)OTP18DelayRaw")
}

record(ao, "$(P)$(R)OTP18WidthTime-SP") {
  field(DESC, "EVR OTP18 trigger width time")
  field(VAL, "0.008")
  field(DRVH, "17000000")
  field(DRVL, "0.008")
  field(EGU, "us")
  field(FLNK, "$(P)$(R)OTP18WidthCalc")
}

record(calcout, "$(P)$(R)OTP18WidthCalc") {
  field(DESC, "EVR OTP18 trigger width calc")
  field(INPA, "$(P)$(R)OTP18WidthTime-SP")
  field(INPB, "$(P)TI-EVG:FPGAClk-Cte")
  field(CALC, "CEIL(A/(B*1000000))-A/(B*1000000)<0.5?CEIL(A/(B*1000000)):FLOOR(A/(B*1000000))")
  field(OUT, "$(P)$(R)OTP18Width-SP PP")
}

record(longout, "$(P)$(R)OTP18Width-SP") {
  field(DESC, "EVR OTP18 trigger width")
  field(VAL, "1")
  field(DRVH, "2147483647")
  field(DRVL, "1")
  field(EGU, "evt_T")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_otp_width_set($(P),$(R),18) $(PORT)")
  field(FLNK, "$(P)$(R)OTP18DelayRaw")
}

record(ao, "$(P)$(R)OTP18DelayTime-SP") {
  field(DESC, "EVR OTP18 trigger delay time")
  field(VAL, "0")
  field(DRVH, "17000000")
  field(DRVL, "0")
  field(EGU, "us")
  field(FLNK, "$(P)$(R)OTP18DelayTimeCalc")
}

record(calcout, "$(P)$(R)OTP18DelayTimeCalc") {
  field(DESC, "EVR OTP18 trigger delay calc")
  field(INPA, "$(P)$(R)OTP18DelayTime-SP")
  field(INPB, "$(P)TI-EVG:FPGAClk-Cte")
  field(CALC, "CEIL(A/(B*1000000))-A/(B*1000000)<0.5?CEIL(A/(B*1000000)):FLOOR(A/(B*1000000))")
  field(OUT, "$(P)$(R)OTP18Delay-SP PP")
}

record(longout, "$(P)$(R)OTP18Delay-SP") {
  field(DESC, "EVR OTP18 event delay")
  field(DRVH, "2147483647")
  field(DRVL, "1")
  field(EGU, "evt_T")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_otp_dly_set($(P),$(R),18) $(PORT)")
  field(FLNK, "$(P)$(R)OTP18DelayRaw")
}

record(bo, "$(P)$(R)OTP18State-Sel") {
  field(DESC, "EVR OTP18  enable")
  field(MASK, "1")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(FLNK, "$(P)$(R)OTP18StateCalc")
}

record(bo, "$(P)$(R)OTP18Polarity-Sel") {
  field(DESC, "EVR OTP18  polarity")
  field(MASK, "1")
  field(ZNAM, "Normal")
  field(ONAM, "Inverse")
  field(FLNK, "$(P)$(R)OTP18PolCalc")
}

record(bo, "$(P)$(R)OTP18Log-Sel") {
  field(DESC, "EVR OTP18  event timestamping enable")
  field(MASK, "1")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(FLNK, "$(P)$(R)OTP18LogCalc")
}

record(bo, "$(P)$(R)OTP18Intlk-Sel") {
  field(DESC, "EVR OTP18 interlock function selection")
  field(MASK, "1")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(FLNK, "$(P)$(R)OTP18IntlkCalc")
}

record(calcout, "$(P)$(R)OTP18StateCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP18  set enable calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OTP18State-Sel.RVAL")
  field(INPB, "$(P)$(R)OTP18Polarity-Sts.VAL")
  field(INPC, "$(P)$(R)OTP18Log-Sts.VAL")
  field(INPD, "$(P)$(R)OTP18Intlk-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
  field(OUT, "@timing.proto evre_otp_en_pol_time_itl_set($(P),$(R),18,State) $(PORT)")
  field(FLNK, "$(P)$(R)OTP18DelayCalc")
}

record(calcout, "$(P)$(R)OTP18PolCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP18  set polarity calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OTP18State-Sts.VAL")
  field(INPB, "$(P)$(R)OTP18Polarity-Sel.RVAL")
  field(INPC, "$(P)$(R)OTP18Log-Sts.VAL")
  field(INPD, "$(P)$(R)OTP18Intlk-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
  field(OUT, "@timing.proto evre_otp_en_pol_time_itl_set($(P),$(R),18,Pol) $(PORT)")
  field(FLNK, "$(P)$(R)OTP18DelayCalc")
}

record(calcout, "$(P)$(R)OTP18LogCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP18  set timestamping calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OTP18State-Sts.VAL")
  field(INPB, "$(P)$(R)OTP18Polarity-Sts.VAL")
  field(INPC, "$(P)$(R)OTP18Log-Sel.RVAL")
  field(INPD, "$(P)$(R)OTP18Intlk-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
  field(OUT, "@timing.proto evre_otp_en_pol_time_itl_set($(P),$(R),18,Log) $(PORT)")
  field(FLNK, "$(P)$(R)OTP18DelayCalc")
}

record(calcout, "$(P)$(R)OTP18IntlkCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP18  set interlock calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OTP18State-Sts.VAL")
  field(INPB, "$(P)$(R)OTP18Polarity-Sts.VAL")
  field(INPC, "$(P)$(R)OTP18Log-Sts.VAL")
  field(INPD, "$(P)$(R)OTP18Intlk-Sel.RVAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
  field(OUT, "@timing.proto evre_otp_en_pol_time_itl_set($(P),$(R),18,Intlk) $(PORT)")
  field(FLNK, "$(P)$(R)OTP18DelayCalc")
}

record(calcout, "$(P)$(R)OTP18DelayCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP18  download EN, POL, and TIME")
  field(INPA, "$(P)$(R)OTP18State-Sel.RVAL")
  field(INPB, "$(P)$(R)OTP18Polarity-Sel.RVAL")
  field(INPC, "$(P)$(R)OTP18Log-Sel.RVAL")
  field(INPD, "$(P)$(R)OTP18Intlk-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
}

record(mbbiDirect, "$(P)$(R)OTP18DelayRaw") {
  field(ASG, "Reserved")
  field(DESC, "OTP18  enable, pol, timelog and intlk RBV")
  field(NOBT, "8")
  field(SCAN, "I/O Intr")
  field(DTYP, "stream")
  field(INP, "@timing.proto evre_otp_enpoltimeIRBV_intr $(PORT)")
  field(FLNK, "$(P)$(R)OTP18Intlk-Sts")
}

record(bi, "$(P)$(R)OTP18Intlk-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP18 interlock status")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(INP, "$(P)$(R)OTP18DelayRaw.B4")
  field(FLNK, "$(P)$(R)OTP18Log-Sts")
}

record(bi, "$(P)$(R)OTP18Log-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP18  timestamping status")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(INP, "$(P)$(R)OTP18DelayRaw.B5")
  field(FLNK, "$(P)$(R)OTP18Polarity-Sts")
}

record(bi, "$(P)$(R)OTP18Polarity-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP18  polarity status")
  field(ZNAM, "Normal")
  field(ONAM, "Inverse")
  field(INP, "$(P)$(R)OTP18DelayRaw.B6")
  field(FLNK, "$(P)$(R)OTP18State-Sts")
}

record(bi, "$(P)$(R)OTP18State-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP18  enable status")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(INP, "$(P)$(R)OTP18DelayRaw.B7")
}

record(longin, "$(P)$(R)OTP18NrPulses-RB"){
  field(ASG, "Reserved")
  field(DESC, "EVR OTP18  number of pulses RBV")
  field(EGU, "pulses")
}

record(longin, "$(P)$(R)OTP18Evt-RB") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP18  event RBV")
}

record(longin, "$(P)$(R)OTP18Width-RB") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP18 width RBV")
  field(EGU, "evt_T")
  field(FLNK, "$(P)$(R)OTP18WidthTime-RB")
}

record(longin, "$(P)$(R)OTP18Delay-RB") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP18 delay RBV")
  field(EGU, "evt_T")
  field(FLNK, "$(P)$(R)OTP18DelayTime-RB")
}

record(calc, "$(P)$(R)OTP18WidthTime-RB") {
  field(INPA, "$(P)$(R)OTP18Width-RB")
  field(INPB, "$(P)TI-EVG:FPGAClk-Cte")
  field(PREC, "3")
  field(DESC, "EVR OTP18 width time RBV")
  field(EGU, "us")
  field(CALC, "A*B*1000000")
}

record(calc, "$(P)$(R)OTP18DelayTime-RB") {
  field(INPA, "$(P)$(R)OTP18Delay-RB")
  field(INPB, "$(P)TI-EVG:FPGAClk-Cte")
  field(PREC, "3")
  field(DESC, "EVR OTP18 delay time RBV")
  field(EGU, "us")
  field(CALC, "A*B*1000000")
}

record(longout, "$(P)$(R)cmd_otp_set18") {
  field(ASG, "Reserved")
  field(DESC, "Command code to write to OTP18")
  field(VAL, "0x5B") # (0x40 | reg number=27)
}

record(longout, "$(P)$(R)cmd_otp_get18") {
  field(ASG, "Reserved")
  field(DESC, "Command code to read OTP18")
  field(VAL, "0x9B") # (0x80 | reg number=27)
}

########################################################################
# OTP19 Register [28]

record(longout, "$(P)$(R)OTP19Evt-SP") {
  field(DESC, "EVR OTP19  event code")
  field(DRVH, "63")
  field(DRVL, "0")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_otp_ev_set($(P),$(R),19) $(PORT)")
  field(FLNK, "$(P)$(R)OTP19DelayRaw")
}

record(longout, "$(P)$(R)OTP19NrPulses-SP"){
  field(VAL, "1")
  field(DESC, "EVR OTP19  number of pulses")
  field(DRVH, "65535")
  field(DRVL, "1")
  field(EGU, "pulses")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_otp_pulses_set($(P),$(R),19) $(PORT)")
  field(FLNK, "$(P)$(R)OTP19DelayRaw")
}

record(ao, "$(P)$(R)OTP19WidthTime-SP") {
  field(DESC, "EVR OTP19 trigger width time")
  field(VAL, "0.008")
  field(DRVH, "17000000")
  field(DRVL, "0.008")
  field(EGU, "us")
  field(FLNK, "$(P)$(R)OTP19WidthCalc")
}

record(calcout, "$(P)$(R)OTP19WidthCalc") {
  field(DESC, "EVR OTP19 trigger width calc")
  field(INPA, "$(P)$(R)OTP19WidthTime-SP")
  field(INPB, "$(P)TI-EVG:FPGAClk-Cte")
  field(CALC, "CEIL(A/(B*1000000))-A/(B*1000000)<0.5?CEIL(A/(B*1000000)):FLOOR(A/(B*1000000))")
  field(OUT, "$(P)$(R)OTP19Width-SP PP")
}

record(longout, "$(P)$(R)OTP19Width-SP") {
  field(DESC, "EVR OTP19 trigger width")
  field(VAL, "1")
  field(DRVH, "2147483647")
  field(DRVL, "1")
  field(EGU, "evt_T")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_otp_width_set($(P),$(R),19) $(PORT)")
  field(FLNK, "$(P)$(R)OTP19DelayRaw")
}

record(ao, "$(P)$(R)OTP19DelayTime-SP") {
  field(DESC, "EVR OTP19 trigger delay time")
  field(VAL, "0")
  field(DRVH, "17000000")
  field(DRVL, "0")
  field(EGU, "us")
  field(FLNK, "$(P)$(R)OTP19DelayTimeCalc")
}

record(calcout, "$(P)$(R)OTP19DelayTimeCalc") {
  field(DESC, "EVR OTP19 trigger delay calc")
  field(INPA, "$(P)$(R)OTP19DelayTime-SP")
  field(INPB, "$(P)TI-EVG:FPGAClk-Cte")
  field(CALC, "CEIL(A/(B*1000000))-A/(B*1000000)<0.5?CEIL(A/(B*1000000)):FLOOR(A/(B*1000000))")
  field(OUT, "$(P)$(R)OTP19Delay-SP PP")
}

record(longout, "$(P)$(R)OTP19Delay-SP") {
  field(DESC, "EVR OTP19 event delay")
  field(DRVH, "2147483647")
  field(DRVL, "1")
  field(EGU, "evt_T")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_otp_dly_set($(P),$(R),19) $(PORT)")
  field(FLNK, "$(P)$(R)OTP19DelayRaw")
}

record(bo, "$(P)$(R)OTP19State-Sel") {
  field(DESC, "EVR OTP19  enable")
  field(MASK, "1")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(FLNK, "$(P)$(R)OTP19StateCalc")
}

record(bo, "$(P)$(R)OTP19Polarity-Sel") {
  field(DESC, "EVR OTP19  polarity")
  field(MASK, "1")
  field(ZNAM, "Normal")
  field(ONAM, "Inverse")
  field(FLNK, "$(P)$(R)OTP19PolCalc")
}

record(bo, "$(P)$(R)OTP19Log-Sel") {
  field(DESC, "EVR OTP19  event timestamping enable")
  field(MASK, "1")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(FLNK, "$(P)$(R)OTP19LogCalc")
}

record(bo, "$(P)$(R)OTP19Intlk-Sel") {
  field(DESC, "EVR OTP19 interlock function selection")
  field(MASK, "1")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(FLNK, "$(P)$(R)OTP19IntlkCalc")
}

record(calcout, "$(P)$(R)OTP19StateCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP19  set enable calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OTP19State-Sel.RVAL")
  field(INPB, "$(P)$(R)OTP19Polarity-Sts.VAL")
  field(INPC, "$(P)$(R)OTP19Log-Sts.VAL")
  field(INPD, "$(P)$(R)OTP19Intlk-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
  field(OUT, "@timing.proto evre_otp_en_pol_time_itl_set($(P),$(R),19,State) $(PORT)")
  field(FLNK, "$(P)$(R)OTP19DelayCalc")
}

record(calcout, "$(P)$(R)OTP19PolCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP19  set polarity calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OTP19State-Sts.VAL")
  field(INPB, "$(P)$(R)OTP19Polarity-Sel.RVAL")
  field(INPC, "$(P)$(R)OTP19Log-Sts.VAL")
  field(INPD, "$(P)$(R)OTP19Intlk-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
  field(OUT, "@timing.proto evre_otp_en_pol_time_itl_set($(P),$(R),19,Pol) $(PORT)")
  field(FLNK, "$(P)$(R)OTP19DelayCalc")
}

record(calcout, "$(P)$(R)OTP19LogCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP19  set timestamping calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OTP19State-Sts.VAL")
  field(INPB, "$(P)$(R)OTP19Polarity-Sts.VAL")
  field(INPC, "$(P)$(R)OTP19Log-Sel.RVAL")
  field(INPD, "$(P)$(R)OTP19Intlk-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
  field(OUT, "@timing.proto evre_otp_en_pol_time_itl_set($(P),$(R),19,Log) $(PORT)")
  field(FLNK, "$(P)$(R)OTP19DelayCalc")
}

record(calcout, "$(P)$(R)OTP19IntlkCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP19  set interlock calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OTP19State-Sts.VAL")
  field(INPB, "$(P)$(R)OTP19Polarity-Sts.VAL")
  field(INPC, "$(P)$(R)OTP19Log-Sts.VAL")
  field(INPD, "$(P)$(R)OTP19Intlk-Sel.RVAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
  field(OUT, "@timing.proto evre_otp_en_pol_time_itl_set($(P),$(R),19,Intlk) $(PORT)")
  field(FLNK, "$(P)$(R)OTP19DelayCalc")
}

record(calcout, "$(P)$(R)OTP19DelayCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP19  download EN, POL, and TIME")
  field(INPA, "$(P)$(R)OTP19State-Sel.RVAL")
  field(INPB, "$(P)$(R)OTP19Polarity-Sel.RVAL")
  field(INPC, "$(P)$(R)OTP19Log-Sel.RVAL")
  field(INPD, "$(P)$(R)OTP19Intlk-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
}

record(mbbiDirect, "$(P)$(R)OTP19DelayRaw") {
  field(ASG, "Reserved")
  field(DESC, "OTP19  enable, pol, timelog and intlk RBV")
  field(NOBT, "8")
  field(SCAN, "I/O Intr")
  field(DTYP, "stream")
  field(INP, "@timing.proto evre_otp_enpoltimeJRBV_intr $(PORT)")
  field(FLNK, "$(P)$(R)OTP19Intlk-Sts")
}

record(bi, "$(P)$(R)OTP19Intlk-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP19 interlock status")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(INP, "$(P)$(R)OTP19DelayRaw.B4")
  field(FLNK, "$(P)$(R)OTP19Log-Sts")
}

record(bi, "$(P)$(R)OTP19Log-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP19  timestamping status")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(INP, "$(P)$(R)OTP19DelayRaw.B5")
  field(FLNK, "$(P)$(R)OTP19Polarity-Sts")
}

record(bi, "$(P)$(R)OTP19Polarity-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP19  polarity status")
  field(ZNAM, "Normal")
  field(ONAM, "Inverse")
  field(INP, "$(P)$(R)OTP19DelayRaw.B6")
  field(FLNK, "$(P)$(R)OTP19State-Sts")
}

record(bi, "$(P)$(R)OTP19State-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP19  enable status")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(INP, "$(P)$(R)OTP19DelayRaw.B7")
}

record(longin, "$(P)$(R)OTP19NrPulses-RB"){
  field(ASG, "Reserved")
  field(DESC, "EVR OTP19  number of pulses RBV")
  field(EGU, "pulses")
}

record(longin, "$(P)$(R)OTP19Evt-RB") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP19  event RBV")
}

record(longin, "$(P)$(R)OTP19Width-RB") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP19 width RBV")
  field(EGU, "evt_T")
  field(FLNK, "$(P)$(R)OTP19WidthTime-RB")
}

record(longin, "$(P)$(R)OTP19Delay-RB") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP19 delay RBV")
  field(EGU, "evt_T")
  field(FLNK, "$(P)$(R)OTP19DelayTime-RB")
}

record(calc, "$(P)$(R)OTP19WidthTime-RB") {
  field(INPA, "$(P)$(R)OTP19Width-RB")
  field(INPB, "$(P)TI-EVG:FPGAClk-Cte")
  field(PREC, "3")
  field(DESC, "EVR OTP19 width time RBV")
  field(EGU, "us")
  field(CALC, "A*B*1000000")
}

record(calc, "$(P)$(R)OTP19DelayTime-RB") {
  field(INPA, "$(P)$(R)OTP19Delay-RB")
  field(INPB, "$(P)TI-EVG:FPGAClk-Cte")
  field(PREC, "3")
  field(DESC, "EVR OTP19 delay time RBV")
  field(EGU, "us")
  field(CALC, "A*B*1000000")
}

record(longout, "$(P)$(R)cmd_otp_set19") {
  field(ASG, "Reserved")
  field(DESC, "Command code to write to OTP19")
  field(VAL, "0x5C") # (0x40 | reg number=28)
}

record(longout, "$(P)$(R)cmd_otp_get19") {
  field(ASG, "Reserved")
  field(DESC, "Command code to read OTP19")
  field(VAL, "0x9C") # (0x80 | reg number=28)
}

########################################################################
# OTP20 Register [29]

record(longout, "$(P)$(R)OTP20Evt-SP") {
  field(DESC, "EVR OTP20  event code")
  field(DRVH, "63")
  field(DRVL, "0")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_otp_ev_set($(P),$(R),20) $(PORT)")
  field(FLNK, "$(P)$(R)OTP20DelayRaw")
}

record(longout, "$(P)$(R)OTP20NrPulses-SP"){
  field(VAL, "1")
  field(DESC, "EVR OTP20  number of pulses")
  field(DRVH, "65535")
  field(DRVL, "1")
  field(EGU, "pulses")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_otp_pulses_set($(P),$(R),20) $(PORT)")
  field(FLNK, "$(P)$(R)OTP20DelayRaw")
}

record(ao, "$(P)$(R)OTP20WidthTime-SP") {
  field(DESC, "EVR OTP20 trigger width time")
  field(VAL, "0.008")
  field(DRVH, "17000000")
  field(DRVL, "0.008")
  field(EGU, "us")
  field(FLNK, "$(P)$(R)OTP20WidthCalc")
}

record(calcout, "$(P)$(R)OTP20WidthCalc") {
  field(DESC, "EVR OTP20 trigger width calc")
  field(INPA, "$(P)$(R)OTP20WidthTime-SP")
  field(INPB, "$(P)TI-EVG:FPGAClk-Cte")
  field(CALC, "CEIL(A/(B*1000000))-A/(B*1000000)<0.5?CEIL(A/(B*1000000)):FLOOR(A/(B*1000000))")
  field(OUT, "$(P)$(R)OTP20Width-SP PP")
}

record(longout, "$(P)$(R)OTP20Width-SP") {
  field(DESC, "EVR OTP20 trigger width")
  field(VAL, "1")
  field(DRVH, "2147483647")
  field(DRVL, "1")
  field(EGU, "evt_T")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_otp_width_set($(P),$(R),20) $(PORT)")
  field(FLNK, "$(P)$(R)OTP20DelayRaw")
}

record(ao, "$(P)$(R)OTP20DelayTime-SP") {
  field(DESC, "EVR OTP20 trigger delay time")
  field(VAL, "0")
  field(DRVH, "17000000")
  field(DRVL, "0")
  field(EGU, "us")
  field(FLNK, "$(P)$(R)OTP20DelayTimeCalc")
}

record(calcout, "$(P)$(R)OTP20DelayTimeCalc") {
  field(DESC, "EVR OTP20 trigger delay calc")
  field(INPA, "$(P)$(R)OTP20DelayTime-SP")
  field(INPB, "$(P)TI-EVG:FPGAClk-Cte")
  field(CALC, "CEIL(A/(B*1000000))-A/(B*1000000)<0.5?CEIL(A/(B*1000000)):FLOOR(A/(B*1000000))")
  field(OUT, "$(P)$(R)OTP20Delay-SP PP")
}

record(longout, "$(P)$(R)OTP20Delay-SP") {
  field(DESC, "EVR OTP20 event delay")
  field(DRVH, "2147483647")
  field(DRVL, "1")
  field(EGU, "evt_T")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_otp_dly_set($(P),$(R),20) $(PORT)")
  field(FLNK, "$(P)$(R)OTP20DelayRaw")
}

record(bo, "$(P)$(R)OTP20State-Sel") {
  field(DESC, "EVR OTP20  enable")
  field(MASK, "1")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(FLNK, "$(P)$(R)OTP20StateCalc")
}

record(bo, "$(P)$(R)OTP20Polarity-Sel") {
  field(DESC, "EVR OTP20  polarity")
  field(MASK, "1")
  field(ZNAM, "Normal")
  field(ONAM, "Inverse")
  field(FLNK, "$(P)$(R)OTP20PolCalc")
}

record(bo, "$(P)$(R)OTP20Log-Sel") {
  field(DESC, "EVR OTP20  event timestamping enable")
  field(MASK, "1")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(FLNK, "$(P)$(R)OTP20LogCalc")
}

record(bo, "$(P)$(R)OTP20Intlk-Sel") {
  field(DESC, "EVR OTP20 interlock function selection")
  field(MASK, "1")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(FLNK, "$(P)$(R)OTP20IntlkCalc")
}

record(calcout, "$(P)$(R)OTP20StateCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP20  set enable calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OTP20State-Sel.RVAL")
  field(INPB, "$(P)$(R)OTP20Polarity-Sts.VAL")
  field(INPC, "$(P)$(R)OTP20Log-Sts.VAL")
  field(INPD, "$(P)$(R)OTP20Intlk-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
  field(OUT, "@timing.proto evre_otp_en_pol_time_itl_set($(P),$(R),20,State) $(PORT)")
  field(FLNK, "$(P)$(R)OTP20DelayCalc")
}

record(calcout, "$(P)$(R)OTP20PolCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP20  set polarity calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OTP20State-Sts.VAL")
  field(INPB, "$(P)$(R)OTP20Polarity-Sel.RVAL")
  field(INPC, "$(P)$(R)OTP20Log-Sts.VAL")
  field(INPD, "$(P)$(R)OTP20Intlk-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
  field(OUT, "@timing.proto evre_otp_en_pol_time_itl_set($(P),$(R),20,Pol) $(PORT)")
  field(FLNK, "$(P)$(R)OTP20DelayCalc")
}

record(calcout, "$(P)$(R)OTP20LogCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP20  set timestamping calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OTP20State-Sts.VAL")
  field(INPB, "$(P)$(R)OTP20Polarity-Sts.VAL")
  field(INPC, "$(P)$(R)OTP20Log-Sel.RVAL")
  field(INPD, "$(P)$(R)OTP20Intlk-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
  field(OUT, "@timing.proto evre_otp_en_pol_time_itl_set($(P),$(R),20,Log) $(PORT)")
  field(FLNK, "$(P)$(R)OTP20DelayCalc")
}

record(calcout, "$(P)$(R)OTP20IntlkCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP20  set interlock calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OTP20State-Sts.VAL")
  field(INPB, "$(P)$(R)OTP20Polarity-Sts.VAL")
  field(INPC, "$(P)$(R)OTP20Log-Sts.VAL")
  field(INPD, "$(P)$(R)OTP20Intlk-Sel.RVAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
  field(OUT, "@timing.proto evre_otp_en_pol_time_itl_set($(P),$(R),20,Intlk) $(PORT)")
  field(FLNK, "$(P)$(R)OTP20DelayCalc")
}

record(calcout, "$(P)$(R)OTP20DelayCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP20  download EN, POL, and TIME")
  field(INPA, "$(P)$(R)OTP20State-Sel.RVAL")
  field(INPB, "$(P)$(R)OTP20Polarity-Sel.RVAL")
  field(INPC, "$(P)$(R)OTP20Log-Sel.RVAL")
  field(INPD, "$(P)$(R)OTP20Intlk-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
}

record(mbbiDirect, "$(P)$(R)OTP20DelayRaw") {
  field(ASG, "Reserved")
  field(DESC, "OTP20  enable, pol, timelog and intlk RBV")
  field(NOBT, "8")
  field(SCAN, "I/O Intr")
  field(DTYP, "stream")
  field(INP, "@timing.proto evre_otp_enpoltimeKRBV_intr $(PORT)")
  field(FLNK, "$(P)$(R)OTP20Intlk-Sts")
}

record(bi, "$(P)$(R)OTP20Intlk-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP20 interlock status")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(INP, "$(P)$(R)OTP20DelayRaw.B4")
  field(FLNK, "$(P)$(R)OTP20Log-Sts")
}

record(bi, "$(P)$(R)OTP20Log-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP20  timestamping status")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(INP, "$(P)$(R)OTP20DelayRaw.B5")
  field(FLNK, "$(P)$(R)OTP20Polarity-Sts")
}

record(bi, "$(P)$(R)OTP20Polarity-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP20  polarity status")
  field(ZNAM, "Normal")
  field(ONAM, "Inverse")
  field(INP, "$(P)$(R)OTP20DelayRaw.B6")
  field(FLNK, "$(P)$(R)OTP20State-Sts")
}

record(bi, "$(P)$(R)OTP20State-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP20  enable status")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(INP, "$(P)$(R)OTP20DelayRaw.B7")
}

record(longin, "$(P)$(R)OTP20NrPulses-RB"){
  field(ASG, "Reserved")
  field(DESC, "EVR OTP20  number of pulses RBV")
  field(EGU, "pulses")
}

record(longin, "$(P)$(R)OTP20Evt-RB") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP20  event RBV")
}

record(longin, "$(P)$(R)OTP20Width-RB") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP20 width RBV")
  field(EGU, "evt_T")
  field(FLNK, "$(P)$(R)OTP20WidthTime-RB")
}

record(longin, "$(P)$(R)OTP20Delay-RB") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP20 delay RBV")
  field(EGU, "evt_T")
  field(FLNK, "$(P)$(R)OTP20DelayTime-RB")
}

record(calc, "$(P)$(R)OTP20WidthTime-RB") {
  field(INPA, "$(P)$(R)OTP20Width-RB")
  field(INPB, "$(P)TI-EVG:FPGAClk-Cte")
  field(PREC, "3")
  field(DESC, "EVR OTP20 width time RBV")
  field(EGU, "us")
  field(CALC, "A*B*1000000")
}

record(calc, "$(P)$(R)OTP20DelayTime-RB") {
  field(INPA, "$(P)$(R)OTP20Delay-RB")
  field(INPB, "$(P)TI-EVG:FPGAClk-Cte")
  field(PREC, "3")
  field(DESC, "EVR OTP20 delay time RBV")
  field(EGU, "us")
  field(CALC, "A*B*1000000")
}

record(longout, "$(P)$(R)cmd_otp_set20") {
  field(ASG, "Reserved")
  field(DESC, "Command code to write to OTP20")
  field(VAL, "0x5D") # (0x40 | reg number=29)
}

record(longout, "$(P)$(R)cmd_otp_get20") {
  field(ASG, "Reserved")
  field(DESC, "Command code to read OTP20")
  field(VAL, "0x9D") # (0x80 | reg number=29)
}

########################################################################
# OTP21 Register [30]

record(longout, "$(P)$(R)OTP21Evt-SP") {
  field(DESC, "EVR OTP21  event code")
  field(DRVH, "63")
  field(DRVL, "0")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_otp_ev_set($(P),$(R),21) $(PORT)")
  field(FLNK, "$(P)$(R)OTP21DelayRaw")
}

record(longout, "$(P)$(R)OTP21NrPulses-SP"){
  field(VAL, "1")
  field(DESC, "EVR OTP21  number of pulses")
  field(DRVH, "65535")
  field(DRVL, "1")
  field(EGU, "pulses")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_otp_pulses_set($(P),$(R),21) $(PORT)")
  field(FLNK, "$(P)$(R)OTP21DelayRaw")
}

record(ao, "$(P)$(R)OTP21WidthTime-SP") {
  field(DESC, "EVR OTP21 trigger width time")
  field(VAL, "0.008")
  field(DRVH, "17000000")
  field(DRVL, "0.008")
  field(EGU, "us")
  field(FLNK, "$(P)$(R)OTP21WidthCalc")
}

record(calcout, "$(P)$(R)OTP21WidthCalc") {
  field(DESC, "EVR OTP21 trigger width calc")
  field(INPA, "$(P)$(R)OTP21WidthTime-SP")
  field(INPB, "$(P)TI-EVG:FPGAClk-Cte")
  field(CALC, "CEIL(A/(B*1000000))-A/(B*1000000)<0.5?CEIL(A/(B*1000000)):FLOOR(A/(B*1000000))")
  field(OUT, "$(P)$(R)OTP21Width-SP PP")
}

record(longout, "$(P)$(R)OTP21Width-SP") {
  field(DESC, "EVR OTP21 trigger width")
  field(VAL, "1")
  field(DRVH, "2147483647")
  field(DRVL, "1")
  field(EGU, "evt_T")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_otp_width_set($(P),$(R),21) $(PORT)")
  field(FLNK, "$(P)$(R)OTP21DelayRaw")
}

record(ao, "$(P)$(R)OTP21DelayTime-SP") {
  field(DESC, "EVR OTP21 trigger delay time")
  field(VAL, "0")
  field(DRVH, "17000000")
  field(DRVL, "0")
  field(EGU, "us")
  field(FLNK, "$(P)$(R)OTP21DelayTimeCalc")
}

record(calcout, "$(P)$(R)OTP21DelayTimeCalc") {
  field(DESC, "EVR OTP21 trigger delay calc")
  field(INPA, "$(P)$(R)OTP21DelayTime-SP")
  field(INPB, "$(P)TI-EVG:FPGAClk-Cte")
  field(CALC, "CEIL(A/(B*1000000))-A/(B*1000000)<0.5?CEIL(A/(B*1000000)):FLOOR(A/(B*1000000))")
  field(OUT, "$(P)$(R)OTP21Delay-SP PP")
}

record(longout, "$(P)$(R)OTP21Delay-SP") {
  field(DESC, "EVR OTP21 event delay")
  field(DRVH, "2147483647")
  field(DRVL, "1")
  field(EGU, "evt_T")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_otp_dly_set($(P),$(R),21) $(PORT)")
  field(FLNK, "$(P)$(R)OTP21DelayRaw")
}

record(bo, "$(P)$(R)OTP21State-Sel") {
  field(DESC, "EVR OTP21  enable")
  field(MASK, "1")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(FLNK, "$(P)$(R)OTP21StateCalc")
}

record(bo, "$(P)$(R)OTP21Polarity-Sel") {
  field(DESC, "EVR OTP21  polarity")
  field(MASK, "1")
  field(ZNAM, "Normal")
  field(ONAM, "Inverse")
  field(FLNK, "$(P)$(R)OTP21PolCalc")
}

record(bo, "$(P)$(R)OTP21Log-Sel") {
  field(DESC, "EVR OTP21  event timestamping enable")
  field(MASK, "1")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(FLNK, "$(P)$(R)OTP21LogCalc")
}

record(bo, "$(P)$(R)OTP21Intlk-Sel") {
  field(DESC, "EVR OTP21 interlock function selection")
  field(MASK, "1")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(FLNK, "$(P)$(R)OTP21IntlkCalc")
}

record(calcout, "$(P)$(R)OTP21StateCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP21  set enable calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OTP21State-Sel.RVAL")
  field(INPB, "$(P)$(R)OTP21Polarity-Sts.VAL")
  field(INPC, "$(P)$(R)OTP21Log-Sts.VAL")
  field(INPD, "$(P)$(R)OTP21Intlk-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
  field(OUT, "@timing.proto evre_otp_en_pol_time_itl_set($(P),$(R),21,State) $(PORT)")
  field(FLNK, "$(P)$(R)OTP21DelayCalc")
}

record(calcout, "$(P)$(R)OTP21PolCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP21  set polarity calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OTP21State-Sts.VAL")
  field(INPB, "$(P)$(R)OTP21Polarity-Sel.RVAL")
  field(INPC, "$(P)$(R)OTP21Log-Sts.VAL")
  field(INPD, "$(P)$(R)OTP21Intlk-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
  field(OUT, "@timing.proto evre_otp_en_pol_time_itl_set($(P),$(R),21,Pol) $(PORT)")
  field(FLNK, "$(P)$(R)OTP21DelayCalc")
}

record(calcout, "$(P)$(R)OTP21LogCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP21  set timestamping calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OTP21State-Sts.VAL")
  field(INPB, "$(P)$(R)OTP21Polarity-Sts.VAL")
  field(INPC, "$(P)$(R)OTP21Log-Sel.RVAL")
  field(INPD, "$(P)$(R)OTP21Intlk-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
  field(OUT, "@timing.proto evre_otp_en_pol_time_itl_set($(P),$(R),21,Log) $(PORT)")
  field(FLNK, "$(P)$(R)OTP21DelayCalc")
}

record(calcout, "$(P)$(R)OTP21IntlkCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP21  set interlock calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OTP21State-Sts.VAL")
  field(INPB, "$(P)$(R)OTP21Polarity-Sts.VAL")
  field(INPC, "$(P)$(R)OTP21Log-Sts.VAL")
  field(INPD, "$(P)$(R)OTP21Intlk-Sel.RVAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
  field(OUT, "@timing.proto evre_otp_en_pol_time_itl_set($(P),$(R),21,Intlk) $(PORT)")
  field(FLNK, "$(P)$(R)OTP21DelayCalc")
}

record(calcout, "$(P)$(R)OTP21DelayCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP21  download EN, POL, and TIME")
  field(INPA, "$(P)$(R)OTP21State-Sel.RVAL")
  field(INPB, "$(P)$(R)OTP21Polarity-Sel.RVAL")
  field(INPC, "$(P)$(R)OTP21Log-Sel.RVAL")
  field(INPD, "$(P)$(R)OTP21Intlk-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
}

record(mbbiDirect, "$(P)$(R)OTP21DelayRaw") {
  field(ASG, "Reserved")
  field(DESC, "OTP21  enable, pol, timelog and intlk RBV")
  field(NOBT, "8")
  field(SCAN, "I/O Intr")
  field(DTYP, "stream")
  field(INP, "@timing.proto evre_otp_enpoltimeLRBV_intr $(PORT)")
  field(FLNK, "$(P)$(R)OTP21Intlk-Sts")
}

record(bi, "$(P)$(R)OTP21Intlk-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP21 interlock status")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(INP, "$(P)$(R)OTP21DelayRaw.B4")
  field(FLNK, "$(P)$(R)OTP21Log-Sts")
}

record(bi, "$(P)$(R)OTP21Log-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP21  timestamping status")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(INP, "$(P)$(R)OTP21DelayRaw.B5")
  field(FLNK, "$(P)$(R)OTP21Polarity-Sts")
}

record(bi, "$(P)$(R)OTP21Polarity-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP21  polarity status")
  field(ZNAM, "Normal")
  field(ONAM, "Inverse")
  field(INP, "$(P)$(R)OTP21DelayRaw.B6")
  field(FLNK, "$(P)$(R)OTP21State-Sts")
}

record(bi, "$(P)$(R)OTP21State-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP21  enable status")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(INP, "$(P)$(R)OTP21DelayRaw.B7")
}

record(longin, "$(P)$(R)OTP21NrPulses-RB"){
  field(ASG, "Reserved")
  field(DESC, "EVR OTP21  number of pulses RBV")
  field(EGU, "pulses")
}

record(longin, "$(P)$(R)OTP21Evt-RB") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP21  event RBV")
}

record(longin, "$(P)$(R)OTP21Width-RB") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP21 width RBV")
  field(EGU, "evt_T")
  field(FLNK, "$(P)$(R)OTP21WidthTime-RB")
}

record(longin, "$(P)$(R)OTP21Delay-RB") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP21 delay RBV")
  field(EGU, "evt_T")
  field(FLNK, "$(P)$(R)OTP21DelayTime-RB")
}

record(calc, "$(P)$(R)OTP21WidthTime-RB") {
  field(INPA, "$(P)$(R)OTP21Width-RB")
  field(INPB, "$(P)TI-EVG:FPGAClk-Cte")
  field(PREC, "3")
  field(DESC, "EVR OTP21 width time RBV")
  field(EGU, "us")
  field(CALC, "A*B*1000000")
}

record(calc, "$(P)$(R)OTP21DelayTime-RB") {
  field(INPA, "$(P)$(R)OTP21Delay-RB")
  field(INPB, "$(P)TI-EVG:FPGAClk-Cte")
  field(PREC, "3")
  field(DESC, "EVR OTP21 delay time RBV")
  field(EGU, "us")
  field(CALC, "A*B*1000000")
}

record(longout, "$(P)$(R)cmd_otp_set21") {
  field(ASG, "Reserved")
  field(DESC, "Command code to write to OTP21")
  field(VAL, "0x5E") # (0x40 | reg number=30)
}

record(longout, "$(P)$(R)cmd_otp_get21") {
  field(ASG, "Reserved")
  field(DESC, "Command code to read OTP21")
  field(VAL, "0x9E") # (0x80 | reg number=30)
}

########################################################################
# OTP22 Register [31]

record(longout, "$(P)$(R)OTP22Evt-SP") {
  field(DESC, "EVR OTP22  event code")
  field(DRVH, "63")
  field(DRVL, "0")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_otp_ev_set($(P),$(R),22) $(PORT)")
  field(FLNK, "$(P)$(R)OTP22DelayRaw")
}

record(longout, "$(P)$(R)OTP22NrPulses-SP"){
  field(VAL, "1")
  field(DESC, "EVR OTP22  number of pulses")
  field(DRVH, "65535")
  field(DRVL, "1")
  field(EGU, "pulses")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_otp_pulses_set($(P),$(R),22) $(PORT)")
  field(FLNK, "$(P)$(R)OTP22DelayRaw")
}

record(ao, "$(P)$(R)OTP22WidthTime-SP") {
  field(DESC, "EVR OTP22 trigger width time")
  field(VAL, "0.008")
  field(DRVH, "17000000")
  field(DRVL, "0.008")
  field(EGU, "us")
  field(FLNK, "$(P)$(R)OTP22WidthCalc")
}

record(calcout, "$(P)$(R)OTP22WidthCalc") {
  field(DESC, "EVR OTP22 trigger width calc")
  field(INPA, "$(P)$(R)OTP22WidthTime-SP")
  field(INPB, "$(P)TI-EVG:FPGAClk-Cte")
  field(CALC, "CEIL(A/(B*1000000))-A/(B*1000000)<0.5?CEIL(A/(B*1000000)):FLOOR(A/(B*1000000))")
  field(OUT, "$(P)$(R)OTP22Width-SP PP")
}

record(longout, "$(P)$(R)OTP22Width-SP") {
  field(DESC, "EVR OTP22 trigger width")
  field(VAL, "1")
  field(DRVH, "2147483647")
  field(DRVL, "1")
  field(EGU, "evt_T")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_otp_width_set($(P),$(R),22) $(PORT)")
  field(FLNK, "$(P)$(R)OTP22DelayRaw")
}

record(ao, "$(P)$(R)OTP22DelayTime-SP") {
  field(DESC, "EVR OTP22 trigger delay time")
  field(VAL, "0")
  field(DRVH, "17000000")
  field(DRVL, "0")
  field(EGU, "us")
  field(FLNK, "$(P)$(R)OTP22DelayTimeCalc")
}

record(calcout, "$(P)$(R)OTP22DelayTimeCalc") {
  field(DESC, "EVR OTP22 trigger delay calc")
  field(INPA, "$(P)$(R)OTP22DelayTime-SP")
  field(INPB, "$(P)TI-EVG:FPGAClk-Cte")
  field(CALC, "CEIL(A/(B*1000000))-A/(B*1000000)<0.5?CEIL(A/(B*1000000)):FLOOR(A/(B*1000000))")
  field(OUT, "$(P)$(R)OTP22Delay-SP PP")
}

record(longout, "$(P)$(R)OTP22Delay-SP") {
  field(DESC, "EVR OTP22 event delay")
  field(DRVH, "2147483647")
  field(DRVL, "1")
  field(EGU, "evt_T")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_otp_dly_set($(P),$(R),22) $(PORT)")
  field(FLNK, "$(P)$(R)OTP22DelayRaw")
}

record(bo, "$(P)$(R)OTP22State-Sel") {
  field(DESC, "EVR OTP22  enable")
  field(MASK, "1")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(FLNK, "$(P)$(R)OTP22StateCalc")
}

record(bo, "$(P)$(R)OTP22Polarity-Sel") {
  field(DESC, "EVR OTP22  polarity")
  field(MASK, "1")
  field(ZNAM, "Normal")
  field(ONAM, "Inverse")
  field(FLNK, "$(P)$(R)OTP22PolCalc")
}

record(bo, "$(P)$(R)OTP22Log-Sel") {
  field(DESC, "EVR OTP22  event timestamping enable")
  field(MASK, "1")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(FLNK, "$(P)$(R)OTP22LogCalc")
}

record(bo, "$(P)$(R)OTP22Intlk-Sel") {
  field(DESC, "EVR OTP22 interlock function selection")
  field(MASK, "1")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(FLNK, "$(P)$(R)OTP22IntlkCalc")
}

record(calcout, "$(P)$(R)OTP22StateCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP22  set enable calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OTP22State-Sel.RVAL")
  field(INPB, "$(P)$(R)OTP22Polarity-Sts.VAL")
  field(INPC, "$(P)$(R)OTP22Log-Sts.VAL")
  field(INPD, "$(P)$(R)OTP22Intlk-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
  field(OUT, "@timing.proto evre_otp_en_pol_time_itl_set($(P),$(R),22,State) $(PORT)")
  field(FLNK, "$(P)$(R)OTP22DelayCalc")
}

record(calcout, "$(P)$(R)OTP22PolCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP22  set polarity calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OTP22State-Sts.VAL")
  field(INPB, "$(P)$(R)OTP22Polarity-Sel.RVAL")
  field(INPC, "$(P)$(R)OTP22Log-Sts.VAL")
  field(INPD, "$(P)$(R)OTP22Intlk-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
  field(OUT, "@timing.proto evre_otp_en_pol_time_itl_set($(P),$(R),22,Pol) $(PORT)")
  field(FLNK, "$(P)$(R)OTP22DelayCalc")
}

record(calcout, "$(P)$(R)OTP22LogCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP22  set timestamping calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OTP22State-Sts.VAL")
  field(INPB, "$(P)$(R)OTP22Polarity-Sts.VAL")
  field(INPC, "$(P)$(R)OTP22Log-Sel.RVAL")
  field(INPD, "$(P)$(R)OTP22Intlk-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
  field(OUT, "@timing.proto evre_otp_en_pol_time_itl_set($(P),$(R),22,Log) $(PORT)")
  field(FLNK, "$(P)$(R)OTP22DelayCalc")
}

record(calcout, "$(P)$(R)OTP22IntlkCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP22  set interlock calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OTP22State-Sts.VAL")
  field(INPB, "$(P)$(R)OTP22Polarity-Sts.VAL")
  field(INPC, "$(P)$(R)OTP22Log-Sts.VAL")
  field(INPD, "$(P)$(R)OTP22Intlk-Sel.RVAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
  field(OUT, "@timing.proto evre_otp_en_pol_time_itl_set($(P),$(R),22,Intlk) $(PORT)")
  field(FLNK, "$(P)$(R)OTP22DelayCalc")
}

record(calcout, "$(P)$(R)OTP22DelayCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP22  download EN, POL, and TIME")
  field(INPA, "$(P)$(R)OTP22State-Sel.RVAL")
  field(INPB, "$(P)$(R)OTP22Polarity-Sel.RVAL")
  field(INPC, "$(P)$(R)OTP22Log-Sel.RVAL")
  field(INPD, "$(P)$(R)OTP22Intlk-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
}

record(mbbiDirect, "$(P)$(R)OTP22DelayRaw") {
  field(ASG, "Reserved")
  field(DESC, "OTP22  enable, pol, timelog and intlk RBV")
  field(NOBT, "8")
  field(SCAN, "I/O Intr")
  field(DTYP, "stream")
  field(INP, "@timing.proto evre_otp_enpoltimeMRBV_intr $(PORT)")
  field(FLNK, "$(P)$(R)OTP22Intlk-Sts")
}

record(bi, "$(P)$(R)OTP22Intlk-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP22 interlock status")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(INP, "$(P)$(R)OTP22DelayRaw.B4")
  field(FLNK, "$(P)$(R)OTP22Log-Sts")
}

record(bi, "$(P)$(R)OTP22Log-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP22  timestamping status")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(INP, "$(P)$(R)OTP22DelayRaw.B5")
  field(FLNK, "$(P)$(R)OTP22Polarity-Sts")
}

record(bi, "$(P)$(R)OTP22Polarity-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP22  polarity status")
  field(ZNAM, "Normal")
  field(ONAM, "Inverse")
  field(INP, "$(P)$(R)OTP22DelayRaw.B6")
  field(FLNK, "$(P)$(R)OTP22State-Sts")
}

record(bi, "$(P)$(R)OTP22State-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP22  enable status")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(INP, "$(P)$(R)OTP22DelayRaw.B7")
}

record(longin, "$(P)$(R)OTP22NrPulses-RB"){
  field(ASG, "Reserved")
  field(DESC, "EVR OTP22  number of pulses RBV")
  field(EGU, "pulses")
}

record(longin, "$(P)$(R)OTP22Evt-RB") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP22  event RBV")
}

record(longin, "$(P)$(R)OTP22Width-RB") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP22 width RBV")
  field(EGU, "evt_T")
  field(FLNK, "$(P)$(R)OTP22WidthTime-RB")
}

record(longin, "$(P)$(R)OTP22Delay-RB") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP22 delay RBV")
  field(EGU, "evt_T")
  field(FLNK, "$(P)$(R)OTP22DelayTime-RB")
}

record(calc, "$(P)$(R)OTP22WidthTime-RB") {
  field(INPA, "$(P)$(R)OTP22Width-RB")
  field(INPB, "$(P)TI-EVG:FPGAClk-Cte")
  field(PREC, "3")
  field(DESC, "EVR OTP22 width time RBV")
  field(EGU, "us")
  field(CALC, "A*B*1000000")
}

record(calc, "$(P)$(R)OTP22DelayTime-RB") {
  field(INPA, "$(P)$(R)OTP22Delay-RB")
  field(INPB, "$(P)TI-EVG:FPGAClk-Cte")
  field(PREC, "3")
  field(DESC, "EVR OTP22 delay time RBV")
  field(EGU, "us")
  field(CALC, "A*B*1000000")
}

record(longout, "$(P)$(R)cmd_otp_set22") {
  field(ASG, "Reserved")
  field(DESC, "Command code to write to OTP22")
  field(VAL, "0x5F") # (0x40 | reg number=31)
}

record(longout, "$(P)$(R)cmd_otp_get22") {
  field(ASG, "Reserved")
  field(DESC, "Command code to read OTP22")
  field(VAL, "0x9F") # (0x80 | reg number=31)
}

########################################################################
# OTP23 Register [32]

record(longout, "$(P)$(R)OTP23Evt-SP") {
  field(DESC, "EVR OTP23  event code")
  field(DRVH, "63")
  field(DRVL, "0")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_otp_ev_set($(P),$(R),23) $(PORT)")
  field(FLNK, "$(P)$(R)OTP23DelayRaw")
}

record(longout, "$(P)$(R)OTP23NrPulses-SP"){
  field(VAL, "1")
  field(DESC, "EVR OTP23  number of pulses")
  field(DRVH, "65535")
  field(DRVL, "1")
  field(EGU, "pulses")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_otp_pulses_set($(P),$(R),23) $(PORT)")
  field(FLNK, "$(P)$(R)OTP23DelayRaw")
}

record(ao, "$(P)$(R)OTP23WidthTime-SP") {
  field(DESC, "EVR OTP23 trigger width time")
  field(VAL, "0.008")
  field(DRVH, "17000000")
  field(DRVL, "0.008")
  field(EGU, "us")
  field(FLNK, "$(P)$(R)OTP23WidthCalc")
}

record(calcout, "$(P)$(R)OTP23WidthCalc") {
  field(DESC, "EVR OTP23 trigger width calc")
  field(INPA, "$(P)$(R)OTP23WidthTime-SP")
  field(INPB, "$(P)TI-EVG:FPGAClk-Cte")
  field(CALC, "CEIL(A/(B*1000000))-A/(B*1000000)<0.5?CEIL(A/(B*1000000)):FLOOR(A/(B*1000000))")
  field(OUT, "$(P)$(R)OTP23Width-SP PP")
}

record(longout, "$(P)$(R)OTP23Width-SP") {
  field(DESC, "EVR OTP23 trigger width")
  field(VAL, "1")
  field(DRVH, "2147483647")
  field(DRVL, "1")
  field(EGU, "evt_T")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_otp_width_set($(P),$(R),23) $(PORT)")
  field(FLNK, "$(P)$(R)OTP23DelayRaw")
}

record(ao, "$(P)$(R)OTP23DelayTime-SP") {
  field(DESC, "EVR OTP23 trigger delay time")
  field(VAL, "0")
  field(DRVH, "17000000")
  field(DRVL, "0")
  field(EGU, "us")
  field(FLNK, "$(P)$(R)OTP23DelayTimeCalc")
}

record(calcout, "$(P)$(R)OTP23DelayTimeCalc") {
  field(DESC, "EVR OTP23 trigger delay calc")
  field(INPA, "$(P)$(R)OTP23DelayTime-SP")
  field(INPB, "$(P)TI-EVG:FPGAClk-Cte")
  field(CALC, "CEIL(A/(B*1000000))-A/(B*1000000)<0.5?CEIL(A/(B*1000000)):FLOOR(A/(B*1000000))")
  field(OUT, "$(P)$(R)OTP23Delay-SP PP")
}

record(longout, "$(P)$(R)OTP23Delay-SP") {
  field(DESC, "EVR OTP23 event delay")
  field(DRVH, "2147483647")
  field(DRVL, "1")
  field(EGU, "evt_T")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_otp_dly_set($(P),$(R),23) $(PORT)")
  field(FLNK, "$(P)$(R)OTP23DelayRaw")
}

record(bo, "$(P)$(R)OTP23State-Sel") {
  field(DESC, "EVR OTP23  enable")
  field(MASK, "1")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(FLNK, "$(P)$(R)OTP23StateCalc")
}

record(bo, "$(P)$(R)OTP23Polarity-Sel") {
  field(DESC, "EVR OTP23  polarity")
  field(MASK, "1")
  field(ZNAM, "Normal")
  field(ONAM, "Inverse")
  field(FLNK, "$(P)$(R)OTP23PolCalc")
}

record(bo, "$(P)$(R)OTP23Log-Sel") {
  field(DESC, "EVR OTP23  event timestamping enable")
  field(MASK, "1")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(FLNK, "$(P)$(R)OTP23LogCalc")
}

record(bo, "$(P)$(R)OTP23Intlk-Sel") {
  field(DESC, "EVR OTP23 interlock function selection")
  field(MASK, "1")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(FLNK, "$(P)$(R)OTP23IntlkCalc")
}

record(calcout, "$(P)$(R)OTP23StateCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP23  set enable calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OTP23State-Sel.RVAL")
  field(INPB, "$(P)$(R)OTP23Polarity-Sts.VAL")
  field(INPC, "$(P)$(R)OTP23Log-Sts.VAL")
  field(INPD, "$(P)$(R)OTP23Intlk-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
  field(OUT, "@timing.proto evre_otp_en_pol_time_itl_set($(P),$(R),23,State) $(PORT)")
  field(FLNK, "$(P)$(R)OTP23DelayCalc")
}

record(calcout, "$(P)$(R)OTP23PolCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP23  set polarity calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OTP23State-Sts.VAL")
  field(INPB, "$(P)$(R)OTP23Polarity-Sel.RVAL")
  field(INPC, "$(P)$(R)OTP23Log-Sts.VAL")
  field(INPD, "$(P)$(R)OTP23Intlk-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
  field(OUT, "@timing.proto evre_otp_en_pol_time_itl_set($(P),$(R),23,Pol) $(PORT)")
  field(FLNK, "$(P)$(R)OTP23DelayCalc")
}

record(calcout, "$(P)$(R)OTP23LogCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP23  set timestamping calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OTP23State-Sts.VAL")
  field(INPB, "$(P)$(R)OTP23Polarity-Sts.VAL")
  field(INPC, "$(P)$(R)OTP23Log-Sel.RVAL")
  field(INPD, "$(P)$(R)OTP23Intlk-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
  field(OUT, "@timing.proto evre_otp_en_pol_time_itl_set($(P),$(R),23,Log) $(PORT)")
  field(FLNK, "$(P)$(R)OTP23DelayCalc")
}

record(calcout, "$(P)$(R)OTP23IntlkCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP23  set interlock calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)OTP23State-Sts.VAL")
  field(INPB, "$(P)$(R)OTP23Polarity-Sts.VAL")
  field(INPC, "$(P)$(R)OTP23Log-Sts.VAL")
  field(INPD, "$(P)$(R)OTP23Intlk-Sel.RVAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
  field(OUT, "@timing.proto evre_otp_en_pol_time_itl_set($(P),$(R),23,Intlk) $(PORT)")
  field(FLNK, "$(P)$(R)OTP23DelayCalc")
}

record(calcout, "$(P)$(R)OTP23DelayCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP23  download EN, POL, and TIME")
  field(INPA, "$(P)$(R)OTP23State-Sel.RVAL")
  field(INPB, "$(P)$(R)OTP23Polarity-Sel.RVAL")
  field(INPC, "$(P)$(R)OTP23Log-Sel.RVAL")
  field(INPD, "$(P)$(R)OTP23Intlk-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)|(D<<4)")
}

record(mbbiDirect, "$(P)$(R)OTP23DelayRaw") {
  field(ASG, "Reserved")
  field(DESC, "OTP23  enable, pol, timelog and intlk RBV")
  field(NOBT, "8")
  field(SCAN, "I/O Intr")
  field(DTYP, "stream")
  field(INP, "@timing.proto evre_otp_enpoltimeNRBV_intr $(PORT)")
  field(FLNK, "$(P)$(R)OTP23Intlk-Sts")
}

record(bi, "$(P)$(R)OTP23Intlk-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP23 interlock status")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(INP, "$(P)$(R)OTP23DelayRaw.B4")
  field(FLNK, "$(P)$(R)OTP23Log-Sts")
}

record(bi, "$(P)$(R)OTP23Log-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP23  timestamping status")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(INP, "$(P)$(R)OTP23DelayRaw.B5")
  field(FLNK, "$(P)$(R)OTP23Polarity-Sts")
}

record(bi, "$(P)$(R)OTP23Polarity-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP23  polarity status")
  field(ZNAM, "Normal")
  field(ONAM, "Inverse")
  field(INP, "$(P)$(R)OTP23DelayRaw.B6")
  field(FLNK, "$(P)$(R)OTP23State-Sts")
}

record(bi, "$(P)$(R)OTP23State-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP23  enable status")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(INP, "$(P)$(R)OTP23DelayRaw.B7")
}

record(longin, "$(P)$(R)OTP23NrPulses-RB"){
  field(ASG, "Reserved")
  field(DESC, "EVR OTP23  number of pulses RBV")
  field(EGU, "pulses")
}

record(longin, "$(P)$(R)OTP23Evt-RB") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP23  event RBV")
}

record(longin, "$(P)$(R)OTP23Width-RB") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP23 width RBV")
  field(EGU, "evt_T")
  field(FLNK, "$(P)$(R)OTP23WidthTime-RB")
}

record(longin, "$(P)$(R)OTP23Delay-RB") {
  field(ASG, "Reserved")
  field(DESC, "EVR OTP23 delay RBV")
  field(EGU, "evt_T")
  field(FLNK, "$(P)$(R)OTP23DelayTime-RB")
}

record(calc, "$(P)$(R)OTP23WidthTime-RB") {
  field(INPA, "$(P)$(R)OTP23Width-RB")
  field(INPB, "$(P)TI-EVG:FPGAClk-Cte")
  field(PREC, "3")
  field(DESC, "EVR OTP23 width time RBV")
  field(EGU, "us")
  field(CALC, "A*B*1000000")
}

record(calc, "$(P)$(R)OTP23DelayTime-RB") {
  field(INPA, "$(P)$(R)OTP23Delay-RB")
  field(INPB, "$(P)TI-EVG:FPGAClk-Cte")
  field(PREC, "3")
  field(DESC, "EVR OTP23 delay time RBV")
  field(EGU, "us")
  field(CALC, "A*B*1000000")
}

record(longout, "$(P)$(R)cmd_otp_set23") {
  field(ASG, "Reserved")
  field(DESC, "Command code to write to OTP23")
  field(VAL, "0x60") # (0x40 | reg number=32)
}

record(longout, "$(P)$(R)cmd_otp_get23") {
  field(ASG, "Reserved")
  field(DESC, "Command code to read OTP23")
  field(VAL, "0xA0") # (0x80 | reg number=32)
}

########################################################################
# Timestamp register [51]

record(mbbo, "$(P)$(R)TimestampSrc-Sel"){
  field(DESC, "EVR timestamp signal source")	
  field(ZRST, "IDLE")
  field(ZRVL, "0")
  field(ONST, "DBUS")
  field(ONVL, "1")
  field(TWST, "EVENT")
  field(TWVL, "2")
  field(THST, "INTERNAL")
  field(THVL, "3")
  field(VAL, "0")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_tmstmp_set($(P),$(R)) $(PORT)")
}

record(longin, "$(P)$(R)UTC-RB"){
  field(ASG, "Reserved")
  field(DESC, "EVR timestamp UTC field RBV")
  field(EGU, "seconds")
}

record(longin, "$(P)$(R)SubSecond-Mon"){
  field(ASG, "Reserved")
  field(DESC, "EVR timestamp subsecond field RBV")
  field(EGU, "evt_T")
}

record(mbbi, "$(P)$(R)TimestampSrc-Sts"){
  field(ASG, "Reserved")
  field(DESC, "EVR timestamp signal source RBV")	
  field(ZRST, "IDLE")
  field(ZRVL, "0")
  field(ONST, "DBUS")
  field(ONVL, "1")
  field(TWST, "EVENT")
  field(TWVL, "2")
  field(THST, "INTERNAL")
  field(THVL, "3")
  field(SCAN, "I/O Intr")
  field(DTYP, "stream")
  field(INP, "@timing.proto evre_tmstmp_timesrcRBV_intr $(PORT)")
}

record(longout, "$(P)$(R)cmd_tmstmp_get"){
  field(ASG, "Reserved")
  field(DESC, "Command code to read timestamp reg")
  field(VAL, "0xB3")
  field(SCAN, "1 second")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_tmstmp_get($(P),$(R)) $(PORT)")
}

record(longout, "$(P)$(R)cmd_tmstmp_set"){
  field(ASG, "Reserved")
  field(DESC, "Command code to write to timestamp reg")
  field(VAL, "0x73")
}

########################################################################
# Timestamp log register [52]

record(bo, "$(P)$(R)stoplog"){
  field(DESC, "EVR stop log command")
  field(MASK, "1")
  field(ONAM, "Enbl")
  field(ZNAM, "Dsbl")
  field(FLNK, "$(P)$(R)stoplogAUX")
}

# initialization by @init
record(calcout, "$(P)$(R)stoplogAUX"){
  field(ASG, "Reserved")
  field(DESC, "Auxiliar var for stoplog")
  field(INPA, "$(P)$(R)stoplog.RVAL")
  field(CALC, "A << 7")
  field(FLNK, "$(P)$(R)STOPLOG")
}

record(bo, "$(P)$(R)rstlog"){
  field(DESC, "EVR reset log command")
  field(MASK, "1")
  field(ONAM, "Enbl")
  field(ZNAM, "Dsbl")
  field(HIGH, "0.5")
  field(FLNK, "$(P)$(R)RSTLOG")
}

record(bo, "$(P)$(R)pull"){
  field(DESC, "EVR pull from log command")
  field(MASK, "1")
  field(ONAM, "PULL")
  field(ZNAM, "DO NOTHING")
  field(FLNK, "$(P)$(R)checkPull")
}

record(calcout, "$(P)$(R)checkPull"){
  field(ASG, "Reserved")
  field(DESC, "Validate pull action")
  field(INPA, "$(P)$(R)EMPTY")
  field(INPB, "$(P)$(R)pull.RVAL")
  field(CALC, "(A = 0) && !(B = 0)")
  field(OOPT, "When Non-zero")
  field(OUT, "$(P)$(R)PULL.PROC")
}

record(calcout, "$(P)$(R)STOPLOG") {
  field(ASG, "Reserved")
  field(DESC, "EVR set stop log calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)stoplog.VAL")
  field(INPB, "$(P)$(R)RSTLOGRBV.VAL")
  field(CALC, "(A<<7)|(B<<6)")
  field(OUT, "@timing.proto evre_log_set($(P),$(R),STOPLOG) $(PORT)")
  field(FLNK, "$(P)$(R)onlyRead")
}

record(calcout, "$(P)$(R)RSTLOG") {
  field(ASG, "Reserved")
  field(DESC, "EVR set reset log calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)stoplogAUX.VAL")
  field(INPB, "$(P)$(R)rstlog.RVAL")
  field(CALC, "(A & 128)|(B<<6)")
  field(OUT, "@timing.proto evre_log_set($(P),$(R),RSTLOG) $(PORT)")
  field(FLNK, "$(P)$(R)onlyRead")
}

record(calcout, "$(P)$(R)PULL") {
  field(ASG, "Reserved")
  field(DESC, "EVR set pull log calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)stoplogAUX.VAL")
  field(INPB, "$(P)$(R)RSTLOGRBV.VAL")
  field(INPC, "$(P)$(R)pull.RVAL")
  field(CALC, "(A & 128)|(B<<6)|(C<<5)")
  field(OUT, "@timing.proto evre_log_set($(P),$(R),PULL) $(PORT)")
  field(PRIO, "HIGH")
  field(FLNK, "$(P)$(R)readAndUpdate")
}

record(calcout, "$(P)$(R)LOGCTRL") {
  field(ASG, "Reserved")
  field(DESC, "EVR download stop, reset, and pull")
  field(INPA, "$(P)$(R)stoplog.VAL")
  field(INPB, "$(P)$(R)rstlog.RVAL")
  field(INPC, "$(P)$(R)pull.RVAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)")
}

record(longin, "$(P)$(R)LOGCOUNT"){
  field(ASG, "Reserved")
  field(DESC, "EVR number of timestamps in the buffer")
  field(EGU, "timestamps")
}

record(mbbiDirect, "$(P)$(R)LOGCTRLRBV"){
  field(ASG, "Reserved")
  field(DESC, "EVR timestamp log control RBV")
  field(NOBT, "8")
  field(SCAN, "I/O Intr")
  field(DTYP, "stream")
  field(INP, "@timing.proto evre_log_ctrlRBV_intr $(PORT)")
  field(FLNK, "$(P)$(R)STOPLOGRBV")
}

record(bi, "$(P)$(R)STOPLOGRBV"){
  field(ASG, "Reserved")
  field(ONAM, "Enbl")
  field(ZNAM, "Dsbl")
  field(DESC, "EVR stop log command RBV")
  field(INP, "$(P)$(R)LOGCTRLRBV.B7")
  field(FLNK, "$(P)$(R)RSTLOGRBV")
}

record(bi, "$(P)$(R)RSTLOGRBV"){
  field(ASG, "Reserved")
  field(ONAM, "Enbl")
  field(ZNAM, "Dsbl")
  field(DESC, "EVR reset log command RBV")
  field(INP, "$(P)$(R)LOGCTRLRBV.B6")
  field(FLNK, "$(P)$(R)FULL")
}

record(bi, "$(P)$(R)FULL"){
  field(ASG, "Reserved")
  field(ONAM, "YES")
  field(ZNAM, "NO")
  field(DESC, "EVR timestamp buffer full flag")
  field(INP, "$(P)$(R)LOGCTRLRBV.B1")
  field(FLNK, "$(P)$(R)EMPTY")
}

record(bi, "$(P)$(R)EMPTY"){
  field(ASG, "Reserved")
  field(ONAM, "YES")
  field(ZNAM, "NO")
  field(DESC, "EVR timestamp buffer empty flag")
  field(INP, "$(P)$(R)LOGCTRLRBV.B0")
}

record(longin, "$(P)$(R)LOGUTC"){
  field(ASG, "Reserved")
  field(DESC, "EVR UTC timestamp pulled from log")
  field(EGU, "seconds")
}

record(longin, "$(P)$(R)LOGSUBSEC"){
  field(ASG, "Reserved")
  field(DESC, "EVR subsecond timestamp pulled from log")
  field(EGU, "evt_T")
}

record(longin, "$(P)$(R)LOGEVENT"){
  field(ASG, "Reserved")
  field(DESC, "EVR timestamp event pulled from log")
}

record(longout, "$(P)$(R)onlyRead"){
  field(ASG, "Reserved")
  field(DESC, "Read timestamp and don't update buffers")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_log_get($(P),$(R)) $(PORT)")
  field(FLNK, "$(P)$(R)LOGCTRL")
}

record(longout, "$(P)$(R)readAndUpdate"){
  field(ASG, "Reserved")
  field(DESC, "Read register and update buffers")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_log_get($(P),$(R)) $(PORT)")
  field(PRIO, "HIGH")
  field(FLNK, "$(P)$(R)UTCbuffer")
}

record(compress, "$(P)$(R)UTCbuffer"){
  field(ASG, "Reserved")
  field(DESC, "UTC circular buffer")
  field(EGU, "seconds")
  field(ALG, "Circular Buffer")
  field(NSAM, "1000")
  field(INP, "$(P)$(R)LOGUTC")
  field(FLNK, "$(P)$(R)SUBSECbuffer")
}

record(compress, "$(P)$(R)SUBSECbuffer"){
  field(ASG, "Reserved")
  field(DESC, "SUBSEC circular buffer")
  field(EGU, "evt_T")
  field(ALG, "Circular Buffer")
  field(NSAM, "1000")
  field(INP, "$(P)$(R)LOGSUBSEC")
  field(FLNK, "$(P)$(R)EVENTbuffer")
}

record(compress, "$(P)$(R)EVENTbuffer"){
  field(ASG, "Reserved")
  field(DESC, "Event circular buffer")
  field(ALG, "Circular Buffer")
  field(NSAM, "1000")
  field(INP, "$(P)$(R)LOGEVENT")
  field(FLNK, "$(P)$(R)LOGSOFTCNT")
}

record(calc, "$(P)$(R)LOGSOFTCNT"){
  field(ASG, "Reserved")
  field(DESC, "Software fresh data buffer counter")
  field(EGU, "timestamps")
  field(CALC, "VAL + 1")
  field(FLNK, "$(P)$(R)pullAgain")
}

record(calcout, "$(P)$(R)pullAgain"){
  field(ASG, "Reserved")
  field(DESC, "Pull again decision calc")
  field(INPA, "$(P)$(R)whileNotEmpty.VAL")
  field(CALC, "A")
  field(OOPT, "When Non-zero")
  field(OUT, "$(P)$(R)whileNotEmpty.PROC")
  field(FLNK, "$(P)$(R)LOGCTRL")
}

record(calcout, "$(P)$(R)PeriodicPull"){
  field(ASG, "Reserved")
  field(DESC, "Periodic pull of timestamps")
  field(SCAN, "2 second")
  field(INPA, "$(P)$(R)whileNotEmpty.VAL")
  field(INPB, "$(P)$(R)EMPTY")
  field(CALC, "(A = 0) && (B = 0)")
  field(VAL, "0")
  field(OOPT, "When Non-zero")
  field(OUT, "$(P)$(R)whileNotEmpty.PROC")
}

record(calcout, "$(P)$(R)whileNotEmpty"){
  field(ASG, "Reserved")
  field(DESC, "Flag: pull while buffer is not empty")
  field(INPA, "$(P)$(R)EMPTY")
  field(CALC, "A = 0")
  field(VAL, "0")
  field(OUT, "$(P)$(R)pull PP")
}

record(bo, "$(P)$(R)rstSoftBuff"){
  field(DESC, "Reset software buffers")
  field(MASK, "1")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(HIGH, "1")
  field(FLNK, "$(P)$(R)rstSoftBuffCalc")
}

record(calcout, "$(P)$(R)rstSoftBuffCalc"){
  field(ASG, "Reserved")
  field(DESC, "Reset software buffers calc")
  field(INPA, "$(P)$(R)rstSoftBuff.RVAL")
  field(CALC, "A")
  field(OOPT, "When Non-zero")
  field(OUT, "$(P)$(R)rstSoftBuffSeq.PROC")
}

record(sseq, "$(P)$(R)rstSoftBuffSeq"){
  field(ASG, "Reserved")
  field(DESC, "Reset software buffers sequence")
  field(SELM, "All")
  field(DO1, "1")
  field(DO2, "1")
  field(DO3, "1")
  field(DO4, "0")
  field(DO5, "1")
  field(DO6, "1")
  field(DO7, "1")
  field(LNK1, "$(P)$(R)UTCbuffer.RES PP")	# Reset and process UTC buffer. It will pull a -1 when processed.
  field(LNK2, "$(P)$(R)SUBSECbuffer.RES PP")	# Reset and process SUBSEC buffer. It will pull a -1 when processed.
  field(LNK3, "$(P)$(R)EVENTbuffer.RES PP")	# Reset and process EVENT buffer. It will pull a -1 when processed.
  field(LNK4, "$(P)$(R)LOGSOFTCNT")		# Zero soft log count
  field(LNK5, "$(P)$(R)UTCbuffer.RES")	# Reset buffer again, and do not process, to remove -1.
  field(LNK6, "$(P)$(R)SUBSECbuffer.RES")	# Reset buffer again, and do not process, to remove -1.
  field(LNK7, "$(P)$(R)EVENTbuffer.RES")	# Reset buffer again, and do not process, to remove -1.
  field(WAIT1, "Wait")
  field(WAIT2, "Wait")
  field(WAIT3, "Wait")
  field(WAIT4, "Wait")
  field(WAIT5, "Wait")
  field(Wait6, "Wait")
}

record(longout, "$(P)$(R)cmd_log_get"){
  field(ASG, "Reserved")
  field(DESC, "Timestamp log reg read command code")
  field(VAL, "0xB4")
  field(SCAN, "1 second")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_log_get($(P),$(R)) $(PORT)")
}

record(longout, "$(P)$(R)cmd_log_set"){
  field(ASG, "Reserved")
  field(DESC, "Timestamp log reg write command code")
  field(VAL, "0x74")
}

########################################################################
# Digital input 0 [53]

record(longout, "$(P)$(R)DIEvent0-SP") {
  field(DESC, "EVR digital input 0 event code")
  field(DRVH, "255")
  field(DRVL, "0")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evgre_diginp_ev_set($(P),$(R),0) $(PORT)")
}

record(bo, "$(P)$(R)DIEnbl0-Sel") {
  field(DESC, "EVR digital input 0 enable")
  field(MASK, "1")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(FLNK, "$(P)$(R)DIStateCalc0")
}

record(bo, "$(P)$(R)DIPol0-Sel") {
  field(DESC, "EVR digital input 0 polarity")
  field(MASK, "1")
  field(ZNAM, "Normal")
  field(ONAM, "Inverse")
  field(FLNK, "$(P)$(R)DIPolCalc0")
}

record(bo, "$(P)$(R)DILog0-Sel") {
  field(DESC, "EVR dig. input 0 event timestamp enable")
  field(MASK, "1")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(FLNK, "$(P)$(R)DILogCalc0")
}

record(calcout, "$(P)$(R)DIStateCalc0") {
  field(ASG, "Reserved")
  field(DESC, "EVR digital input 0 set enable calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)DIEnbl0-Sel.RVAL")
  field(INPB, "$(P)$(R)DIPol0-Sts.VAL")
  field(INPC, "$(P)$(R)DILog0-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)")
  field(OUT, "@timing.proto evgre_diginp_ept_set($(P),$(R),0,DIStateCalc) $(PORT)")
  field(FLNK, "$(P)$(R)DI0Calc")
}

record(calcout, "$(P)$(R)DIPolCalc0") {
  field(ASG, "Reserved")
  field(DESC, "EVR digital input 0 set polarity calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)DIEnbl0-Sts.VAL")
  field(INPB, "$(P)$(R)DIPol0-Sel.RVAL")
  field(INPC, "$(P)$(R)DILog0-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)")
  field(OUT, "@timing.proto evgre_diginp_ept_set($(P),$(R),0,DIPolCalc) $(PORT)")
  field(FLNK, "$(P)$(R)DI0Calc")
}

record(calcout, "$(P)$(R)DILogCalc0") {
  field(ASG, "Reserved")
  field(DESC, "EVR digital input 0 set timestamp calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)DIEnbl0-Sts.VAL")
  field(INPB, "$(P)$(R)DIPol0-Sts.VAL")
  field(INPC, "$(P)$(R)DILog0-Sel.RVAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)")
  field(OUT, "@timing.proto evgre_diginp_ept_set($(P),$(R),0,DILogCalc) $(PORT)")
  field(FLNK, "$(P)$(R)DI0Calc")
}

record(calcout, "$(P)$(R)DI0Calc") {
  field(ASG, "Reserved")
  field(DESC, "EVR dig.inp. 0 download en, pol and time")
  field(INPA, "$(P)$(R)DIEnbl0-Sel.RVAL")
  field(INPB, "$(P)$(R)DIPol0-Sel.RVAL")
  field(INPC, "$(P)$(R)DILog0-Sel.RVAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)")
}

record(mbbiDirect, "$(P)$(R)DI0Raw") {
  field(ASG, "Reserved")
  field(DESC, "DIGINP0 en, pol, and timestamp RBV")
  field(NOBT, "8")
  field(SHFT, "5")
  field(SCAN, "I/O Intr")
  field(DTYP, "stream")
  field(INP, "@timing.proto evgre_diginp0_intr $(PORT)")
  field(FLNK, "$(P)$(R)DILog0-Sts")
}

record(bi, "$(P)$(R)DILog0-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR digital input 0 timestamping sts")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(INP, "$(P)$(R)DI0Raw.B0")
  field(FLNK, "$(P)$(R)DIPol0-Sts")
}

record(bi, "$(P)$(R)DIPol0-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR digital input 0 polarity status")
  field(ZNAM, "Normal")
  field(ONAM, "Inverse")
  field(INP, "$(P)$(R)DI0Raw.B1")
  field(FLNK, "$(P)$(R)DIEnbl0-Sts")
}

record(bi, "$(P)$(R)DIEnbl0-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR digital input 0 enable status")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(INP, "$(P)$(R)DI0Raw.B2")
}

record(longin, "$(P)$(R)DIEvent0-RB") {
  field(ASG, "Reserved")
  field(DESC, "EVR digital input 0 event RBV")
}

record(longout, "$(P)$(R)cmd_diginp_set0") {
  field(ASG, "Reserved")
  field(DESC, "Command code to write to DIGINP0")
  field(VAL, "0x75") # (0x40 | reg number=1)
}

record(longout, "$(P)$(R)cmd_diginp_get0") {
  field(ASG, "Reserved")
  field(DESC, "Command code to read DIGINP0")
  field(VAL, "0xB5") # (0x80 | reg number=1)
}

########################################################################
# Digital input 1 [54]

record(longout, "$(P)$(R)DIEvent1-SP") {
  field(DESC, "EVR digital input 1 event code")
  field(DRVH, "255")
  field(DRVL, "0")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evgre_diginp_ev_set($(P),$(R),1) $(PORT)")
}

record(bo, "$(P)$(R)DIEnbl1-Sel") {
  field(DESC, "EVR digital input 1 enable")
  field(MASK, "1")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(FLNK, "$(P)$(R)DIStateCalc1")
}

record(bo, "$(P)$(R)DIPol1-Sel") {
  field(DESC, "EVR digital input 1 polarity")
  field(MASK, "1")
  field(ZNAM, "Normal")
  field(ONAM, "Inverse")
  field(FLNK, "$(P)$(R)DIPolCalc1")
}

record(bo, "$(P)$(R)DILog1-Sel") {
  field(DESC, "EVR dig. input 1 event timestamp enable")
  field(MASK, "1")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(FLNK, "$(P)$(R)DILogCalc1")
}

record(calcout, "$(P)$(R)DIStateCalc1") {
  field(ASG, "Reserved")
  field(DESC, "EVR digital input 1 set enable calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)DIEnbl1-Sel.RVAL")
  field(INPB, "$(P)$(R)DIPol1-Sts.VAL")
  field(INPC, "$(P)$(R)DILog1-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)")
  field(OUT, "@timing.proto evgre_diginp_ept_set($(P),$(R),1,DIStateCalc) $(PORT)")
  field(FLNK, "$(P)$(R)DI1Calc")
}

record(calcout, "$(P)$(R)DIPolCalc1") {
  field(ASG, "Reserved")
  field(DESC, "EVR digital input 1 set polarity calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)DIEnbl1-Sts.VAL")
  field(INPB, "$(P)$(R)DIPol1-Sel.RVAL")
  field(INPC, "$(P)$(R)DILog1-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)")
  field(OUT, "@timing.proto evgre_diginp_ept_set($(P),$(R),1,DIPolCalc) $(PORT)")
  field(FLNK, "$(P)$(R)DI1Calc")
}

record(calcout, "$(P)$(R)DILogCalc1") {
  field(ASG, "Reserved")
  field(DESC, "EVR digital input 1 set timestamp calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)DIEnbl1-Sts.VAL")
  field(INPB, "$(P)$(R)DIPol1-Sts.VAL")
  field(INPC, "$(P)$(R)DILog1-Sel.RVAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)")
  field(OUT, "@timing.proto evgre_diginp_ept_set($(P),$(R),1,DILogCalc) $(PORT)")
  field(FLNK, "$(P)$(R)DI1Calc")
}

record(calcout, "$(P)$(R)DI1Calc") {
  field(ASG, "Reserved")
  field(DESC, "EVR dig.inp. 1 download en, pol and time")
  field(INPA, "$(P)$(R)DIEnbl1-Sel.RVAL")
  field(INPB, "$(P)$(R)DIPol1-Sel.RVAL")
  field(INPC, "$(P)$(R)DILog1-Sel.RVAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)")
}

record(mbbiDirect, "$(P)$(R)DI1Raw") {
  field(ASG, "Reserved")
  field(DESC, "DIGINP1 en, pol, and timestamp RBV")
  field(NOBT, "8")
  field(SHFT, "5")
  field(SCAN, "I/O Intr")
  field(DTYP, "stream")
  field(INP, "@timing.proto evgre_diginp1_intr $(PORT)")
  field(FLNK, "$(P)$(R)DILog1-Sts")
}

record(bi, "$(P)$(R)DILog1-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR digital input 1 timestamping sts")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(INP, "$(P)$(R)DI1Raw.B0")
  field(FLNK, "$(P)$(R)DIPol1-Sts")
}

record(bi, "$(P)$(R)DIPol1-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR digital input 1 polarity status")
  field(ZNAM, "Normal")
  field(ONAM, "Inverse")
  field(INP, "$(P)$(R)DI1Raw.B1")
  field(FLNK, "$(P)$(R)DIEnbl1-Sts")
}

record(bi, "$(P)$(R)DIEnbl1-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR digital input 1 enable status")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(INP, "$(P)$(R)DI1Raw.B2")
}

record(longin, "$(P)$(R)DIEvent1-RB") {
  field(ASG, "Reserved")
  field(DESC, "EVR digital input 1 event RBV")
}

record(longout, "$(P)$(R)cmd_diginp_set1") {
  field(ASG, "Reserved")
  field(DESC, "Command code to write to DIGINP1")
  field(VAL, "0x76") # (0x40 | reg number=1)
}

record(longout, "$(P)$(R)cmd_diginp_get1") {
  field(ASG, "Reserved")
  field(DESC, "Command code to read DIGINP1")
  field(VAL, "0xB6") # (0x80 | reg number=1)
}

########################################################################
# Digital input 2 [55]

record(longout, "$(P)$(R)DIEvent2-SP") {
  field(DESC, "EVR digital input 2 event code")
  field(DRVH, "255")
  field(DRVL, "0")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evgre_diginp_ev_set($(P),$(R),2) $(PORT)")
}

record(bo, "$(P)$(R)DIEnbl2-Sel") {
  field(DESC, "EVR digital input 2 enable")
  field(MASK, "1")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(FLNK, "$(P)$(R)DIStateCalc2")
}

record(bo, "$(P)$(R)DIPol2-Sel") {
  field(DESC, "EVR digital input 2 polarity")
  field(MASK, "1")
  field(ZNAM, "Normal")
  field(ONAM, "Inverse")
  field(FLNK, "$(P)$(R)DIPolCalc2")
}

record(bo, "$(P)$(R)DILog2-Sel") {
  field(DESC, "EVR dig. input 2 event timestamp enable")
  field(MASK, "1")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(FLNK, "$(P)$(R)DILogCalc2")
}

record(calcout, "$(P)$(R)DIStateCalc2") {
  field(ASG, "Reserved")
  field(DESC, "EVR digital input 2 set enable calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)DIEnbl2-Sel.RVAL")
  field(INPB, "$(P)$(R)DIPol2-Sts.VAL")
  field(INPC, "$(P)$(R)DILog2-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)")
  field(OUT, "@timing.proto evgre_diginp_ept_set($(P),$(R),2,DIStateCalc) $(PORT)")
  field(FLNK, "$(P)$(R)DI2Calc")
}

record(calcout, "$(P)$(R)DIPolCalc2") {
  field(ASG, "Reserved")
  field(DESC, "EVR digital input 2 set polarity calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)DIEnbl2-Sts.VAL")
  field(INPB, "$(P)$(R)DIPol2-Sel.RVAL")
  field(INPC, "$(P)$(R)DILog2-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)")
  field(OUT, "@timing.proto evgre_diginp_ept_set($(P),$(R),2,DIPolCalc) $(PORT)")
  field(FLNK, "$(P)$(R)DI2Calc")
}

record(calcout, "$(P)$(R)DILogCalc2") {
  field(ASG, "Reserved")
  field(DESC, "EVR digital input 2 set timestamp calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)DIEnbl2-Sts.VAL")
  field(INPB, "$(P)$(R)DIPol2-Sts.VAL")
  field(INPC, "$(P)$(R)DILog2-Sel.RVAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)")
  field(OUT, "@timing.proto evgre_diginp_ept_set($(P),$(R),2,DILogCalc) $(PORT)")
  field(FLNK, "$(P)$(R)DI2Calc")
}

record(calcout, "$(P)$(R)DI2Calc") {
  field(ASG, "Reserved")
  field(DESC, "EVR dig.inp. 2 download en, pol and time")
  field(INPA, "$(P)$(R)DIEnbl2-Sel.RVAL")
  field(INPB, "$(P)$(R)DIPol2-Sel.RVAL")
  field(INPC, "$(P)$(R)DILog2-Sel.RVAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)")
}

record(mbbiDirect, "$(P)$(R)DI2Raw") {
  field(ASG, "Reserved")
  field(DESC, "DIGINP2 en, pol, and timestamp RBV")
  field(NOBT, "8")
  field(SHFT, "5")
  field(SCAN, "I/O Intr")
  field(DTYP, "stream")
  field(INP, "@timing.proto evgre_diginp2_intr $(PORT)")
  field(FLNK, "$(P)$(R)DILog2-Sts")
}

record(bi, "$(P)$(R)DILog2-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR digital input 2 timestamping sts")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(INP, "$(P)$(R)DI2Raw.B0")
  field(FLNK, "$(P)$(R)DIPol2-Sts")
}

record(bi, "$(P)$(R)DIPol2-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR digital input 2 polarity status")
  field(ZNAM, "Normal")
  field(ONAM, "Inverse")
  field(INP, "$(P)$(R)DI2Raw.B1")
  field(FLNK, "$(P)$(R)DIEnbl2-Sts")
}

record(bi, "$(P)$(R)DIEnbl2-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR digital input 2 enable status")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(INP, "$(P)$(R)DI2Raw.B2")
}

record(longin, "$(P)$(R)DIEvent2-RB") {
  field(ASG, "Reserved")
  field(DESC, "EVR digital input 2 event RBV")
}

record(longout, "$(P)$(R)cmd_diginp_set2") {
  field(ASG, "Reserved")
  field(DESC, "Command code to write to DIGINP2")
  field(VAL, "0x77") # (0x40 | reg number=1)
}

record(longout, "$(P)$(R)cmd_diginp_get2") {
  field(ASG, "Reserved")
  field(DESC, "Command code to read DIGINP2")
  field(VAL, "0xB7") # (0x80 | reg number=1)
}

########################################################################
# Firmware Version [62]

record(longin, "$(P)$(R)FrmVersionA-Cte"){
  #field(ASG, "Reserved")
  field(DESC, "EVO firmware version")
  field(DTYP, "stream")
  field(INP, "@timing.proto frmvrs_get($(P),$(R)) $(PORT)")
}

record(longin, "$(P)$(R)FrmVersionB-Cte"){
  #field(ASG, "Reserved")
  field(DESC, "EVO firmware version")
  field(DTYP, "stream")
  field(INP, "@timing.proto frmvrs_get($(P),$(R)) $(PORT)")
}

record(longin, "$(P)$(R)FrmVersionC-Cte"){
  #field(ASG, "Reserved")
  field(DESC, "EVO firmware version")
  field(DTYP, "stream")
  field(INP, "@timing.proto frmvrs_get($(P),$(R)) $(PORT)")
}

record(calcout, "$(P)$(R)cmd_frmvrs_get"){
  field(ASG, "Reserved")
  field(DESC, "Firmware version read command code")
  field(VAL, "0xBE")
}

########################################################################
# Configuration Register [63]

record(longin, "$(P)$(R)Alive-Mon") {
  field(ASG, "Reserved")
  field(DESC, "EVR alive")
  field(SCAN, "I/O Intr")
  field(DTYP, "stream")
  field(INP, "@timing.proto evre_conf_alive_intr $(PORT)")
  field(FLNK, "$(P)$(R)DevStatusCalc")
}

record(mbbi, "$(P)$(R)ClkMode-RB") {
  field(ASG, "Reserved")
  field(DESC, "EVR clock mode status")
  field(NOBT, "6")
  field(ZRVL, "11")
  field(ZRST, "60-62.5 MHz")
  field(ONVL, "12")
  field(ONST, "63-77 MHz")
  field(TWVL, "13")
  field(TWST, "77.5-91.5 MHz")
  field(THVL, "14")
  field(THST, "92-106 MHz")
  field(FRVL, "15")
  field(FRST, "106-120.5 MHz")
  field(FVVL, "16")
  field(FVST, "121-135 MHz")
  field(SCAN, "I/O Intr")
  field(DTYP, "stream")
  field(INP, "@timing.proto evre_conf_clkmode_intr $(PORT)")
}

record(mbbi, "$(P)$(R)DevFun-Sts") {
  field(ASG, "Reserved")
  field(DESC, "EVR function select status")
  field(NOBT, "6")
  field(ZRVL, "16")
  field(ZRST, "FOUT")
  field(ONVL, "17")
  field(ONST, "EVR")
  field(TWVL, "18")
  field(TWST, "EVG")
  field(THVL, "32")
  field(THST, "EVE")
  field(SCAN, "I/O Intr")
  field(DTYP, "stream")
  field(INP, "@timing.proto evre_conf_funsel_intr $(PORT)")
}

record(mbbo, "$(P)$(R)DevFun-Sel") {
  field(DESC, "STD-EVO configuration as EVR")
  field(ZRVL, "16")
  field(ZRST, "FOUT")
  field(ONVL, "17")
  field(ONST, "EVR")
  field(TWVL, "18")
  field(TWST, "EVG")
  field(THVL, "32")
  field(THST, "EVE")
  field(DTYP, "stream")
  field(VAL, "1")
  field(OUT, "@timing.proto evr_conf_funsel_set($(P),$(R)) $(PORT)")
}

record(mbbo, "$(P)$(R)ClkMode-SP"){
  field(DESC, "EVE clock mode")
  field(ZRVL, "11")
  field(ZRST, "11")
  field(ONVL, "12")
  field(ONST, "12")
  field(TWVL, "13")
  field(TWST, "13")
  field(THVL, "14")
  field(THST, "15")
  field(FRVL, "15")
  field(FRST, "15")
  field(FVVL, "16")
  field(FVST, "16")
  field(VAL, "5")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evr_conf_clk_set($(P),$(R)) $(PORT)")
}

record(longout, "$(P)$(R)cmd_conf_get"){
  field(ASG, "Reserved")
  field(DESC, "Configuration reg read command code")
  field(VAL, "0xBF")
  field(DTYP, "stream")
  field(SCAN, "1 second")
  field(OUT, "@timing.proto evr_conf_get($(P),$(R)) $(PORT)")
}

record(longout, "$(P)$(R)cmd_conf_set") {
  field(ASG, "Reserved")
  field(DESC, "Configuration reg write command code")
  field(VAL, "0x7F")
}

########################################################################
# Write all configuration registers
record(bo, "$(P)$(R)Download-Cmd") {
  field(DESC, "EVR download")
  field(MASK, "1")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
}

record(bo, "$(P)$(R)Download-Trig") {
  field(DESC, "EVR download trigger")
  field(MASK, "1")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evr_download($(P),$(R)) $(PORT)")
}

record(bo, "$(P)$(R)Upload-Trig") {
  field(DESC, "EVR upload trigger")
  field(MASK, "1")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(HIGH, "0.5")
  field(FLNK, "$(P)$(R)UploadCalc")
}

record(calcout, "$(P)$(R)UploadCalc"){
  field(ASG, "Reserved")
  field(DESC, "EVR upload trigger calc")
  field(INPA, "$(P)$(R)Upload-Trig")
  field(CALC, "A")
  field(OOPT, "When Non-zero")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evr_upload($(P),$(R)) $(PORT)")
}

record(calc, "$(P)$(R)DevStatusCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVR device status calc")
  field(INPA, "$(P)$(R)Alive-Mon")
  field(CALC, "A=0?0:1")
  field(FLNK, "$(P)$(R)DevStatus-Mon")
}

record(bi, "$(P)$(R)DevStatus-Mon") {
  field(ASG, "Reserved")
  field(DESC, "EVR device status")
  field(ZNAM, "WAITING")
  field(ONAM, "RUNNING")
  field(INP, "$(P)$(R)DevStatusCalc")
}

record(bi, "$(P)$(R)Network-Mon") {
  field(ASG, "Reserved")
  field(DESC, "EVR network status")
  field(ZNAM, "Disconnected")
  field(ONAM, "Connected")
  field(FLNK, "$(P)$(R)FrmVersionA-Cte")
}

record(bo, "$(P)$(R)Save-Cmd"){
  field(DESC, "EVR manual Save settings command")
  field(MASK, "1")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(FLNK, "$(P)$(R)Save-Trig")
}

record(calc, "$(P)$(R)Save-Trig"){
  field(DESC, "EVR manual Save trigger")
  field(INPA, "$(P)$(R)Save-Cmd.VAL")
  field(CALC, "(A > 0) ? (VAL+1) : VAL")
  field(VAL, "0")
}
