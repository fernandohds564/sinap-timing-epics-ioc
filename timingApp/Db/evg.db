########################################################################
# Control and Status Register [0]

record(mbbiDirect, "$(P)$(R)seqen_enable") {
  field(ASG, "Reserved")
  field(DESC, "EVG seqen and enable status")
  field(NOBT, "8")
  field(SCAN, "I/O Intr")
  field(DTYP, "stream")
  field(INP, "@timing.proto evg_ctrl_seqen_enable_intr $(PORT)")
  field(FLNK, "$(P)$(R)enableRBV")
}

record(bi, "$(P)$(R)enableRBV") {
  field(ASG, "Reserved")
  field(DESC, "EVG enable status")
  field(ZNAM, "OFF")
  field(ONAM, "ON")
  field(INP, "$(P)$(R)seqen_enable.B0")
  field(FLNK, "$(P)$(R)seqenRBV")
}

record(bi, "$(P)$(R)seqenRBV") {
  field(ASG, "Reserved")
  field(DESC, "EVG SEQRAM enable status")
  field(ZNAM, "OFF")
  field(ONAM, "ON")
  field(INP, "$(P)$(R)seqen_enable.B1")
}

record(mbbiDirect, "$(P)$(R)seqstat_rfstat") {
  field(ASG, "Reserved")
  field(DESC, "EVG SEQRAM and RF input status")
  field(NOBT, "6")
  field(SHFT, "3")
  field(SCAN, "I/O Intr")
  field(DTYP, "stream")
  field(INP, "@timing.proto evg_ctrl_seqstat_rfstat_intr $(PORT)")
  field(FLNK, "$(P)$(R)rfstat")
}

record(bi, "$(P)$(R)rfstat") {
  field(ASG, "Reserved")
  field(DESC, "EVG RF input status")
  field(ZNAM, "LOSS OR OUT OF RANGE")
  field(ONAM, "NORMAL")
  field(INP, "$(P)$(R)seqstat_rfstat.B2")
  field(FLNK, "$(P)$(R)seqstatCalc")
}

record(mbbiDirect, "$(P)$(R)LOS") {
  field(DESC, "Downlink status in OUT0-OUT7 RAW")
  field(NOBT, "8")
  field(DTYP, "stream")
  field(SCAN, "I/O Intr")
  field(INP, "@timing.proto evg_ctrl_los_intr $(PORT)")
  #field(FLNK, "$(P)$(R)los0RBV")
}

record(calc, "$(P)$(R)seqstatCalc") {
  field(ASG, "Reserved")
  field(DESC, "EVG SEQRAM status calculation")
  field(INPA, "$(P)$(R)seqstat_rfstat")
  field(CALC, "A&3")
  field(FLNK, "$(P)$(R)seqstat")
}

record(mbbi, "$(P)$(R)seqstat") {
  field(ASG, "Reserved")
  field(DESC, "EVG SEQRAM status")
  field(INP, "$(P)$(R)seqstatCalc")
  field(ZRVL, "0")
  field(ZRST, "Stopped")
  field(ONVL, "1")
  field(ONST, "SEQRAM 1")
  field(TWVL, "2")
  field(TWST, "SEQRAM 2")
}

record(calcout, "$(P)$(R)SEQEN_ENABLE") {
  field(ASG, "Reserved")
  field(DESC, "EVG download SEQEN and ENABLE")
  field(PINI, "1")
  field(INPA, "$(P)$(R)seqen")
  field(INPB, "$(P)$(R)enable")
  field(CALC, "(A<<1)|B")
}

record(calcout, "$(P)$(R)SEQEN") {
  field(ASG, "Reserved")
  field(DESC, "EVG SEQRAM set enable calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)seqen")
  field(INPB, "$(P)$(R)enableRBV")
  field(CALC, "(A<<1)|B")
  field(OUT, "@timing.proto evg_ctrl_seq_en_set($(P),$(R),SEQEN) $(PORT)")
  field(FLNK, "$(P)$(R)SEQEN_ENABLE")
}

record(calcout, "$(P)$(R)EVGEN") {
  field(ASG, "Reserved")
  field(DESC, "EVG set enable calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)seqenRBV")
  field(INPB, "$(P)$(R)enable")
  field(CALC, "(A<<1)|B")
  field(OUT, "@timing.proto evg_ctrl_seq_en_set($(P),$(R),EVGEN) $(PORT)")
  field(FLNK, "$(P)$(R)SEQEN_ENABLE")
}

record(bo, "$(P)$(R)seqen"){
  field(DESC, "Enable/Disable Sequence RAM")
  field(ZNAM, "OFF")
  field(ONAM, "ON")
  field(FLNK, "$(P)$(R)SEQEN")
}

record(bo, "$(P)$(R)enable"){
  field(DESC, "Enable/Disable EVG")
  field(ZNAM, "OFF")
  field(ONAM, "ON")
  field(FLNK, "$(P)$(R)EVGEN")
}

record(longout, "$(P)$(R)cmd_ctrl_get") {
  field(ASG, "Reserved")
  field(DESC, "Control Status reg read command code")
  field(VAL, "0x80") # (0x80 | reg number)
  field(SCAN, ".5 second")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evg_ctrl_get($(P),$(R)) $(PORT)")
}

record(longout, "$(P)$(R)cmd_ctrl_set") {
  field(ASG, "Reserved")
  field(DESC, "Control Status reg write command code")
  field(VAL, "0x40")
}

########################################################################
# AC Line register [40]

record(bi, "$(P)$(R)acenRBV") {
  field(ASG, "Reserved")
  field(DESC, "EVG AC line input enable status")
  field(ZNAM, "OFF")
  field(ONAM, "ON")
}

record(longin, "$(P)$(R)acdivRAW") {
  field(ASG, "Reserved")
  field(DESC, "EVG AC line RAW frequency divider")
  field(SCAN, "I/O Intr")
  field(DTYP, "stream")
  field(INP, "@timing.proto evg_acline_acdivraw_intr $(PORT)")
  field(FLNK, "$(P)$(R)acdivRBV")
}

record(calc, "$(P)$(R)acdivRBV") {
  field(ASG, "Reserved")
  field(DESC, "EVG AC line frequency divider RBV")
  field(INPA, "$(P)$(R)acdivRAW")
  field(CALC, "A+1")
}

record(bo, "$(P)$(R)acen"){
  field(DESC, "Enable/Disable AC line input")
  field(DTYP, "stream")
  field(ZNAM, "OFF")
  field(ONAM, "ON")
  field(OUT, "@timing.proto evg_acline_acen_set($(P),$(R)) $(PORT)")
}

record(ao, "$(P)$(R)acdiv"){
  field(DESC, "EVG AC divider prescaler setting")
  field(DTYP, "stream")
  field(DRVH, "1073741824")
  field(DRVL, "1")
  field(AOFF, "1")
  field(PREC, "0")
  field(OUT, "@timing.proto evg_acline_acdiv_set($(P),$(R)) $(PORT)")
}

record(longout, "$(P)$(R)cmd_acline_get") {
  field(ASG, "Reserved")
  field(DESC, "AC Line reg read command code")
  field(VAL, "0xA8") # (0x80 | reg number=40)
}

record(longout, "$(P)$(R)cmd_acline_set") {
  field(ASG, "Reserved")
  field(DESC, "AC Line reg write command code")
  field(VAL, "0x68")
}

########################################################################
# Mux0 register [41]

record(bi, "$(P)$(R)muxen0RBV") {
  field(ASG, "Reserved")
  field(DESC, "EVG Mux0 enable status")
  field(ZNAM, "OFF")
  field(ONAM, "ON")
}

record(longin, "$(P)$(R)muxdiv0RAW") {
  field(ASG, "Reserved")
  field(DESC, "EVG Mux0 frequency divider RAW")
  field(SCAN, "I/O Intr")
  field(DTYP, "stream")
  field(INP, "@timing.proto evg_mux_div0RAW_intr $(PORT)")
  field(FLNK, "$(P)$(R)muxdiv0RBV")
}

record(calc, "$(P)$(R)muxdiv0RBV") {
  field(ASG, "Reserved")
  field(DESC, "EVG Mux0 frequency divider RBV")
  field(INPA, "$(P)$(R)muxdiv0RAW")
  field(CALC, "A+1")
}

record(bo, "$(P)$(R)muxen0"){
  field(DESC, "Enable/Disable MUX0")
  field(DTYP, "stream")
  field(ZNAM, "OFF")
  field(ONAM, "ON")
  field(OUT, "@timing.proto evg_mux_en_set($(P),$(R),0) $(PORT)")
}

record(ao, "$(P)$(R)muxdiv0"){
  field(DESC, "EVG MUX0 prescaler setting")
  field(DTYP, "stream")
  field(DRVH, "1073741824")
  field(DRVL, "1")
  field(AOFF, "1")
  field(PREC, "0")
  field(OUT, "@timing.proto evg_mux_div_set($(P),$(R),0) $(PORT)")
}

record(longout, "$(P)$(R)cmd_mux_get0") {
  field(ASG, "Reserved")
  field(DESC, "Command code to read Mux0 register")
  field(VAL, "0xA9") # (0x80 | reg number=41)
  #field(ASG, "Reserved")
}

record(longout, "$(P)$(R)cmd_mux_set0") {
  field(ASG, "Reserved")
  field(DESC, "Command code to write to Mux0 register")
  field(VAL, "0x69")
  #field(ASG, "Reserved")
}

########################################################################
# Mux1 register [42]

record(bi, "$(P)$(R)muxen1RBV") {
  field(ASG, "Reserved")
  field(DESC, "EVG Mux1 enable status")
  field(ZNAM, "OFF")
  field(ONAM, "ON")
}

record(longin, "$(P)$(R)muxdiv1RAW") {
  field(ASG, "Reserved")
  field(DESC, "EVG Mux1 frequency divider RAW")
  field(SCAN, "I/O Intr")
  field(DTYP, "stream")
  field(INP, "@timing.proto evg_mux_div1RAW_intr $(PORT)")
  field(FLNK, "$(P)$(R)muxdiv1RBV")
}

record(calc, "$(P)$(R)muxdiv1RBV") {
  field(ASG, "Reserved")
  field(DESC, "EVG Mux1 frequency divider RBV")
  field(INPA, "$(P)$(R)muxdiv1RAW")
  field(CALC, "A+1")
}

record(bo, "$(P)$(R)muxen1"){
  field(DESC, "Enable/Disable MUX1")
  field(DTYP, "stream")
  field(ZNAM, "OFF")
  field(ONAM, "ON")
  field(OUT, "@timing.proto evg_mux_en_set($(P),$(R),1) $(PORT)")
}

record(ao, "$(P)$(R)muxdiv1"){
  field(DESC, "EVG Mux1 prescaler setting")
  field(DTYP, "stream")
  field(DRVH, "1073741824")
  field(DRVL, "1")
  field(AOFF, "1")
  field(PREC, "0")
  field(OUT, "@timing.proto evg_mux_div_set($(P),$(R),1) $(PORT)")
}

record(longout, "$(P)$(R)cmd_mux_get1") {
  field(ASG, "Reserved")
  field(DESC, "Command code to read Mux1 register")
  field(VAL, "0xAA") # (0x80 | reg number=42)
}

record(longout, "$(P)$(R)cmd_mux_set1") {
  field(ASG, "Reserved")
  field(DESC, "Command code to write to Mux1 register")
  field(VAL, "0x6A")
}

########################################################################
# Mux2 register [43]

record(bi, "$(P)$(R)muxen2RBV") {
  field(ASG, "Reserved")
  field(DESC, "EVG Mux2 enable status")
  field(ZNAM, "OFF")
  field(ONAM, "ON")
}

record(longin, "$(P)$(R)muxdiv2RAW") {
  field(ASG, "Reserved")
  field(DESC, "EVG Mux2 frequency divider RAW")
  field(SCAN, "I/O Intr")
  field(DTYP, "stream")
  field(INP, "@timing.proto evg_mux_div2RAW_intr $(PORT)")
  field(FLNK, "$(P)$(R)muxdiv2RBV")
}

record(calc, "$(P)$(R)muxdiv2RBV") {
  field(ASG, "Reserved")
  field(DESC, "EVG Mux2 frequency divider RBV")
  field(INPA, "$(P)$(R)muxdiv2RAW")
  field(CALC, "A+1")
}

record(bo, "$(P)$(R)muxen2"){
  field(DESC, "Enable/Disable MUX2")
  field(DTYP, "stream")
  field(ZNAM, "OFF")
  field(ONAM, "ON")
  field(OUT, "@timing.proto evg_mux_en_set($(P),$(R),2) $(PORT)")
}

record(ao, "$(P)$(R)muxdiv2"){
  field(DESC, "EVG Mux2 prescaler setting")
  field(DTYP, "stream")
  field(DRVH, "1073741824")
  field(DRVL, "1")
  field(AOFF, "1")
  field(PREC, "0")
  field(OUT, "@timing.proto evg_mux_div_set($(P),$(R),2) $(PORT)")
}

record(longout, "$(P)$(R)cmd_mux_get2") {
  field(ASG, "Reserved")
  field(DESC, "Command code to read Mux2 register")
  field(VAL, "0xAB") # (0x80 | reg number=43)
}

record(longout, "$(P)$(R)cmd_mux_set2") {
  field(ASG, "Reserved")
  field(DESC, "Command code to write to Mux2 register")
  field(VAL, "0x6B")
}

########################################################################
# Mux3 register [44]

record(bi, "$(P)$(R)muxen3RBV") {
  field(ASG, "Reserved")
  field(DESC, "EVG Mux3 enable status")
  field(ZNAM, "OFF")
  field(ONAM, "ON")
}

record(longin, "$(P)$(R)muxdiv3RAW") {
  field(ASG, "Reserved")
  field(DESC, "EVG Mux3 frequency divider RAW")
  field(SCAN, "I/O Intr")
  field(DTYP, "stream")
  field(INP, "@timing.proto evg_mux_div3RAW_intr $(PORT)")
  field(FLNK, "$(P)$(R)muxdiv3RBV")
}

record(calc, "$(P)$(R)muxdiv3RBV") {
  field(ASG, "Reserved")
  field(DESC, "EVG Mux3 frequency divider RBV")
  field(INPA, "$(P)$(R)muxdiv3RAW")
  field(CALC, "A+1")
}

record(bo, "$(P)$(R)muxen3"){
  field(DESC, "Enable/Disable MUX3")
  field(DTYP, "stream")
  field(ZNAM, "OFF")
  field(ONAM, "ON")
  field(OUT, "@timing.proto evg_mux_en_set($(P),$(R),3) $(PORT)")
}

record(ao, "$(P)$(R)muxdiv3"){
  field(DESC, "EVG Mux3 prescaler setting")
  field(DTYP, "stream")
  field(DRVH, "1073741824")
  field(DRVL, "1")
  field(AOFF, "1")
  field(PREC, "0")
  field(OUT, "@timing.proto evg_mux_div_set($(P),$(R),3) $(PORT)")
}

record(longout, "$(P)$(R)cmd_mux_get3") {
  field(ASG, "Reserved")
  field(DESC, "Command code to read Mux3 register")
  field(VAL, "0xAC") # (0x80 | reg number=44)
}

record(longout, "$(P)$(R)cmd_mux_set3") {
  field(ASG, "Reserved")
  field(DESC, "Command code to write to Mux3 register")
  field(VAL, "0x6C")
}

########################################################################
# Mux4 register [45]

record(bi, "$(P)$(R)muxen4RBV") {
  field(ASG, "Reserved")
  field(DESC, "EVG Mux4 enable status")
  field(ZNAM, "OFF")
  field(ONAM, "ON")
}

record(longin, "$(P)$(R)muxdiv4RAW") {
  field(ASG, "Reserved")
  field(DESC, "EVG Mux4 frequency divider RAW")
  field(SCAN, "I/O Intr")
  field(DTYP, "stream")
  field(INP, "@timing.proto evg_mux_div4RAW_intr $(PORT)")
  field(FLNK, "$(P)$(R)muxdiv4RBV")
}

record(calc, "$(P)$(R)muxdiv4RBV") {
  field(ASG, "Reserved")
  field(DESC, "EVG Mux4 frequency divider RBV")
  field(INPA, "$(P)$(R)muxdiv4RAW")
  field(CALC, "A+1")
}

record(bo, "$(P)$(R)muxen4"){
  field(DESC, "Enable/Disable MUX4")
  field(DTYP, "stream")
  field(ZNAM, "OFF")
  field(ONAM, "ON")
  field(OUT, "@timing.proto evg_mux_en_set($(P),$(R),4) $(PORT)")
}

record(ao, "$(P)$(R)muxdiv4"){
  field(DESC, "EVG Mux4 prescaler setting")
  field(DTYP, "stream")
  field(DRVH, "1073741824")
  field(DRVL, "1")
  field(AOFF, "1")
  field(PREC, "0")
  field(OUT, "@timing.proto evg_mux_div_set($(P),$(R),4) $(PORT)")
}

record(longout, "$(P)$(R)cmd_mux_get4") {
  field(ASG, "Reserved")
  field(DESC, "Command code to read Mux4 register")
  field(VAL, "0xAD") # (0x80 | reg number=45)
}

record(longout, "$(P)$(R)cmd_mux_set4") {
  field(ASG, "Reserved")
  field(DESC, "Command code to write to Mux4 register")
  field(VAL, "0x6D")
}

########################################################################
# Mux5 register [46]

record(bi, "$(P)$(R)muxen5RBV") {
  field(ASG, "Reserved")
  field(DESC, "EVG Mux5 enable status")
  field(ZNAM, "OFF")
  field(ONAM, "ON")
}

record(longin, "$(P)$(R)muxdiv5RAW") {
  field(ASG, "Reserved")
  field(DESC, "EVG Mux5 frequency divider RAW")
  field(SCAN, "I/O Intr")
  field(DTYP, "stream")
  field(INP, "@timing.proto evg_mux_div5RAW_intr $(PORT)")
  field(FLNK, "$(P)$(R)muxdiv5RBV")
}

record(calc, "$(P)$(R)muxdiv5RBV") {
  field(ASG, "Reserved")
  field(DESC, "EVG Mux5 frequency divider RBV")
  field(INPA, "$(P)$(R)muxdiv5RAW")
  field(CALC, "A+1")
}

record(bo, "$(P)$(R)muxen5"){
  field(DESC, "Enable/Disable MUX5")
  field(DTYP, "stream")
  field(ZNAM, "OFF")
  field(ONAM, "ON")
  field(OUT, "@timing.proto evg_mux_en_set($(P),$(R),5) $(PORT)")
}

record(ao, "$(P)$(R)muxdiv5"){
  field(DESC, "EVG Mux5 prescaler setting")
  field(DTYP, "stream")
  field(DRVH, "1073741824")
  field(DRVL, "1")
  field(AOFF, "1")
  field(PREC, "0")
  field(OUT, "@timing.proto evg_mux_div_set($(P),$(R),5) $(PORT)")
}

record(longout, "$(P)$(R)cmd_mux_get5") {
  field(ASG, "Reserved")
  field(DESC, "Command code to read Mux5 register")
  field(VAL, "0xAE") # (0x80 | reg number=46)
  #field(ASG, "Reserved")
}

record(longout, "$(P)$(R)cmd_mux_set5") {
  field(ASG, "Reserved")
  field(DESC, "Command code to write to Mux5 register")
  field(VAL, "0x6E")
}

########################################################################
# Mux6 register [47]

record(bi, "$(P)$(R)muxen6RBV") {
  field(ASG, "Reserved")
  field(DESC, "EVG Mux6 enable status")
  field(ZNAM, "OFF")
  field(ONAM, "ON")
}

record(longin, "$(P)$(R)muxdiv6RAW") {
  field(ASG, "Reserved")
  field(DESC, "EVG Mux6 frequency divider RAW")
  field(SCAN, "I/O Intr")
  field(DTYP, "stream")
  field(INP, "@timing.proto evg_mux_div6RAW_intr $(PORT)")
  field(FLNK, "$(P)$(R)muxdiv6RBV")
}

record(calc, "$(P)$(R)muxdiv6RBV") {
  field(ASG, "Reserved")
  field(DESC, "EVG Mux6 frequency divider RBV")
  field(INPA, "$(P)$(R)muxdiv6RAW")
  field(CALC, "A+1")
}

record(bo, "$(P)$(R)muxen6"){
  field(DESC, "Enable/Disable MUX6")
  field(DTYP, "stream")
  field(ZNAM, "OFF")
  field(ONAM, "ON")
  field(OUT, "@timing.proto evg_mux_en_set($(P),$(R),6) $(PORT)")
}

record(ao, "$(P)$(R)muxdiv6"){
  field(DESC, "EVG Mux6 prescaler setting")
  field(DTYP, "stream")
  field(DRVH, "1073741824")
  field(DRVL, "1")
  field(AOFF, "1")
  field(PREC, "0")
  field(OUT, "@timing.proto evg_mux_div_set($(P),$(R),6) $(PORT)")
}

record(longout, "$(P)$(R)cmd_mux_get6") {
  field(ASG, "Reserved")
  field(DESC, "Command code to read Mux6 register")
  field(VAL, "0xAF") # (0x80 | reg number=47)
}

record(longout, "$(P)$(R)cmd_mux_set6") {
  field(ASG, "Reserved")
  field(DESC, "Command code to write to Mux6 register")
  field(VAL, "0x6F")
}

########################################################################
# Mux7 register [48]

record(bi, "$(P)$(R)muxen7RBV") {
  field(ASG, "Reserved")
  field(DESC, "EVG Mux7 enable status")
  field(ZNAM, "OFF")
  field(ONAM, "ON")
}

record(longin, "$(P)$(R)muxdiv7RAW") {
  field(ASG, "Reserved")
  field(DESC, "EVG Mux7 frequency divider RAW")
  field(SCAN, "I/O Intr")
  field(DTYP, "stream")
  field(INP, "@timing.proto evg_mux_div7RAW_intr $(PORT)")
  field(FLNK, "$(P)$(R)muxdiv7RBV")
}

record(calc, "$(P)$(R)muxdiv7RBV") {
  field(ASG, "Reserved")
  field(DESC, "EVG Mux7 frequency divider RBV")
  field(INPA, "$(P)$(R)muxdiv7RAW")
  field(CALC, "A+1")
}

record(bo, "$(P)$(R)muxen7"){
  field(DESC, "Enable/Disable MUX7")
  field(DTYP, "stream")
  field(ZNAM, "OFF")
  field(ONAM, "ON")
  field(OUT, "@timing.proto evg_mux_en_set($(P),$(R),7) $(PORT)")
}

record(ao, "$(P)$(R)muxdiv7"){
  field(DESC, "EVG Mux7 prescaler setting")
  field(DTYP, "stream")
  field(DRVH, "1073741824")
  field(DRVL, "1")
  field(AOFF, "1")
  field(PREC, "0")
  field(OUT, "@timing.proto evg_mux_div_set($(P),$(R),7) $(PORT)")
}

record(longout, "$(P)$(R)cmd_mux_get7") {
  field(ASG, "Reserved")
  field(DESC, "Command code to read Mux7 register")
  field(VAL, "0xB0") # (0x80 | reg number=48)
}

record(longout, "$(P)$(R)cmd_mux_set7") {
  field(ASG, "Reserved")
  field(DESC, "Command code to write to Mux7 register")
  field(VAL, "0x70")
}

########################################################################
# SEQRAM setting register [49]

record(longout, "$(P)$(R)seqaddr"){
  field(DESC, "Set address of EVG SEQRAM")
  field(DRVH, "16383")
  field(DRVL, "0")
}

record(longout, "$(P)$(R)seqcode"){
  field(DESC, "Set event code in EVG SEQRAM")
  field(DRVH, "255")
  field(DRVL, "0")
}

record(longout, "$(P)$(R)seqtime"){
  field(DESC, "Set timestamp in EVG SEQRAM")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evg_seqramset_set($(P),$(R)) $(PORT)")
}

record(longout, "$(P)$(R)cmd_seqramset_set") {
  field(ASG, "Reserved")
  field(DESC, "SEQRAM setting reg write command code")
  field(VAL, "0x71")
}

########################################################################
# SEQRAM switch register [50]

record(mbbiDirect, "$(P)$(R)seqcountRBV") {
  field(ASG, "Reserved")
  field(DESC, "EVG seqcount status")
  field(NOBT, "14")
  field(DTYP, "stream")
  field(INP, "@timing.proto evg_seqramsw_get($(P),$(R)) $(PORT)")
}

record(longout, "$(P)$(R)seqram_switch"){
  field(DESC, "Switch SEQRAM")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evg_seqramsw_set($(P),$(R)) $(PORT)")
}

record(longout, "$(P)$(R)cmd_seqramsw_get") {
  field(ASG, "Reserved")
  field(DESC, "SEQRAM switch reg read command code")
  field(VAL, "0xB2") # (0x80 | reg number=50)
}

record(longout, "$(P)$(R)cmd_seqramsw_set") {
  field(ASG, "Reserved")
  field(DESC, "SEQRAM switch reg write command code")
  field(VAL, "0x72")
}

########################################################################
# Timestamp register [51]

# This record value is read by the Sequencer program sncEVGSetup
record(bo, "$(P)$(R)UTCRef"){
  field(DESC, "EVG UTC reference")
  field(ZNAM, "PC")
  field(ONAM, "Control Room")
}

# This record value is written by the Sequencer program sncEVGSetup
record(bi, "$(P)$(R)UTCMismatch"){
  field(ASG, "Reserved")
  field(DESC, "UTC mismatch between ref. and EVG")
  field(ZNAM, "Match")
  field(ONAM, "Mismatch")
}

# This record value is read by the Sequencer program sncEVGSetup
record(bo, "$(P)$(R)GetUTC"){
  field(DESC, "Get UTC from configured reference cmd")
  field(ZNAM, "OFF")
  field(ONAM, "ON")
}

# This record monitors the control room timestamp
record(longin, "$(P)$(R)CtrlRoomUTC"){
  field(ASG, "Reserved")
  field(DESC, "Control room UTC monitor")
  field(INP, "Cont:LNLS191:NTP:Timestamp CPP")
  field(EGU, "seconds")
}

# Note: Setting $(P)$(R)UTC.VAL to 0 causes EVG to broadcast
# 	the timestamp to the EVEs and EVRs.

record(longout, "$(P)$(R)UTC"){
  field(DESC, "EVG timestamp UTC field")
  field(EGU, "seconds")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evg_tmstmp_utc_set($(P),$(R)) $(PORT)")
}

record(mbbo, "$(P)$(R)TIMESRC"){
  field(DESC, "EVG timestamp signal source")	
  field(ZRST, "IDLE")
  field(ZRVL, "0")
  field(ONST, "DBUS")
  field(ONVL, "1")
  field(TWST, "EXTERNAL")
  field(TWVL, "2")
  field(THST, "INTERNAL")
  field(THVL, "3")
  field(VAL, "0")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evg_tmstmp_timesrc_set($(P),$(R)) $(PORT)")
}

record(longin, "$(P)$(R)UTCRBV"){
  field(ASG, "Reserved")
  field(DESC, "EVG timestamp UTC field RBV")
  field(EGU, "seconds")
}

record(longin, "$(P)$(R)subsecondRBV"){
  field(ASG, "Reserved")
  field(DESC, "EVG timestamp subsecond field RBV")
  field(EGU, "evt_T")
}

record(mbbi, "$(P)$(R)TIMESRCRBV"){
  field(ASG, "Reserved")
  field(DESC, "EVG timestamp signal source RBV")	
  field(ZRST, "IDLE")
  field(ZRVL, "0")
  field(ONST, "DBUS")
  field(ONVL, "1")
  field(TWST, "EXTERNAL")
  field(TWVL, "2")
  field(THST, "INTERNAL")
  field(THVL, "3")
  field(SCAN, "I/O Intr")
  field(DTYP, "stream")
  field(INP, "@timing.proto evg_tmstmp_timesrcRBV_intr $(PORT)")
}

record(longout, "$(P)$(R)cmd_tmstmp_get"){
  field(ASG, "Reserved")
  field(DESC, "Timestamp reg read command code")
  field(VAL, "0xB3")
  field(SCAN, "1 second")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evg_tmstmp_get($(P),$(R)) $(PORT)")
}

record(longout, "$(P)$(R)cmd_tmstmp_set"){
  field(ASG, "Reserved")
  field(DESC, "Timestamp reg write command code")
  field(VAL, "0x73")
}

########################################################################
# Digital input 0 [53]

record(longout, "$(P)$(R)digev0") {
  field(DESC, "EVG digital input 0 event code")
  field(DRVH, "255")
  field(DRVL, "0")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evgre_diginp_ev_set($(P),$(R),0) $(PORT)")
}

record(bo, "$(P)$(R)digen0") {
  field(DESC, "EVG digital input 0 enable")
  field(ZNAM, "OFF")
  field(ONAM, "ON")
  field(FLNK, "$(P)$(R)DIGEN0")
}

record(bo, "$(P)$(R)digpol0") {
  field(DESC, "EVG digital input 0 polarity")
  field(ZNAM, "NORMAL")
  field(ONAM, "INVERTED")
  field(FLNK, "$(P)$(R)DIGPOL0")
}

record(bo, "$(P)$(R)digtime0") {
  field(DESC, "EVG dig. input 0 event timestamp enable")
  field(ZNAM, "NOT TIMESTAMPED")
  field(ONAM, "TIMESTAMPED")
  field(FLNK, "$(P)$(R)DIGTIME0")
}

record(calcout, "$(P)$(R)DIGEN0") {
  field(ASG, "Reserved")
  field(DESC, "EVG digital input 0 set enable calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)digen0.VAL")
  field(INPB, "$(P)$(R)digpol0RBV.VAL")
  field(INPC, "$(P)$(R)digtime0RBV.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)")
  field(OUT, "@timing.proto evgre_diginp_ept_set($(P),$(R),0,DIGEN) $(PORT)")
  field(FLNK, "$(P)$(R)digept0")
}

record(calcout, "$(P)$(R)DIGPOL0") {
  field(ASG, "Reserved")
  field(DESC, "EVG digital input 0 set polarity calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)digen0RBV.VAL")
  field(INPB, "$(P)$(R)digpol0.VAL")
  field(INPC, "$(P)$(R)digtime0RBV.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)")
  field(OUT, "@timing.proto evgre_diginp_ept_set($(P),$(R),0,DIGPOL) $(PORT)")
  field(FLNK, "$(P)$(R)digept0")
}

record(calcout, "$(P)$(R)DIGTIME0") {
  field(ASG, "Reserved")
  field(DESC, "EVG digital input 0 set timestamp calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)digen0RBV.VAL")
  field(INPB, "$(P)$(R)digpol0RBV.VAL")
  field(INPC, "$(P)$(R)digtime0.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)")
  field(OUT, "@timing.proto evgre_diginp_ept_set($(P),$(R),0,DIGTIME) $(PORT)")
  field(FLNK, "$(P)$(R)digept0")
}

record(calcout, "$(P)$(R)digept0") {
  field(ASG, "Reserved")
  field(DESC, "EVG dig.inp. 0 download en, pol and time")
  field(INPA, "$(P)$(R)digen0.VAL")
  field(INPB, "$(P)$(R)digpol0.VAL")
  field(INPC, "$(P)$(R)digtime0.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)")
}

record(mbbiDirect, "$(P)$(R)digept0RBV") {
  field(ASG, "Reserved")
  field(DESC, "DIGINP0 en, pol, and timestamp RBV")
  field(NOBT, "8")
  field(SHFT, "5")
  field(SCAN, "I/O Intr")
  field(DTYP, "stream")
  field(INP, "@timing.proto evgre_diginp0_intr $(PORT)")
  field(FLNK, "$(P)$(R)digtime0RBV")
}

record(bi, "$(P)$(R)digtime0RBV") {
  field(ASG, "Reserved")
  field(DESC, "EVG digital input 0 timestamping sts")
  field(ZNAM, "NOT TIMESTAMPED")
  field(ONAM, "TIMESTAMPED")
  field(INP, "$(P)$(R)digept0RBV.B0")
  field(FLNK, "$(P)$(R)digpol0RBV")
}

record(bi, "$(P)$(R)digpol0RBV") {
  field(ASG, "Reserved")
  field(DESC, "EVG digital input 0 polarity status")
  field(ZNAM, "NORMAL")
  field(ONAM, "INVERTED")
  field(INP, "$(P)$(R)digept0RBV.B1")
  field(FLNK, "$(P)$(R)digen0RBV")
}

record(bi, "$(P)$(R)digen0RBV") {
  field(ASG, "Reserved")
  field(DESC, "EVG digital input 0 enable status")
  field(ZNAM, "OFF")
  field(ONAM, "ON")
  field(INP, "$(P)$(R)digept0RBV.B2")
}

record(longin, "$(P)$(R)digev0RBV") {
  field(ASG, "Reserved")
  field(DESC, "EVG digital input 0 event RBV")
}

record(longout, "$(P)$(R)cmd_diginp_set0") {
  field(ASG, "Reserved")
  field(DESC, "Command code to write to DIGINP0")
  field(VAL, "0x75") # (0x40 | reg number=1)
}

record(longout, "$(P)$(R)cmd_diginp_get0") {
  field(ASG, "Reserved")
  field(DESC, "Command code to read DIGINP0")
  field(VAL, "0xB5") # (0x80 | reg number=1)
}

########################################################################
# Digital input 1 [54]

record(longout, "$(P)$(R)digev1") {
  field(DESC, "EVG digital input 1 event code")
  field(DRVH, "255")
  field(DRVL, "0")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evgre_diginp_ev_set($(P),$(R),1) $(PORT)")
}

record(bo, "$(P)$(R)digen1") {
  field(DESC, "EVG digital input 1 enable")
  field(ZNAM, "OFF")
  field(ONAM, "ON")
  field(FLNK, "$(P)$(R)DIGEN1")
}

record(bo, "$(P)$(R)digpol1") {
  field(DESC, "EVG digital input 1 polarity")
  field(ZNAM, "NORMAL")
  field(ONAM, "INVERTED")
  field(FLNK, "$(P)$(R)DIGPOL1")
}

record(bo, "$(P)$(R)digtime1") {
  field(DESC, "EVG dig. input 1 event timestamp enable")
  field(ZNAM, "NOT TIMESTAMPED")
  field(ONAM, "TIMESTAMPED")
  field(FLNK, "$(P)$(R)DIGTIME1")
}

record(calcout, "$(P)$(R)DIGEN1") {
  field(ASG, "Reserved")
  field(DESC, "EVG digital input 1 set enable calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)digen1.VAL")
  field(INPB, "$(P)$(R)digpol1RBV.VAL")
  field(INPC, "$(P)$(R)digtime1RBV.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)")
  field(OUT, "@timing.proto evgre_diginp_ept_set($(P),$(R),1,DIGEN) $(PORT)")
  field(FLNK, "$(P)$(R)digept1")
}

record(calcout, "$(P)$(R)DIGPOL1") {
  field(ASG, "Reserved")
  field(DESC, "EVG digital input 1 set polarity calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)digen1RBV.VAL")
  field(INPB, "$(P)$(R)digpol1.VAL")
  field(INPC, "$(P)$(R)digtime1RBV.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)")
  field(OUT, "@timing.proto evgre_diginp_ept_set($(P),$(R),1,DIGPOL) $(PORT)")
  field(FLNK, "$(P)$(R)digept1")
}

record(calcout, "$(P)$(R)DIGTIME1") {
  field(ASG, "Reserved")
  field(DESC, "EVG digital input 1 set timestamp calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)digen1RBV.VAL")
  field(INPB, "$(P)$(R)digpol1RBV.VAL")
  field(INPC, "$(P)$(R)digtime1.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)")
  field(OUT, "@timing.proto evgre_diginp_ept_set($(P),$(R),1,DIGTIME) $(PORT)")
  field(FLNK, "$(P)$(R)digept1")
}

record(calcout, "$(P)$(R)digept1") {
  field(ASG, "Reserved")
  field(DESC, "EVG dig.inp. 1 download en, pol and time")
  field(INPA, "$(P)$(R)digen1.VAL")
  field(INPB, "$(P)$(R)digpol1.VAL")
  field(INPC, "$(P)$(R)digtime1.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)")
}

record(mbbiDirect, "$(P)$(R)digept1RBV") {
  field(ASG, "Reserved")
  field(DESC, "DIGINP1 en, pol, and timestamp RBV")
  field(NOBT, "8")
  field(SHFT, "5")
  field(SCAN, "I/O Intr")
  field(DTYP, "stream")
  field(INP, "@timing.proto evgre_diginp1_intr $(PORT)")
  field(FLNK, "$(P)$(R)digtime1RBV")
}

record(bi, "$(P)$(R)digtime1RBV") {
  field(ASG, "Reserved")
  field(DESC, "EVG digital input 1 timestamping sts")
  field(ZNAM, "NOT TIMESTAMPED")
  field(ONAM, "TIMESTAMPED")
  field(INP, "$(P)$(R)digept1RBV.B0")
  field(FLNK, "$(P)$(R)digpol1RBV")
}

record(bi, "$(P)$(R)digpol1RBV") {
  field(ASG, "Reserved")
  field(DESC, "EVG digital input 1 polarity status")
  field(ZNAM, "NORMAL")
  field(ONAM, "INVERTED")
  field(INP, "$(P)$(R)digept1RBV.B1")
  field(FLNK, "$(P)$(R)digen1RBV")
}

record(bi, "$(P)$(R)digen1RBV") {
  field(ASG, "Reserved")
  field(DESC, "EVG digital input 1 enable status")
  field(ZNAM, "OFF")
  field(ONAM, "ON")
  field(INP, "$(P)$(R)digept1RBV.B2")
}

record(longin, "$(P)$(R)digev1RBV") {
  field(ASG, "Reserved")
  field(DESC, "EVG digital input 1 event RBV")
}

record(longout, "$(P)$(R)cmd_diginp_set1") {
  field(ASG, "Reserved")
  field(DESC, "Command code to write to DIGINP1")
  field(VAL, "0x76") # (0x40 | reg number=1)
}

record(longout, "$(P)$(R)cmd_diginp_get1") {
  field(ASG, "Reserved")
  field(DESC, "Command code to read DIGINP1")
  field(VAL, "0xB6") # (0x80 | reg number=1)
}

########################################################################
# Interlock map [56]

record(mbboDirect, "$(P)$(R)ilock_mbbo") {
  field(DESC, "EVG interlock input to output map")
}

record(mbbiDirect, "$(P)$(R)ilock_mbbi") {
  field(DESC, "EVG interlock input to output map")
  field(VAL, "1")
}

record(seq, "$(P)$(R)ilock_seq1") {
  field(DESC, "EVG interlock input to output map")
  field(DOL1, "$(P)$(R)ilock_map0to15RBV.B0")
  field(DOL2, "$(P)$(R)ilock_map0to15RBV.B1")
  field(DOL3, "$(P)$(R)ilock_map0to15RBV.B2")
  field(DOL4, "$(P)$(R)ilock_map0to15RBV.B3")
  field(DOL5, "$(P)$(R)ilock_map0to15RBV.B4")
  field(DOL6, "$(P)$(R)ilock_map0to15RBV.B5")
  field(DOL7, "$(P)$(R)ilock_map0to15RBV.B6")
  field(DOL8, "$(P)$(R)ilock_map0to15RBV.B7")
  field(DOL9, "$(P)$(R)ilock_map0to15RBV.B8")
  field(DOLA, "$(P)$(R)ilock_map0to15RBV.B9")
  field(LNK1, "$(P)$(R)ilock_map0to15.B0")
  field(LNK2, "$(P)$(R)ilock_map0to15.B1")
  field(LNK3, "$(P)$(R)ilock_map0to15.B2")
  field(LNK4, "$(P)$(R)ilock_map0to15.B3")
  field(LNK5, "$(P)$(R)ilock_map0to15.B4")
  field(LNK6, "$(P)$(R)ilock_map0to15.B5")
  field(LNK7, "$(P)$(R)ilock_map0to15.B6")
  field(LNK8, "$(P)$(R)ilock_map0to15.B7")
  field(LNK9, "$(P)$(R)ilock_map0to15.B8")
  field(LNKA, "$(P)$(R)ilock_map0to15.B9")
  field(FLNK, "$(P)$(R)ilock_seq2")
}

record(seq, "$(P)$(R)ilock_seq2") {
  field(DESC, "EVG interlock input to output map")
  field(DOL1, "$(P)$(R)ilock_map0to15RBV.BA")
  field(DOL2, "$(P)$(R)ilock_map0to15RBV.BB")
  field(DOL3, "$(P)$(R)ilock_map0to15RBV.BC")
  field(DOL4, "$(P)$(R)ilock_map0to15RBV.BD")
  field(DOL5, "$(P)$(R)ilock_map0to15RBV.BE")
  field(DOL6, "$(P)$(R)ilock_map0to15RBV.BF")
  field(LNK1, "$(P)$(R)ilock_map0to15.BA")
  field(LNK2, "$(P)$(R)ilock_map0to15.BB")
  field(LNK3, "$(P)$(R)ilock_map0to15.BC")
  field(LNK4, "$(P)$(R)ilock_map0to15.BD")
  field(LNK5, "$(P)$(R)ilock_map0to15.BE")
  field(LNK6, "$(P)$(R)ilock_map0to15.BF")
}

record(seq, "$(P)$(R)ilock_seq3") {
  field(DESC, "EVG interlock input to output map")
  field(DOL1, "$(P)$(R)ilock_map16to27RBV.B0")
  field(DOL2, "$(P)$(R)ilock_map16to27RBV.B1")
  field(DOL3, "$(P)$(R)ilock_map16to27RBV.B2")
  field(DOL4, "$(P)$(R)ilock_map16to27RBV.B3")
  field(DOL5, "$(P)$(R)ilock_map16to27RBV.B4")
  field(DOL6, "$(P)$(R)ilock_map16to27RBV.B5")
  field(DOL7, "$(P)$(R)ilock_map16to27RBV.B6")
  field(DOL8, "$(P)$(R)ilock_map16to27RBV.B7")
  field(DOL9, "$(P)$(R)ilock_map16to27RBV.B8")
  field(DOLA, "$(P)$(R)ilock_map16to27RBV.B9")
  field(LNK1, "$(P)$(R)ilock_map16to27.B0")
  field(LNK2, "$(P)$(R)ilock_map16to27.B1")
  field(LNK3, "$(P)$(R)ilock_map16to27.B2")
  field(LNK4, "$(P)$(R)ilock_map16to27.B3")
  field(LNK5, "$(P)$(R)ilock_map16to27.B4")
  field(LNK6, "$(P)$(R)ilock_map16to27.B5")
  field(LNK7, "$(P)$(R)ilock_map16to27.B6")
  field(LNK8, "$(P)$(R)ilock_map16to27.B7")
  field(LNK9, "$(P)$(R)ilock_map16to27.B8")
  field(LNKA, "$(P)$(R)ilock_map16to27.B9")
  field(FLNK, "$(P)$(R)ilock_seq4")
}

record(seq, "$(P)$(R)ilock_seq4") {
  field(DESC, "EVG interlock input to output map")
  field(DOL1, "$(P)$(R)ilock_map16to27RBV.BA")
  field(DOL2, "$(P)$(R)ilock_map16to27RBV.BB")
  field(LNK1, "$(P)$(R)ilock_map16to27.BA")
  field(LNK2, "$(P)$(R)ilock_map16to27.BB")
}

record(mbboDirect, "$(P)$(R)ilock_map0to15") {
  field(DESC, "EVG interlock input to output map")
  field(FLNK, "$(P)$(R)ilock_map")
}

record(mbboDirect, "$(P)$(R)ilock_map16to27") {
  field(DESC, "EVG interlock input to output map")
  field(FLNK, "$(P)$(R)ilock_map")
}

record(calcout, "$(P)$(R)ilock_map") {
  #field(ASG, "Reserved")
  field(DESC, "EVG interlock map calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)ilock_map16to27")
  field(INPB, "$(P)$(R)ilock_map0to15")
  field(CALC, "(A<<16)+B")
  field(OUT, "@timing.proto evg_ilockmap_map_set($(P),$(R)) $(PORT)")
}

record(longout, "$(P)$(R)ilock_evt_in0") {
  field(DESC, "EVG interlock input 0 event code")
  field(DRVH, "255")
  field(DRVL, "0")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evg_ilockmap_ev0_set($(P),$(R)) $(PORT)")
}

record(longout, "$(P)$(R)ilock_evt_in1") {
  field(DESC, "EVG interlock input 1 event code")
  field(DRVH, "255")
  field(DRVL, "0")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evg_ilockmap_ev1_set($(P),$(R)) $(PORT)")
}

record(longout, "$(P)$(R)ilock_evt_in2") {
  field(DESC, "EVG interlock input 2 event code")
  field(DRVH, "255")
  field(DRVL, "0")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evg_ilockmap_ev2_set($(P),$(R)) $(PORT)")
}

record(longout, "$(P)$(R)ilock_evt_in3") {
  field(DESC, "EVG interlock input 3 event code")
  field(DRVH, "255")
  field(DRVL, "0")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evg_ilockmap_ev3_set($(P),$(R)) $(PORT)")
}

record(longout, "$(P)$(R)ilock_evt_in4") {
  field(DESC, "EVG interlock input 4 event code")
  field(DRVH, "255")
  field(DRVL, "0")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evg_ilockmap_ev4_set($(P),$(R)) $(PORT)")
}

record(longout, "$(P)$(R)ilock_evt_in5") {
  field(DESC, "EVG interlock input 5 event code")
  field(DRVH, "255")
  field(DRVL, "0")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evg_ilockmap_ev5_set($(P),$(R)) $(PORT)")
}

record(longout, "$(P)$(R)ilock_evt_in6") {
  field(DESC, "EVG interlock input 6 event code")
  field(DRVH, "255")
  field(DRVL, "0")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evg_ilockmap_ev6_set($(P),$(R)) $(PORT)")
}

record(longout, "$(P)$(R)ilock_evt_out") {
  field(DESC, "EVG interlock output event code")
  field(DRVH, "255")
  field(DRVL, "0")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evg_ilockmap_evout_set($(P),$(R)) $(PORT)")
}

record(longout, "$(P)$(R)cmd_evg_ilockmap_set") {
  field(ASG, "Reserved")
  field(DESC, "Command code to write to Interlock Map")
  field(VAL, "0x78")
}

record(longout, "$(P)$(R)cmd_evg_ilockmap_get") {
  field(ASG, "Reserved")
  field(DESC, "Command code to read Interlock Map")
  field(VAL, "0xB8")
}

record(mbbiDirect, "$(P)$(R)ilock_map0to15RBV") {
  field(DESC, "EVG interlock input to output map RBV")
  field(FLNK, "$(P)$(R)ilock_seq1")
}

record(mbbiDirect, "$(P)$(R)ilock_map16to27RBV") {
  field(DESC, "EVG interlock input to output map RBV")
  field(FLNK, "$(P)$(R)ilock_seq3")
}

record(longin, "$(P)$(R)ilock_evt_in0RBV") {
  field(ASG, "Reserved")
  field(DESC, "EVG interlock input 0 event code RBV")
}

record(longin, "$(P)$(R)ilock_evt_in1RBV") {
  field(ASG, "Reserved")
  field(DESC, "EVG interlock input 1 event code RBV")
}

record(longin, "$(P)$(R)ilock_evt_in2RBV") {
  field(ASG, "Reserved")
  field(DESC, "EVG interlock input 2 event code RBV")
}

record(longin, "$(P)$(R)ilock_evt_in3RBV") {
  field(ASG, "Reserved")
  field(DESC, "EVG interlock input 3 event code RBV")
}

record(longin, "$(P)$(R)ilock_evt_in4RBV") {
  field(ASG, "Reserved")
  field(DESC, "EVG interlock input 4 event code RBV")
}

record(longin, "$(P)$(R)ilock_evt_in5RBV") {
  field(ASG, "Reserved")
  field(DESC, "EVG interlock input 5 event code RBV")
}

record(longin, "$(P)$(R)ilock_evt_in6RBV") {
  field(ASG, "Reserved")
  field(DESC, "EVG interlock input 6 event code RBV")
}

record(longin, "$(P)$(R)ilock_evt_outRBV") {
  field(ASG, "Reserved")
  field(DESC, "EVG interlock output event code RBV")
}

########################################################################
# Interlock Control and Status [57]

record(longout, "$(P)$(R)cmd_evg_ilockcontrol_set") {
  field(ASG, "Reserved")
  field(DESC, "Command code to write Interlock Control")
  field(VAL, "0x79")
}

record(longout, "$(P)$(R)cmd_evg_ilockcontrol_get") {
  field(ASG, "Reserved")
  field(DESC, "Command code to read Interlock Control")
  field(SCAN, "1 second")
  field(VAL, "0xB9")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evg_ilockcontrol_get($(P),$(R)) $(PORT)")
}

record(bo, "$(P)$(R)ilock_control_en") {
  field(DESC, "Interlock map enable")
  field(ZNAM, "OFF")
  field(ONAM, "ON")
  field(FLNK, "$(P)$(R)ilock_control_EN")
}

record(bo, "$(P)$(R)ilock_control_rst") {
  field(DESC, "Interlock map reset")
  field(ZNAM, "OFF")
  field(ONAM, "ON")
  field(HIGH, "1")
  field(FLNK, "$(P)$(R)ilock_control_RST")
}

record(bo, "$(P)$(R)ilock_control_repeat") {
  field(DESC, "Interlock map enable continuous mode")
  field(ZNAM, "OFF")
  field(ONAM, "ON")
  field(FLNK, "$(P)$(R)ilock_control_REPEAT")
}

record(calcout, "$(P)$(R)ilock_control_EN") {
  field(ASG, "Reserved")
  field(DESC, "EVG Interlock control. En, reset, cont.")
  field(INPA, "$(P)$(R)ilock_control_en")
  field(INPB, "$(P)$(R)ilock_control_rstRBV")
  field(INPC, "$(P)$(R)ilock_control_repeatRBV")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evg_ilockcontrol_set($(P),$(R),EN) $(PORT)")
  field(FLNK, "$(P)$(R)ilock_control")
}

record(calcout, "$(P)$(R)ilock_control_RST") {
  field(ASG, "Reserved")
  field(DESC, "EVG Interlock control. En, reset, cont.")
  field(INPA, "$(P)$(R)ilock_control_enRBV")
  field(INPB, "$(P)$(R)ilock_control_rst")
  field(INPC, "$(P)$(R)ilock_control_repeatRBV")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evg_ilockcontrol_set($(P),$(R),RST) $(PORT)")
  field(FLNK, "$(P)$(R)ilock_control")
}

record(calcout, "$(P)$(R)ilock_control_REPEAT") {
  field(ASG, "Reserved")
  field(DESC, "EVG Interlock control. En, reset, cont.")
  field(INPA, "$(P)$(R)ilock_control_enRBV")
  field(INPB, "$(P)$(R)ilock_control_rstRBV")
  field(INPC, "$(P)$(R)ilock_control_repeat")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evg_ilockcontrol_set($(P),$(R),REPEAT) $(PORT)")
  field(FLNK, "$(P)$(R)ilock_control")
}

record(calcout, "$(P)$(R)ilock_control") {
  field(ASG, "Reserved")
  field(DESC, "EVG Interlock control. En, reset, cont.")
  field(INPA, "$(P)$(R)ilock_control_en")
  field(INPB, "$(P)$(R)ilock_control_rst")
  field(INPC, "$(P)$(R)ilock_control_repeat")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)")
}

record(longout, "$(P)$(R)ilock_repeat_time") {
  field(DESC, "EVG Interlock event output repeat time")
  field(DRVH, "4294967295")
  field(DRVL, "1")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evg_ilockrepeat_time_set($(P),$(R)) $(PORT)")
}

record(longin, "$(P)$(R)ilock_repeat_timeRBV") {
  #field(ASG, "Reserved")
  field(DESC, "EVG Interlock evtout repeat time RBV")
  field(SCAN, "I/O Intr")
  field(DTYP, "stream")
  field(INP, "@timing.proto evg_ilock_repeat_time_intr $(PORT)")
}

record(mbbiDirect, "$(P)$(R)ilock_controlRBV") {
  #field(ASG, "Reserved")
  field(DESC, "EVG Interlock control RBV.")
  field(NOBT, "8")
  field(SCAN, "I/O Intr")
  field(DTYP, "stream")
  field(INP, "@timing.proto evg_ilock_control_intr $(PORT)")
  field(FLNK, "$(P)$(R)ilock_control_enRBV")
}

record(bi, "$(P)$(R)ilock_control_enRBV") {
  field(DESC, "Interlock map enable RBV")
  field(ZNAM, "OFF")
  field(ONAM, "ON")
  field(INP, "$(P)$(R)ilock_controlRBV.B7")
  field(FLNK, "$(P)$(R)ilock_control_rstRBV")
}

record(bi, "$(P)$(R)ilock_control_rstRBV") {
  field(DESC, "Interlock map reset RBV")
  field(ZNAM, "OFF")
  field(ONAM, "ON")
  field(INP, "$(P)$(R)ilock_controlRBV.B6")
  field(FLNK, "$(P)$(R)ilock_control_repeatRBV")
}

record(bi, "$(P)$(R)ilock_control_repeatRBV") {
  field(DESC, "Interlock map enable continuous mode RBV")
  field(ZNAM, "OFF")
  field(ONAM, "ON")
  field(INP, "$(P)$(R)ilock_controlRBV.B5")
}

record(mbbiDirect, "$(P)$(R)ilock_status") {
  #field(ASG, "Reserved")
  field(DESC, "Interlock event status")
  field(NOBT, "8")
  field(SCAN, "I/O Intr")
  field(DTYP, "stream")
  field(INP, "@timing.proto evg_ilock_status_intr $(PORT)")
}

########################################################################
# Firmware Version [62]

record(longin, "$(P)$(R)FRMVERSIONA"){
  #field(ASG, "Reserved")
  field(DESC, "EVO firmware version")
  field(DTYP, "stream")
  field(INP, "@timing.proto frmvrs_get($(P),$(R)) $(PORT)")
}

record(longin, "$(P)$(R)FRMVERSIONB"){
  #field(ASG, "Reserved")
  field(DESC, "EVO firmware version")
  field(DTYP, "stream")
  field(INP, "@timing.proto frmvrs_get($(P),$(R)) $(PORT)")
}

record(longin, "$(P)$(R)FRMVERSIONC"){
  #field(ASG, "Reserved")
  field(DESC, "EVO firmware version")
  field(DTYP, "stream")
  field(INP, "@timing.proto frmvrs_get($(P),$(R)) $(PORT)")
}

record(calcout, "$(P)$(R)cmd_frmvrs_get"){
  field(ASG, "Reserved")
  field(DESC, "Firmware version read command code")
  field(VAL, "0xBE")
}

########################################################################
# Configuration Register [63]

record(longin, "$(P)$(R)alive") {
  field(ASG, "Reserved")
  field(DESC, "EVG alive")
  field(SCAN, "I/O Intr")
  field(DTYP, "stream")
  field(INP, "@timing.proto evg_conf_alive_intr $(PORT)")
  field(FLNK, "$(P)$(R)statdevcalc")
}

record(longin, "$(P)$(R)rfdivRAW") {
  field(ASG, "Reserved")
  field(DESC, "EVG RF divider status RAW")
  field(SCAN, "I/O Intr")
  field(DTYP, "stream")
  field(INP, "@timing.proto evg_conf_rfdivRAW_intr $(PORT)")
  field(FLNK, "$(P)$(R)rfdivRBV")
}

record(calc, "$(P)$(R)rfdivRBV") {
  field(ASG, "Reserved")
  field(DESC, "EVG RF divider status RBV")
  field(INPA, "$(P)$(R)rfdivRAW")
  field(CALC, "A+1")
}

record(mbbi, "$(P)$(R)funselRBV") {
  field(ASG, "Reserved")
  field(DESC, "EVG function select status")
  field(NOBT, "6")
  field(ZRVL, "16")
  field(ZRST, "FOUT")
  field(ONVL, "17")
  field(ONST, "EVR")
  field(TWVL, "18")
  field(TWST, "EVG")
  field(THVL, "32")
  field(THST, "EVE")
  field(SCAN, "I/O Intr")
  field(DTYP, "stream")
  field(INP, "@timing.proto evg_conf_funsel_intr $(PORT)")
}

record(mbbo, "$(P)$(R)funsel") {
  field(DESC, "STD-EVO configuration as EVG")
  field(ZRVL, "16")
  field(ZRST, "FOUT")
  field(ONVL, "17")
  field(ONST, "EVR")
  field(TWVL, "18")
  field(TWST, "EVG")
  field(THVL, "32")
  field(THST, "EVE")
  field(VAL, "2")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evg_conf_funsel_set($(P),$(R)) $(PORT)")
}

record(ao, "$(P)$(R)rfdiv"){
  field(DESC, "EVG RF clock divider")
  field(DTYP, "stream")
  field(DRVH, "15")
  field(DRVL, "1")
  field(AOFF, "1")
  field(PREC, "0")
  field(OUT, "@timing.proto evg_conf_rfdiv_set($(P),$(R)) $(PORT)")
}

record(longout, "$(P)$(R)cmd_conf_get") {
  field(ASG, "Reserved")
  field(DESC, "Configuration reg read command code")
  field(VAL, "0xBF")
  field(SCAN, "1 second")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evg_conf_get($(P),$(R)) $(PORT)")
}

record(longout, "$(P)$(R)cmd_conf_set") {
  field(ASG, "Reserved")
  field(DESC, "Configuration reg write command code")
  field(VAL, "0x7F")
}

########################################################################
# Injection Table

# !ITBL.NELM MUST NOT BE MODIFIED!, since it affects the 
# event table length

record(waveform, "$(P)$(R)ITBL") {
  field(DESC, "Injection table")
  field(NELM, "864")
  field(FTVL, "USHORT")
}

########################################################################
# Write all configuration registers
record(bo, "$(P)$(R)download") {
  field(DESC, "EVG download")
  field(ZNAM, "OFF")
  field(ONAM, "ON")
}

record(bo, "$(P)$(R)downloadT") {
  field(DESC, "EVG download trigger")
  field(ZNAM, "OFF")
  field(ONAM, "ON")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evg_download($(P),$(R)) $(PORT)")
}

record(bo, "$(P)$(R)uploadT") {
  field(DESC, "EVG upload trigger")
  field(ZNAM, "OFF")
  field(ONAM, "ON")
  field(HIGH, "0.5")
  field(FLNK, "$(P)$(R)uploadCalc")
}

record(calcout, "$(P)$(R)uploadCalc"){
  field(ASG, "Reserved")
  field(DESC, "EVG upload trigger calc")
  field(INPA, "$(P)$(R)uploadT.VAL")
  field(CALC, "A")
  field(OOPT, "When Non-zero")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evg_upload($(P),$(R)) $(PORT)")
}

record(calc, "$(P)$(R)statdevcalc") {
  field(ASG, "Reserved")
  field(DESC, "EVG device status calc")
  field(INPA, "$(P)$(R)alive")
  field(CALC, "A=0?0:1")
  #field(ASG, "Reserved")
  field(FLNK, "$(P)$(R)statdev")
}

record(bi, "$(P)$(R)statdev") {
  field(ASG, "Reserved")
  field(DESC, "EVG device status")
  field(ZNAM, "WAITING")
  field(ONAM, "RUNNING")
  field(INP, "$(P)$(R)statdevcalc")
}

record(bi, "$(P)$(R)network") {
  field(ASG, "Reserved")
  field(DESC, "EVG network status")
  field(ZNAM, "OFF")
  field(ONAM, "ON")
}

record(bo, "$(P)$(R)SAVE"){
  field(DESC, "EVG manual Save settings command")
  field(ZNAM, "OFF")
  field(ONAM, "ON")
  field(FLNK, "$(P)$(R)save_T")
}

record(calc, "$(P)$(R)save_T"){
  field(DESC, "EVG manual Save trigger")
  field(INPA, "$(P)$(R)SAVE.VAL")
  field(CALC, "(A > 0) ? (VAL+1) : VAL")
  field(VAL, "0")
}
